(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),s=a.n(o),i=a(22),l=a(9),c=a(57),u=a(30);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var p=a(10),d={token:null,userId:null,username:null,error:null,loading:!1},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTHENTICATION_STARTED":return Object(p.a)({},e,{error:null,loading:!0});case"AUTHENTICATION_SUCCEED":return Object(p.a)({},e,{error:null,token:t.token,userId:t.userId,username:t.username,loading:!1});case"AUTHENTICATION_FAILED":return Object(p.a)({},e,{error:t.error,token:null,userId:null,username:null,loading:!1});case"AUTHENTICATION_LOGOUT":return Object(p.a)({},e,{token:null,userId:null,username:null});case"AUTENTICATION_SET_USERNAME":return Object(p.a)({},e,{username:t.username});default:return e}},m=a(2),f=a(3),y=a(1),v=a(11),g=a(15);function E(e,t,a,n){var r=Object(y.w)(e,t).slope,o=Object(y.w)(e,a).slope;y.q.EQ(r,o)&&(o+=2*Math.PI,n=!0);var s=Object(y.w)(e,t).length;return new y.a(e,s,r,o,n)}function b(e,t){var a,n,r=Math.abs(t),o=new y.o,s=e.clone();s.r=e.r+r,a=function(e,t,a,n){var r=Object(y.w)(e,t).slope,o=r+a;y.q.EQ(r,o)&&(o+=2*Math.PI,n=!0);var s=Object(y.w)(e,t).length;return new y.a(e,s,r,o,n)}(e.end,s.end,Math.PI,e.counterClockwise),n=function(e,t,a,n){var r=Object(y.w)(e,t).slope,o=r-a;y.q.EQ(o,r)&&(r+=2*Math.PI,n=!0);var s=Object(y.w)(e,t).length;return new y.a(e,s,o,r,n)}(e.start,s.start,Math.PI,e.counterClockwise);var i=void 0;i=e.r>r?new y.a(e.pc,e.r-r,e.endAngle,e.startAngle,e.counterClockwise===y.e?y.d:y.e):new y.p(a.end,n.start),o.addFace([s,a,i,n]),Object(v.a)(o.faces)[0].setArcLength();var l=y.g.getSelfIntersections(Object(v.a)(o.faces)[0],o.edges,!1);l=l.slice(0,l.length/2);var c,u,p=[];c=Object(v.a)(o.edges)[1],u=Object(v.a)(o.edges)[3];var d=!0,h=!1,m=void 0;try{for(var f,E=l[Symbol.iterator]();!(d=(f=E.next()).done);d=!0){var b=f.value;Object(g.b)(c,b,p),Object(g.b)(u,b,p)}}catch(I){h=!0,m=I}finally{try{d||null==E.return||E.return()}finally{if(h)throw m}}var _=Object(g.c)(p);Object(g.g)(o,_);var O=y.k,S=!0,w=!1,A=void 0;try{for(var T,D=_[Symbol.iterator]();!(S=(T=D.next()).done);S=!0){var C=T.value;C.edge_before.bv=O,C.edge_after.bv=O===y.k?y.h:y.k,O=C.edge_after.bv}}catch(I){w=!0,A=I}finally{try{S||null==D.return||D.return()}finally{if(w)throw A}}var k=g.a;Object(g.d)(o,k,_,!0);var L,P,N=p.length;N>0&&(L=_[0].edge_before,P=_[N-1].edge_after,L.next=P,P.prev=L,_[0].edge_after=_[N-1].edge_after,_[N-1].edge_before=_[0].edge_before,4===N&&(L=_[2].edge_before,P=_[1].edge_after,L.next=P,P.prev=L,_[2].edge_after=_[1].edge_after,_[1].edge_before=_[2].edge_before),Object(g.e)(o,p),Object(g.f)(o,p,p));return Object(v.a)(o.faces)[0].orientation()===y.j.CCW&&o.reverse(),o}function _(e,t){var a=Math.abs(t),n=new y.o,r=Object(y.w)(e.end.x-e.start.x,e.end.y-e.start.y).normalize(),o=r.rotate90CCW().multiply(a),s=r.rotate90CW().multiply(a),i=e.translate(o),l=e.translate(s).reverse(),c=E(e.end,i.end,l.start,y.e),u=E(e.start,l.end,i.start,y.e);return n.addFace([i,c,l,u]),n}var O=function(){function e(){Object(m.a)(this,e)}return Object(f.a)(e,[{key:"parseToWatchArray",value:function(e){var t=e.match(/[^\r\n]+/g),a=[],n=!0,r=!1,o=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value;a.push(l.substring(l.indexOf("{")))}}catch(c){r=!0,o=c}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return a}},{key:"parseToPoint",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split("=")[1].split(","),a=new y.n(parseInt(t[0],10),parseInt(t[1],10));return a.label=e.split(/\s+/)[1],a}},{key:"parseToSegment",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new y.n(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new y.n(parseInt(r[0],10),parseInt(r[1],10));return new y.p(n,o)}},{key:"parseToArc",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new y.n(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new y.n(parseInt(r[0],10),parseInt(r[1],10)),s=t[2].split("=")[1].split(","),i=new y.n(parseInt(s[0],10),parseInt(s[1],10)),l="0"===t[3].split("=")[1],c=Object(y.w)(i,n).slope,u=Object(y.w)(i,o).slope;y.t.Utils.EQ(c,u)&&(u=l?u+2*Math.PI:u-2*Math.PI);var p=Object(y.w)(i,n).length;return new y.a(i,p,c,u,l)}},{key:"parseToCircle",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new y.n(parseInt(a[0],10),parseInt(a[1],10)),r=parseInt(t[1].split("=")[1],10);return new y.f(n,r)}},{key:"parseToRectangle",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=parseInt(a[0],10),r=parseInt(a[1],10),o=parseInt(t[1].split("=")[1],10),s=parseInt(t[2].split("=")[1],10),i=new y.c(n,r,n+o,r+s),l=new y.o;return l.addFace(i),l}},{key:"parseToODBLine",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new y.n(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new y.n(parseInt(r[0],10),parseInt(r[1],10)),s=parseInt(t[2].split("=")[1],10),i=new y.p(n,o);return s>0?_(i,s):new y.o}},{key:"parseToODBArc",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new y.n(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new y.n(parseInt(r[0],10),parseInt(r[1],10)),s=t[2].split("=")[1].split(","),i=new y.n(parseInt(s[0],10),parseInt(s[1],10)),l="0"===t[3].split("=")[1],c=Object(y.w)(i,n).slope,u=Object(y.w)(i,o).slope;y.t.Utils.EQ(c,u)&&(u=l?u+2*Math.PI:u-2*Math.PI);var p=Object(y.w)(i,n).length,d=new y.a(i,p,c,u,l),h=parseInt(t[4].split("=")[1],10);return h>0?b(d,h):new y.o}},{key:"parseToPolygon",value:function(e){for(var t=new y.o,a=e.match(/[^\r\n]+/g),n=0;n<a.length;n++){var r=a[n];if(r.search("mat_cont_poly_struc")>=0){for(var o=r.match(/\{([^)]+)\}/)[1].split(" ")[0].split("=")[1],s=parseInt(o,10),i=[],l=n+2;l<n+2+s;l++)if((r=a[l]).search("mat_seg_struc")>=0){var c=this.parseToSegment(r);i.push(c)}else if(r.search("mat_curve_struc")>=0){var u=this.parseToArc(r);i.push(u)}t.addFace(i)}}return t}},{key:"parseToPoints",value:function(e){var t=[],a=e.match(/[^\r\n]+/g),n=!0,r=!1,o=void 0;try{for(var s,i=a[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value;if(l.search("point_struc")>=0){var c=l.match(/\{([^)]+)\}/)[1].split("=")[1].split(","),u=new y.n(parseInt(c[0],10),parseInt(c[1],10));u.label=l.split(/\s+/)[1],t.push(u)}}}catch(p){r=!0,o=p}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return t}},{key:"parseToShapes",value:function(e){var t,a=[],n=e.match(/[^\r\n]+/g),r=!0,o=!1,s=void 0;try{for(var i,l=n[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var c=i.value;c.search("point_struc")>=0?t=this.parseToPoint(c):c.search("_seg_struc")>=0?t=this.parseToSegment(c):c.search("_curve_struc")>=0?t=this.parseToArc(c):c.search("_circle_struc")>=0?t=this.parseToCircle(c):c.search("_rect_struc")>=0?t=this.parseToRectangle(c):c.search("_line_struc")>=0?t=this.parseToODBLine(c):c.search("_arc_struc")>=0&&(t=this.parseToODBArc(c)),a.push(t)}}catch(u){o=!0,s=u}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return a}},{key:"parse",value:function(e){var t=this.parseToPolygon(e);if(t.edges.size>0&&t.faces.size>0)return[t];var a=this.parseToShapes(e);if(a.length>0)return a;var n=this.parseToPoints(e);return n.length>0?n:void 0}}]),e}(),S=[{name:"pixels",decimals:0,divisor:1},{name:"inch",decimals:7,divisor:1016e4},{name:"mm",decimals:6,divisor:4e5}],w={title:"Debug Viewer",version:"2.0.0",build:"",units:"pixels",decimals:0,divisor:1,parser:new O,widthOn:!0,displayVertices:!1,displayLabels:!0,measurePointsActive:!1,zoomFactor:void 0,originX:void 0,originY:void 0,showAboutPopup:!1,importDataToNewLayer:!0,showSkeletonRecognitionButton:!1,applySkeletonRecognition:!1,stage:null,showSpinner:!1,showLayerList:!1,showDownloadPopup:!1,showUploadPopup:!1},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_STAGE_CREATED":return Object.assign({},e,{stage:t.stage,zoomFactor:t.stage.zoomFactor*t.stage.resolution,originX:t.stage.origin.x,originY:t.stage.origin.y});case"STAGE_UNMOUNTED":return Object.assign({},e,{stage:null,zoomFactor:void 0,originX:void 0,originY:void 0});case"MOUSE_WHEEL_MOVE_ON_STAGE":case"PAN_AND_ZOOM_TO_SHAPE":case"PINCH_MOVED_ON_STAGE":return Object.assign({},e,{zoomFactor:t.stage.zoomFactor*t.stage.resolution,originX:t.stage.origin.x,originY:t.stage.origin.y});case"MOUSE_MOVED_ON_STAGE":return Object.assign({},e,{originX:t.stage.origin.x,originY:t.stage.origin.y});case"TOGGLE_UNITS_CLICKED":var a=S.findIndex(function(t){return e.units===t.name}),n=S[(a+1)%3];return Object.assign({},e,{units:n.name,decimals:n.decimals,divisor:n.divisor});case"TOGGLE_WIDTH_MODE_CLICKED":return Object.assign({},e,{widthOn:!e.widthOn,displayVertices:!!e.widthOn&&e.displayVertices});case"TOGGLE_DISPLAY_VERTICES_CLICKED":return e.displayVertices?Object.assign({},e,{displayVertices:!1}):Object.assign({},e,{widthOn:!1,displayVertices:!0});case"TOGGLE_DISPLAY_LABELS_CLICKED":return Object.assign({},e,{displayLabels:!e.displayLabels});case"TOGGLE_ABOUT_POPUP_CLICKED":return Object.assign({},e,{showAboutPopup:!e.showAboutPopup});case"PAN_BY_DRAG_BUTTON_CLICKED":return Object.assign({},e,{measurePointsActive:!1});case"MEASURE_POINTS_BUTTON_PRESSED":return Object.assign({},e,{measurePointsActive:!0});case"MEASURE_SHAPES_BUTTON_PRESSED":return Object.assign({},e,{measurePointsActive:!1});case"SKELETON_RECOGNITION_URI":return Object.assign({},e,{showSkeletonRecognitionButton:!0});case"SKELETON_RECOGNITION_BUTTON_PRESSED":return Object.assign({},e,{applySkeletonRecognition:!0});case"ASYNC_OPERATION_STARTED":return Object.assign({},e,{showSpinner:!0});case"ASYNC_OPERATION_ENDED":return Object.assign({},e,{showSpinner:!1});case"AABB_TREE_NEXT_LEVEL":return e;case"TOGGLE_SHOW_LAYER_LIST_CLICKED":return Object(p.a)({},e,{showLayerList:!e.showLayerList});case"TOGGLE_DOWNLOAD_POPUP_CLICKED":return Object(p.a)({},e,{showDownloadPopup:!e.showDownloadPopup});case"TOGGLE_UPLOAD_POPUP_CLICKED":return Object(p.a)({},e,{showUploadPopup:!e.showUploadPopup});default:return e}},T={strokeStyle:1,stroke:"#FF0303",fill:"#FF0303",alpha:1},D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(m.a)(this,e),this.geom=t,this.style=a||T,this.label=n}return Object(f.a)(e,[{key:"clone",value:function(){var t=new e(this.geom,this.style,this.label);return Object.assign(t,this)}},{key:"box",get:function(){return this.geom.box}}]),e}(),C=function(){function e(t){Object(m.a)(this,e),this.stage=t,this.shapes=[],this.name="",this.color="",this.title="",this.displayed=!1,this.edited=!1,this.affected=!1}return Object(f.a)(e,[{key:"clone",value:function(){var t=new e(this.stage);return Object.assign(t,this)}},{key:"add",value:function(e){if(e instanceof D)this.shapes.push(e);else{var t=new D(e,{},e.label);this.shapes.push(t)}return this}},{key:"addShapesArray",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;this.add(s)}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return this}},{key:"toggleDisplayed",value:function(e){var t=!this.displayed;return Object.assign(this.clone(),{displayed:t,color:e})}},{key:"setAffected",value:function(e){return this.affected=e,this}},{key:"setEdited",value:function(e){return Object.assign(this.clone(),{edited:e})}},{key:"setNameAndTitle",value:function(e,t){return Object.assign(this.clone(),{name:e,title:t,edited:!1})}},{key:"setAlpha",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.shapes[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){n.value.alpha=this.displayed?1:0}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}return this.shapes}},{key:"toJSON",value:function(){return{name:this.name,title:this.title,shapes:JSON.stringify(this.shapes,null," ")}}},{key:"box",get:function(){var e=new y.c,t=!0,a=!1,n=void 0;try{for(var r,o=this.shapes[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;e=e.merge(s.geom instanceof y.c?s.clone():s.box)}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return e}},{key:"center",get:function(){var e=this.box;return new y.n((e.xmin+e.xmax)/2,(e.ymin+e.ymax)/2)}}]),e}(),k=["#FF0303","#4AA403","#540080","#FFFF40","#FF0080","#AED424","#545400","#FFA980","#A95480","#A9A9FF","#00FF00","#FFEE76","#A40576","#4385C8","#1CC826","#BDBD00","#48316E","#14616E","#8040BD","#DC7676","#924845","#A90000","#FFA900"],L=function(){function e(){Object(m.a)(this,e)}return Object(f.a)(e,null,[{key:"newLayer",value:function(t,a){var n=new C(t);return n.name=e.getNewName(a),0===a.length&&(n.displayed=!1,n.affected=!1),n}},{key:"getNewName",value:function(t){for(var a=e.defaultName,n=1,r=function(e){return e.name===a};t.find(r);)a=e.defaultName+n,n++;return a}},{key:"getAffected",value:function(e){return e.find(function(e){return e.affected})}},{key:"setAffected",value:function(t,a){var n=e.getAffected(t);n&&(n.affected=!1),a.affected=!0}},{key:"getNextColor",value:function(e){for(var t="",a=function(){var a=r[n];if(!e.find(function(e){return e.displayed&&e.color===a}))return t=a,"break"},n=0,r=k;n<r.length;n++){if("break"===a())break}return t}},{key:"delete",value:function(t,a){var n=t.findIndex(function(e){return e===a}),r=t.filter(function(e){return e!==a});return n>0&&(r[n-1].affected=!0,""===r[n-1].color&&(r[n-1].color=e.getNextColor(r)),r[n-1].displayed=!0),r}},{key:"sort",value:function(e){var t=e.slice();return t.sort(function(e,t){var a=e.name.toUpperCase(),n=t.name.toUpperCase();return a<n?-1:a>n?1:0}),t}},{key:"toJSON",value:function(e){return e.map(function(e){return e.toJSON()})}},{key:"defaultName",get:function(){return"layer"}}]),e}(),P=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,n=t.find(function(e){return e.affected}),r=t.findIndex(function(e){return e.affected});switch(a.type){case"ADD_LAYER_BUTTON_PRESSED":return e=L.newLayer(a.stage,t),[].concat(Object(v.a)(t),[e]);case"ADD_NEW_LAYER":return[].concat(Object(v.a)(t),[a.layer]);case"DELETE_LAYER_BUTTON_PRESSED":return n?L.delete(t,n):t;case"CLEAR_ALL_BUTTON_CLICKED":return[];case"SORT_LAYERS_BUTTON_PRESSED":return L.sort(t);case"TOGGLE_DISPLAY_LAYER_PRESSED":var o="";if(!a.layer.displayed&&""===(o=L.getNextColor(t)))return;return t.map(function(e){if(e!==a.layer)return a.layer.displayed?e:e.setAffected(!1);var t=e.toggleDisplayed(o);return t.affected=t.displayed,t});case"TOGGLE_AFFECTED_LAYER_PRESSED":return t.map(function(e){return e!==a.layer?e.setAffected(!1):e.setAffected(!e.affected)});case"OPEN_LAYER_EDIT_FORM_PRESSED":return t.map(function(e){return e!==n?e:e.setEdited(!0)});case"SUBMIT_LAYER_EDIT_FORM_PRESSED":return t.map(function(e){return e.edited?e.setNameAndTitle(a.newLayer.name,a.newLayer.title):e});case"ESCAPE_LAYER_EDIT_FORM_PRESSED":return t.map(function(e){return e.edited?e.setEdited(!1):e});case"LAYERS_LIST_ARROW_DOWN_PRESSED":if(r===t.length-1)return t;var s=t[r+1];return t.map(function(e){if(e===n){var t=e.toggleDisplayed("");return t.affected=!1,t}if(e===s){var a=n.color,r=e.toggleDisplayed(a);return r.affected=!0,r}return e});case"LAYERS_LIST_ARROW_UP_PRESSED":if(0===r)return t;var i=t[r-1];return t.map(function(e){if(e===n){var t=e.toggleDisplayed("");return t.affected=!1,t}if(e===i){var a=e.toggleDisplayed(n.color);return a.displayed=!0,a.affected=!0,a}return e});default:return t}},N={x:0,y:0,startX:void 0,startY:void 0,touchPoints:void 0},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOUSE_MOVED_ON_STAGE":return Object.assign({},e,{x:t.x,y:t.y});case"MOUSE_DOWN_ON_STAGE":return Object.assign({},e,{startX:t.x,startY:t.y});case"MOUSE_UP_ON_STAGE":return Object.assign({},e,{startX:void 0,startY:void 0});case"PINCH_DOWN_ON_STAGE":return Object(p.a)({},e,{touchPoints:[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2}]});case"PINCH_UP_ON_STAGE":return Object(p.a)({},e,{touchPoints:void 0});default:return e}},M=a(7),x={measureShapesActive:!1,measureShapesFirstClick:!0,hoveredShape:null,firstMeasuredShape:null,secondMeasuredShape:null,firstMeasuredLayer:null,secondMeasuredLayer:null,distance:void 0,shortestSegment:null},j=window.mobilecheck(),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MEASURE_SHAPES_BUTTON_PRESSED":return Object.assign({},x,{measureShapesActive:!0});case"PAN_BY_DRAG_BUTTON_CLICKED":case"MEASURE_POINTS_BUTTON_PRESSED":return Object.assign({},x);case"MOUSE_ROLL_OVER_SHAPE":return Object.assign({},e,{hoveredShape:e.measureShapesActive?t.shape:null});case"MOUSE_ROLL_OUT_SHAPE":return Object.assign({},e,{hoveredShape:null});case"MOUSE_CLICKED_ON_SHAPE":if(!e.measureShapesActive)return e;if(e.measureShapesFirstClick)return Object.assign({},e,{firstMeasuredShape:t.shape,firstMeasuredLayer:t.layer,secondMeasuredShape:null,secondMeasuredLayer:null,measureShapesFirstClick:!1,distance:void 0,shortestSegment:null});if(t.shape===e.firstMeasuredShape)return e;var a,n,r=e.firstMeasuredShape.geom,o=t.shape.geom,s=y.t.Distance.distance(r,o),i=Object(M.a)(s,2);return a=i[0],n=i[1],Object.assign({},e,{secondMeasuredShape:t.shape,secondMeasuredLayer:t.layer,measureShapesFirstClick:!0,distance:a,shortestSegment:n});case"MOUSE_DOWN_ON_STAGE":return e.hoveredShape||j?e:Object.assign({},e,{measureShapesFirstClick:!0,firstMeasuredShape:null,firstMeasuredLayer:null,secondMeasuredShape:null,secondMeasuredLayer:null,distance:void 0,shortestSegment:null});case"DELETE_LAYER_BUTTON_PRESSED":return t.layer===e.firstMeasuredLayer||t.layer===e.secondMeasuredLayer?Object.assign({},x):e;case"TOGGLE_DISPLAY_LAYER_PRESSED":return!t.layer.displayed||t.layer!==e.firstMeasuredLayer&&t.layer!==e.secondMeasuredLayer?e:Object.assign({},x);default:return e}},R=a(72);function F(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var B={id:void 0,name:"",owner:"Alex Bol",lastUpdated:void 0},Y={document:B,documentsList:{}};var W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED":case"REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED":return Object(p.a)({},e,{document:{id:t.id,name:t.name,owner:t.owner,lastUpdated:t.lastUpdated}});case"REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED":return Object(p.a)({},e,{document:Object(p.a)({},e.document,{lastUpdated:t.lastUpdated})});case"DOCUMENT_NAME_UPDATED":return Object(p.a)({},e,{document:Object(p.a)({},e.document,{name:t.name})});case"DELETE_DOCUMENT_FROM_DATABASE_SUCCEED":var a=e.documentsList,n=t.id,r=(a[n],Object(R.a)(a,[n].map(F)));return Object(p.a)({},e,{document:e.document.id===t.id?B:e.document,documentsList:r});case"DOCUMENT_SELECTED_FROM_LIST":return Object(p.a)({},e,{document:t.document});case"CLEAR_ALL_BUTTON_CLICKED":return Object(p.a)({},e,{document:B});case"REQUEST_FETCH_DOCUMENTS_FROM_DATABASE_SUCCEED":return function(e,t){if(null===t||void 0===t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var a in e)if(!t.hasOwnProperty(a)||e[a].lastUpdated===t[a].lastUpdated)return!1;return!0}(e.documentsList,t.documentsList)?e:Object(p.a)({},e,{documentsList:t.documentsList});default:return e}},X={uploadStarted:!1,uploadCompleted:!1,uploadedFiles:[]},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_UPLOAD_STATE":return X;case"FILES_UPLOAD_COMPLETED":return Object(p.a)({},e,{uploadCompleted:!0,uploadedFiles:t.uploadedFiles});default:return e}},G=Object(i.c)({auth:h,app:A,layers:P,upload:z,cloudStorage:W,measureShapesTool:U,mouse:I}),H=function(e){e.getState,e.dispatch;return function(e){return function(t){"MOUSE_MOVED_ON_STAGE"!==t.type&&console.log("ACTION: "+t.type,t),e(t)}}},V=function(e){var t=e.dispatch,a=e.getState;return function(e){return function(n){if("DATA_FROM_BUFFER_PASTED"!==n.type)return e(n);var r=a(),o=r.app.stage,s=r.layers,i=r.app.parser,l=void 0;r.app.importDataToNewLayer?(l=L.newLayer(o,s),s.push(l)):(l=s.find(function(e){return e.affected}))||(l=L.newLayer(o,s),s.push(l));var c=!0,u=!1,p=void 0;try{for(var d,h=n.data.items[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){d.value.getAsString(function(e){var a=i.parse(e);if(a.length>0){var n=!0,r=!1,s=void 0;try{for(var c,u=a[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var p=c.value;l.add(p)}}catch(d){r=!0,s=d}finally{try{n||null==u.return||u.return()}finally{if(r)throw s}}}l.shapes.length>0&&(t({type:"PAN_AND_ZOOM_TO_SHAPE",shape:l,stage:o}),t({type:"TOGGLE_DISPLAY_LAYER_PRESSED",layer:l}))});break}}catch(m){u=!0,p=m}finally{try{c||null==h.return||h.return()}finally{if(u)throw p}}}}},K=function(e){var t=e.getState;e.dispatch;return function(e){return function(a){var n=t().mouse,r=a.stage;if(r)switch(a.type){case"STAGE_RESIZED":r.resize();break;case"MOUSE_DOWN_ON_STAGE":r.panByMouseStart();break;case"MOUSE_MOVED_ON_STAGE":void 0!==a.dx&&void 0!==a.dy&&r.panByMouseMove(a.dx,a.dy);break;case"MOUSE_UP_ON_STAGE":r.panByMouseStop();break;case"PAN_AND_ZOOM_TO_SHAPE":var o=a.shape.center,s=a.shape.box;if(isNaN(o.x)||isNaN(o.y))return;r.panToCoordinate(o.x,o.y),r.zoomToLimits(s.xmax-s.xmin,s.ymax-s.ymin);break;case"MOUSE_WHEEL_MOVE_ON_STAGE":var i=a.delta>0;r.zoomByMouse(a.x,a.y,i,1.2);break;case"CLEAR_ALL":r.removeAllChildren(),r.removeAllListeners();break;case"PINCH_DOWN_ON_STAGE":r.zoomByPinchStart(a.x1,a.y1);break;case"PINCH_MOVED_ON_STAGE":if(n.touchPoints){var l=n.touchPoints[0].x-n.touchPoints[1].x,c=n.touchPoints[0].y-n.touchPoints[1].y,u=Math.sqrt(l*l+c*c);l=a.x2-a.x1,c=a.y2-a.y1;var p=Math.sqrt(l*l+c*c)/u;r.zoomByPinchMove(a.x1,a.y1,p)}break;case"PINCH_UP_ON_STAGE":r.zoomByPinchStop()}e(a)}}},Z=window.Algorithmia,Q=function(e){var t=e.dispatch,a=e.getState;return function(e){return function(n){if("SKELETON_RECOGNITION_BUTTON_PRESSED"===n.type){var r=a(),o=r.app.stage,s=r.layers,i=L.getAffected(s),l=i.shapes.map(function(e){return[e.geom.x/400,e.geom.y/400,e.geom.nx,e.geom.ny]});Z.client("simby4RUwqQmtMDaHAPj5wsQwlD1").algo("alexbol99/SeketonRecognition").pipe(l).then(function(e){if(e.error)return console.error("error: "+e.error);var a=L.newLayer(o,s);a.name="recognized",a.title="recognized";var n=!0,r=!1,l=void 0;try{for(var c,u=e.result[Symbol.iterator]();!(n=(c=u.next()).done);n=!0){var p=c.value,d=void 0;if(p[0]instanceof Array&&2===p[0].length){var h=Object(y.u)(400*p[0][0],400*p[0][1]),m=400*p[1];d=Object(y.s)(h,m,p[2],p[3],y.t.CCW)}else d=Object(y.v)(Object(y.u)(400*p[0],400*p[1]),Object(y.u)(400*p[2],400*p[3]));p[4]&&(d.label=p[4]),a.add(d)}}catch(f){r=!0,l=f}finally{try{n||null==u.return||u.return()}finally{if(r)throw l}}s.push(a),t({type:"PAN_AND_ZOOM_TO_SHAPE",stage:o,shape:i})})}return e(n)}}},J=a(5),q=a(4),$=a(6),ee=a(23),te=a(17),ae=a.n(te),ne=ae.a.create({baseURL:"https://debug-viewer.firebaseio.com/"}),re=function(e,t){return{type:"PAN_AND_ZOOM_TO_SHAPE",stage:e,shape:t}},oe=function(e){return{type:"ADD_NEW_LAYER",layer:e}},se=function(e){return{type:"TOGGLE_DISPLAY_LAYER_PRESSED",layer:e}},ie=function(){function e(){Object(m.a)(this,e),this.filename="",this.title="",this.profiles=[],this.materials=[],this.shapes=[]}return Object(f.a)(e,[{key:"box",get:function(){var e=new y.c,t=!0,a=!1,n=void 0;try{for(var r,o=this.profiles[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;e.merge(s.box)}}catch(b){a=!0,n=b}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}var i=!0,l=!1,c=void 0;try{for(var u,p=this.materials[Symbol.iterator]();!(i=(u=p.next()).done);i=!0){var d=u.value;e.merge(d.box)}}catch(b){l=!0,c=b}finally{try{i||null==p.return||p.return()}finally{if(l)throw c}}var h=!0,m=!1,f=void 0;try{for(var v,g=this.shapes[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var E=v.value;e.merge(E.box)}}catch(b){m=!0,f=b}finally{try{h||null==g.return||g.return()}finally{if(m)throw f}}return e}}]),e}();function le(e,t){var a=new ie;a.filename=e;var n=JSON.parse(t),r=new y.t.Polygon,o=!0,s=!1,i=void 0;try{for(var l,c=n[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;r.addFace(u)}}catch(p){s=!0,i=p}finally{try{o||null==c.return||c.return()}finally{if(s)throw i}}return a.shapes.push(r),a}y.t.Image=function(){function e(){Object(m.a)(this,e),this.uri="",this.center=new y.t.Point,this.width=0,this.height=0}return Object(f.a)(e,[{key:"box",get:function(){return new y.t.Box(this.center.x-this.width/2,this.center.y-this.height/2,this.center.x+this.height/2,this.center.y+this.height/2)}}]),e}();var ce=function(e){for(var t="document",a=1,n=function(e){return e.name===t};Object.values(e).find(n);)t="document"+a,a++;return t},ue=a(21),pe=a.n(ue),de=a(24),he=a.n(de),me=function(e){var t;switch(e.type){case"trigger":t=he.a.IconTrigger;break;case"mode":t=e.active?he.a.IconModeActive:he.a.IconModeNotActive;break;default:t=he.a.IconTrigger}var a=e.mobileOnly?he.a.DrawerButton:he.a.Button;return r.a.createElement("button",{title:e.title,onClick:e.onClick,className:a},r.a.createElement(pe.a,{name:e.iconName,size:"2x",className:t}))},fe=a(40),ye=a.n(fe),ve=function(){return r.a.createElement("div",{className:ye.a.ButtonSeparator},r.a.createElement(pe.a,{name:"ellipsis-v",size:"2x",className:ye.a.IconSeparator}))},ge=a(41),Ee=a.n(ge),be=(a(54),function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:Ee.a["App-toolbar"]},r.a.createElement(me,{type:"trigger",title:"Upload files",iconName:"folder-open",onClick:this.props.onShowUploadPopupPressed}),r.a.createElement(me,{type:"trigger",title:"Show/hide layers",iconName:"layer-group",onClick:this.props.onLayerListButtonClicked}),r.a.createElement(me,{type:"trigger",title:"Delete all layers",iconName:"broom",onClick:this.props.onClearAllButtonClicked}),r.a.createElement(me,{type:"trigger",title:"Download layers",iconName:"file-download",onClick:this.props.onShowDownloadPopupPressed}),r.a.createElement(ve,null),r.a.createElement(me,{type:"trigger",title:"Zoom and pan to home view",iconName:"home",onClick:this.props.onHomeButtonPressed}),r.a.createElement(ve,null),r.a.createElement(me,{type:"mode",title:"Pan by drag",iconName:"arrows-alt",active:!this.props.measurePointsActive,onClick:this.props.onPanByDragPressed}),r.a.createElement(me,{type:"mode",title:"Measure distance between points",iconName:"drafting-compass",active:this.props.measurePointsActive,onClick:this.props.onMeasurePointsButtonPressed}),r.a.createElement(ve,null),r.a.createElement(me,{type:"trigger",title:"Measure distance between selected shapes",iconName:"ruler",onClick:this.props.onMeasureBetweenShapesButtonPressed}),r.a.createElement(me,{type:"trigger",title:"Display solid or wire",iconName:"fill-drip",onClick:this.props.onToggleWidthModePressed}),r.a.createElement(me,{type:"trigger",title:"Display vertices on/off",iconName:"draw-polygon",onClick:this.props.onToggleVerticesPressed}),r.a.createElement(me,{type:"trigger",title:"Display labels on/off",iconName:"tag",onClick:this.props.onToggleLabelsPressed}),this.props.showSkeletonRecognitionButton?r.a.createElement(me,{type:"trigger",title:"Skeleton Recognition Demo",iconName:"tree",onClick:this.props.onSkeletonRecognitionButtonPressed}):null,r.a.createElement(ve,null),r.a.createElement("button",{className:Ee.a["App-toolbar-units"],onClick:this.props.onUnitClicked},this.props.units),r.a.createElement(ve,null),r.a.createElement(me,{type:"trigger",title:"About",iconName:"info",onClick:this.props.onShowAboutPopupPressed}),r.a.createElement(ve,null))}}]),t}(n.Component)),_e=a(58),Oe=a.n(_e),Se=a(26),we=a(12),Ae=function(e){function t(e){var a;return Object(m.a)(this,t),a=Object(J.a)(this,Object(q.a)(t).call(this,e)),we.g.enable(Object(Se.a)(a)),a.mouseMoveOutside=!1,a.enableMouseOver(20),a.canvas.clientWidth>0&&a.canvas.clientHeight>0&&(a.canvas.width=a.canvas.clientWidth,a.canvas.height=a.canvas.clientHeight),a.origin={x:a.canvas.width/2,y:a.canvas.height/2},a.resolution=1e-5,a.zoomFactor=1,a.oldOrigin={x:void 0,y:void 0},a.oldZoomFactor=void 0,a.pinchAnchorX=void 0,a.pinchAnchorY=void 0,a.pinchStarted=!1,a}return Object($.a)(t,e),Object(f.a)(t,[{key:"clone",value:function(){var e=new t(this.canvas);return Object.assign(e,this)}},{key:"add",value:function(e){return this.addChild(e),this}},{key:"scalingFactor",value:function(){return this.resolution*this.zoomFactor}},{key:"C2W_Scalar",value:function(e){return e/this.scalingFactor()}},{key:"W2C_Scalar",value:function(e){return this.scalingFactor()*e}},{key:"C2W_X",value:function(e){return(e-this.origin.x)/this.scalingFactor()}},{key:"C2W_Y",value:function(e){return(this.origin.y-e)/this.scalingFactor()}},{key:"W2C_X",value:function(e){return this.scalingFactor()*e+this.origin.x}},{key:"W2C_Y",value:function(e){return this.origin.y-this.scalingFactor()*e}},{key:"W2C",value:function(e){return{x:this.W2C_X(e.x),y:this.W2C_Y(e.y)}}},{key:"panTo",value:function(e){this.origin={x:e.x,y:e.y}}},{key:"panBy",value:function(e,t){this.origin={x:this.origin.x+e,y:this.origin.y+t}}},{key:"zoomIn",value:function(e){var t=e||1.1;this.zoomFactor=Math.min(1e7,t*this.zoomFactor)}},{key:"zoomOut",value:function(e){var t=e||1.1;this.zoomFactor=Math.max(.001,this.zoomFactor/t)}},{key:"zoom",value:function(e,t,a,n){var r=this.C2W_X(e),o=this.C2W_Y(t);a?this.zoomIn(n):this.zoomOut(n);var s=this.W2C_X(r),i=this.W2C_Y(o);return this.panBy(e-s,t-i),[s,i]}},{key:"zoomByMouse",value:function(e,t,a,n){this.zoom(e,t,a,n)}},{key:"zoomToLimits",value:function(e,t){0===e&&(e=4e5),0===t&&(t=4e5);var a=Math.min(this.canvas.width/(1.1*e),this.canvas.height/(1.1*t))/this.resolution/this.zoomFactor,n=this.canvas.width/2,r=this.canvas.height/2;this.zoom(n,r,!0,a)}},{key:"resize",value:function(){this.canvas.clientWidth>0&&this.canvas.clientHeight>0&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight)}},{key:"panByMouseStart",value:function(){this.oldOrigin.x=this.origin.x,this.oldOrigin.y=this.origin.y,this.zoomByPinchStop()}},{key:"panByMouseMove",value:function(e,t){this.pinchStarted||void 0!==e&&void 0!==t&&void 0!==this.oldOrigin.x&&void 0!==this.oldOrigin.y&&(this.origin={x:this.oldOrigin.x+e,y:this.oldOrigin.y+t})}},{key:"panByMouseStop",value:function(){this.oldOrigin.x=void 0,this.oldOrigin.y=void 0}},{key:"panToCoordinate",value:function(e,t){var a=this.W2C_X(e),n=this.W2C_Y(t),r=this.canvas.width/2-a,o=this.canvas.height/2-n;this.panBy(r,o)}},{key:"zoomByPinchStart",value:function(e,t){this.oldZoomFactor=this.zoomFactor,this.pinchAnchorX=this.C2W_X(e),this.pinchAnchorY=this.C2W_Y(t),this.pinchStarted=!0,this.panByMouseStop()}},{key:"zoomByPinchMove",value:function(e,t,a){this.zoomFactor=a*this.oldZoomFactor,this.origin={x:e-this.scalingFactor()*this.pinchAnchorX,y:t+this.scalingFactor()*this.pinchAnchorY}}},{key:"zoomByPinchStop",value:function(){this.oldZoomFactor=void 0,this.pinchAnchorX=void 0,this.pinchAnchorY=void 0,this.pinchStarted=!1}},{key:"clear",value:function(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"box",get:function(){var e=this.C2W_X(0),t=this.C2W_Y(this.canvas.height),a=this.C2W_X(this.canvas.width),n=this.C2W_Y(0);return new y.c(e,t,a,n)}}]),t}(we.e),Te=function(e,t,a,n){return{type:"MOUSE_WHEEL_MOVE_ON_STAGE",stage:e,x:t,y:a,delta:n}},De=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(o)))).canvasElement=r.a.createRef(),a.handleMouseMove=function(e){if(a.props.stage.canvas.focus(),e.nativeEvent.touches&&1!==e.nativeEvent.touches.length){if(e.nativeEvent.touches&&2===e.nativeEvent.touches.length){var t=[{x:e.nativeEvent.touches[0].clientX-e.nativeEvent.target.offsetLeft,y:e.nativeEvent.touches[0].clientY-e.nativeEvent.target.offsetTop},{x:e.nativeEvent.touches[1].clientX-e.nativeEvent.target.offsetLeft,y:e.nativeEvent.touches[1].clientY-e.nativeEvent.target.offsetTop}];a.props.handlePinchMove(a.props.stage,t)}}else a.props.handleMouseMove(a.props.stage,e.stageX,e.stageY,a.props.mouse.startX?e.stageX-a.props.mouse.startX:void 0,a.props.mouse.startY?e.stageY-a.props.mouse.startY:void 0)},a.handleMouseDown=function(e){if(e.nativeEvent.touches&&1!==e.nativeEvent.touches.length){if(e.nativeEvent.touches&&2===e.nativeEvent.touches.length){var t=[{x:e.nativeEvent.touches[0].clientX-e.nativeEvent.target.offsetLeft,y:e.nativeEvent.touches[0].clientY-e.nativeEvent.target.offsetTop},{x:e.nativeEvent.touches[1].clientX-e.nativeEvent.target.offsetLeft,y:e.nativeEvent.touches[1].clientY-e.nativeEvent.target.offsetTop}];a.props.handlePinchDown(a.props.stage,t)}}else a.props.handleMouseDown(a.props.stage,e.stageX,e.stageY)},a.handleMouseUp=function(e){e.stopPropagation(),e.preventDefault(),e.nativeEvent.touches&&1!==e.nativeEvent.touches.length?e.nativeEvent.touches&&2===e.nativeEvent.touches.length&&a.props.handlePinchUp(a.props.stage):a.props.handleMouseUp(a.props.stage)},a.handleMouseLeave=function(e){a.props.stage.canvas.blur(),document.body.focus()},a.handleMouseWheel=function(e){var t=e.detail||e.wheelDelta;0!==t&&a.props.handleMouseWheelMove(a.props.stage,e.offsetX,e.offsetY,t)},a.handleMouseWheelFox=function(e){0!==e.detail&&a.props.handleMouseWheelMove(a.props.stage,e.layerX,e.layerY,-e.detail)},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=new Ae(this.canvasElement.current);e.on("stagemousedown",this.handleMouseDown),e.on("stagemousemove",this.handleMouseMove),e.on("stagemouseup",this.handleMouseUp),e.on("mouseleave",this.handleMouseLeave),e.canvas.addEventListener("mousewheel",this.handleMouseWheel,{passive:!0}),e.canvas.addEventListener("DOMMouseScroll",this.handleMouseWheelFox,{passive:!0}),this.props.registerStage(e)}},{key:"render",value:function(){return r.a.createElement("canvas",{tabIndex:"1",ref:this.canvasElement,id:"mainCanvas",className:Oe.a["App-canvas"],width:"100",height:"100"})}}]),t}(n.Component),Ce=Object(l.b)(function(e){return{stage:e.app.stage,mouse:e.mouse}},function(e){return{registerStage:function(t){return e(function(e){return{type:"NEW_STAGE_CREATED",stage:e}}(t))},handleMouseDown:function(t,a,n){return e(function(e,t,a){return{type:"MOUSE_DOWN_ON_STAGE",stage:e,x:t,y:a}}(t,a,n))},handleMouseUp:function(t,a,n){return e(function(e,t,a){return{type:"MOUSE_UP_ON_STAGE",stage:e,x:t,y:a}}(t,a,n))},handleMouseMove:function(t,a,n,r,o){return e(function(e,t,a,n,r){return{type:"MOUSE_MOVED_ON_STAGE",stage:e,x:t,y:a,dx:n,dy:r}}(t,a,n,r,o))},handleMouseWheelMove:function(t,a,n,r){return e(Te(t,a,n,r))},handlePinchDown:function(t,a){return e(function(e,t){return{type:"PINCH_DOWN_ON_STAGE",stage:e,x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}(t,a))},handlePinchMove:function(t,a){return e(function(e,t){return{type:"PINCH_MOVED_ON_STAGE",stage:e,x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}(t,a))},handlePinchUp:function(t){return e(function(e){return{type:"PINCH_UP_ON_STAGE",stage:e}}(t))}}})(De),ke=a(59),Le=a.n(ke),Pe=function(){return r.a.createElement("div",{className:Le.a["App-status-bar"]},r.a.createElement("div",null,r.a.createElement("h5",null,"\xa0")))},Ne=function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){if(this.props.stage.canvas&&this.props.stage.canvas.getContext("2d")){var e=this.props.stage.origin,t=this.props.stage.zoomFactor*this.props.stage.resolution;this.props.stage.setTransform(e.x,e.y,t,-t),this.props.stage.update()}}},{key:"componentWillUnmount",value:function(){this.props.onStageUnmounted()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.children)}}]),t}(n.Component);function Ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e instanceof y.n?function(e,t){var a=t&&t.radius?t.radius:3,n=t&&t.fill?t.fill:"#FF0303",r=new we.b;return r.fill=r.beginFill(n).command,r.circle=r.drawCircle(e.x,e.y,a).command,r}(e,t):e instanceof y.p?function(e,t){var a=new we.b,n=t&&void 0!==t.strokeStyle?t.strokeStyle:2,r=!t||void 0===t.ignoreScale||t.ignoreScale,o=t&&t.stroke?t.stroke:"black";return a.setStrokeStyle(n,1,0,10,r).beginStroke(o).moveTo(e.ps.x,e.ps.y).lineTo(e.pe.x,e.pe.y).endStroke()}(e,t):e instanceof y.a?function(e,t){var a=new we.b,n=t&&t.strokeStyle?t.strokeStyle:2,r=!t||void 0===t.ignoreScale||t.ignoreScale,o=t&&t.stroke?t.stroke:"black";return a.setStrokeStyle(n,1,0,10,r).beginStroke(o).arc(e.pc.x,e.pc.y,e.r,e.startAngle,e.endAngle,!e.counterClockwise).endStroke()}(e,t):e instanceof y.f?function(e,t){var a=new we.b,n=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";return a.setStrokeStyle(n,0,0,10,!0),a.stroke=a.beginStroke(r).command,a.fill=a.beginFill(o).command,a.drawCircle(e.pc.x,e.pc.y,e.r),a}(e,t):e instanceof y.c?function(e,t){var a=new we.b,n=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";return a.setStrokeStyle(n,0,0,10,!0),a.stroke=a.beginStroke(r).command,a.fill=a.beginFill(o).command,a.drawRect(e.xmin,e.ymin,e.xmax-e.xmin,e.ymax-e.ymin),a}(e,t):e instanceof y.o?function(e,t){var a=new we.b,n=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";a.setStrokeStyle(n,0,0,10,!0),a.stroke=a.beginStroke(r).command,a.fill=a.beginFill(o).command;var s=!0,i=!1,l=void 0;try{for(var c,u=e.faces[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var p=c.value;xe(a,p)}}catch(d){i=!0,l=d}finally{try{s||null==u.return||u.return()}finally{if(i)throw l}}return a.endStroke(),a}(e,t):null}function Me(e,t){t.shape instanceof y.p?function(e,t){e.lineTo(t.pe.x,t.pe.y)}(e,t.shape):t.shape instanceof y.a&&function(e,t){e.arc(t.pc.x,t.pc.y,t.r,t.startAngle,t.endAngle,!t.counterClockwise)}(e,t.shape)}function xe(e,t){var a=t.first.start;e.moveTo(a.x,a.y);var n=!0,r=!1,o=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){Me(e,s.value)}}catch(l){r=!0,o=l}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}}var je=function(e,t){for(var a=!0,n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];if(t[o]!==e[o]){a=!1;break}}return a},Ue=function(e,t,a){return(e/t).toFixed(a)},Re=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(J.a)(this,Object(q.a)(t).call(this))).handleMouseOver=function(e){a.props.onMouseOver(a.props.model)},a.handleMouseOut=function(e){a.props.onMouseOut()},a.handleClick=function(e){a.props.onClick(a.props.model,a.props.layer)},a.shape=new we.d,e.stage.addChild(a.shape),a}return Object($.a)(t,e),Object(f.a)(t,[{key:"redraw",value:function(){var e=this.props.stage,t=this.props.hovered||this.props.selected?"black":this.props.color,a=this.props.hovered||this.props.selected?1:.6,n=this.props.widthOn,r=this.props.model.geom.aperture?this.props.model.geom.aperture:void 0,o=n?this.props.color:"white";this.shape.graphics.isEmpty()?this.shape.graphics=Ie(this.props.model.geom,{strokeStyle:r,ignoreScale:!0,stroke:t,fill:o,radius:3/(e.zoomFactor*e.resolution)}):(this.shape.graphics.stroke&&(this.shape.graphics.stroke.style=t),this.shape.graphics.fill&&(this.shape.graphics.fill.style=o),this.shape.graphics.circle&&(this.shape.graphics.circle.radius=3/(e.zoomFactor*e.resolution))),this.shape.alpha=this.props.displayed?a:0}},{key:"componentDidMount",value:function(){this.shape.on("mouseover",this.handleMouseOver),this.shape.on("mouseout",this.handleMouseOut),this.shape.on("click",this.handleClick),this.redraw()}},{key:"shouldComponentUpdate",value:function(e,t){return!je(this.props,e)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.shape.off("mouseover",this.handleMouseOver),this.shape.off("mouseout",this.handleMouseOut),this.shape.off("click",this.handleClick),this.props.stage.removeChild(this.shape),this.shape.graphics.clear()}},{key:"render",value:function(){return null}}]),t}(n.Component),Fe=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).handleMouseOver=function(e){a.props.onMouseOver(a.props.model)},a.handleMouseOut=function(e){a.props.onMouseOut()},a.handleClick=function(e){a.props.onClick(a.props.model,a.props.layer)},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"redraw",value:function(){if(this.bitmap){this.bitmap.alpha=this.props.displayed?1:0;var e=this.props.model.geom.width,t=this.bitmap.image.naturalWidth/this.bitmap.image.naturalHeight;this.props.model.geom.height=this.props.model.geom.width/t;var a=e/this.bitmap.image.naturalWidth,n=e/(this.bitmap.image.naturalHeight*t),r=this.props.model.geom.center.x,o=this.props.model.geom.center.y;this.bitmap.setTransform(r,o,a,-n),this.bitmap.regX=this.bitmap.image.naturalWidth/2,this.bitmap.regY=this.bitmap.image.naturalHeight/2}}},{key:"loadImage",value:function(){var e=this,t=new Image;t.onload=function(){e.bitmap=new we.a(t),e.props.stage.addChild(e.bitmap),e.redraw(),e.props.onImageLoaded(e.props.model,e.props.layer,t)},t.setAttribute("crossOrigin","anonymous"),t.src=this.props.model.geom.uri}},{key:"componentDidMount",value:function(){this.loadImage()}},{key:"shouldComponentUpdate",value:function(e,t){return!je(this.props,e)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.props.stage.removeChild(this.bitmap)}},{key:"render",value:function(){return null}}]),t}(n.Component),Be=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).onImageLoaded=function(e,t,n){a.props.setHomeView(a.props.stage,a.props.layer),a.forceUpdate()},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return this.props.layer.shapes.map(function(t,a){return t.geom.uri?r.a.createElement(Fe,{key:a,stage:e.props.stage,layer:e.props.layer,model:t,displayed:e.props.layer.displayed,hovered:t===e.props.hoveredShape,selected:t===e.props.firstMeasuredShape||t===e.props.secondMeasuredShape,color:e.props.layer.color,widthOn:e.props.widthOn,displayLabels:e.props.displayLabels,zoomFactor:e.props.zoomFactor,onMouseOver:e.props.onMouseOver,onMouseOut:e.props.onMouseOut,onClick:e.props.onClick,onImageLoaded:e.onImageLoaded}):r.a.createElement(Re,{key:a,stage:e.props.stage,layer:e.props.layer,model:t,displayed:e.props.layer.displayed,hovered:t===e.props.hoveredShape,selected:t===e.props.firstMeasuredShape||t===e.props.secondMeasuredShape,color:e.props.layer.color,widthOn:e.props.widthOn,displayVertices:e.props.displayVertices,zoomFactor:e.props.zoomFactor,onMouseOver:e.props.handleMouseRollOverShape,onMouseOut:e.props.handleMouseRollOutShape,onClick:e.props.handleClickOnShape})})}}]),t}(n.Component),Ye=Object(l.b)(function(e){return{stage:e.app.stage,layers:e.layers,displayVertices:e.app.displayVertices,displayLabels:e.app.displayLabels,widthOn:e.app.widthOn,zoomFactor:e.app.zoomFactor,units:e.app.units,divisor:e.app.divisor,decimals:e.app.decimals,measurePointsActive:e.app.measurePointsActive,showAboutPopup:e.app.showAboutPopup,showDownloadPopup:e.app.showDownloadPopup,showUploadPopup:e.app.showUploadPopup,measureShapesTool:e.measureShapesTool,hoveredShape:e.measureShapesTool.hoveredShape,firstMeasuredShape:e.measureShapesTool.firstMeasuredShape,secondMeasuredShape:e.measureShapesTool.secondMeasuredShape}},function(e){return{setHomeView:function(t,a){return e(re(t,a))},handleMouseRollOverShape:function(t){return e(function(e){return{type:"MOUSE_ROLL_OVER_SHAPE",shape:e}}(t))},handleMouseRollOutShape:function(){return e({type:"MOUSE_ROLL_OUT_SHAPE"})},handleClickOnShape:function(t,a){return e(function(e,t){return{type:"MOUSE_CLICKED_ON_SHAPE",shape:e,layer:t}}(t,a))}}})(Be),We=a(60),Xe=a.n(We),ze=function(e){var t=e.stage,a=e.shape,n=a.geom.center||a.geom,o=t.canvas.offsetLeft+t.W2C_X(n.x)+6,s=t.canvas.offsetTop+t.W2C_Y(n.y)-4;return o>t.canvas.offsetLeft&&o<t.canvas.offsetLeft+t.canvas.width&&s>t.canvas.offsetTop&&s<t.canvas.offsetTop+t.canvas.height?r.a.createElement("div",{style:{position:"absolute",left:o+"px",top:s+"px"},className:Xe.a.LabelComponent},r.a.createElement("h5",null,a.label)):null},Ge=Object(l.b)(function(e){return{stage:e.app.stage,displayLabels:e.app.displayLabels,zoomFactor:e.app.zoomFactor,originX:e.app.originX,originY:e.app.originY}},function(e){return{}})(function(e){return e.layer.displayed&&e.displayLabels?e.layer.shapes.map(function(t,a){return t.label&&""!==t.label.trim()?r.a.createElement(ze,{key:a,stage:e.stage,shape:t,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY}):null}):null}),He=a(61),Ve=a.n(He),Ke=function(e){var t=e.stage,a=t.canvas.offsetLeft+t.W2C_X(e.vertex.x)+6,n=t.canvas.offsetTop+t.W2C_Y(e.vertex.y)-10,o=Ue(e.vertex.x,e.divisor,e.decimals),s=Ue(e.vertex.y,e.divisor,e.decimals);return r.a.createElement("div",{className:Ve.a.VertexLabel,style:{left:a,top:n}},r.a.createElement("h5",null,"x=",o," y=",s))},Ze=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(J.a)(this,Object(q.a)(t).call(this))).handleMouseOver=function(e){a.shape.shadow=new we.c(a.props.color,0,0,10),a.setState({hovered:!0})},a.handleMouseOut=function(e){a.shape.shadow=null,a.setState({hovered:!1})},a.handleClick=function(e){console.log(a.props.vertex)},a.shape=new we.d,e.stage.addChild(a.shape),a.state={hovered:!1},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"redraw",value:function(){var e=this.props.stage,t=this.props.color,a=this.props.color;this.shape.graphics.isEmpty()?this.shape.graphics=Ie(this.props.vertex,{stroke:t,fill:a,radius:3/(e.zoomFactor*e.resolution)}):(this.shape.graphics.circle.radius=3/(e.zoomFactor*e.resolution),this.shape.graphics.fill.style=a),this.shape.alpha=1}},{key:"componentDidMount",value:function(){this.shape.on("mouseover",this.handleMouseOver),this.shape.on("mouseout",this.handleMouseOut),this.shape.on("click",this.handleClick),this.shape.mouseEnabled=!0,this.redraw()}},{key:"shouldComponentUpdate",value:function(e,t){return!je(this.props,e)||!je(this.state,t)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.shape.off("mouseover",this.handleMouseOver),this.shape.off("mouseout",this.handleMouseOut),this.shape.off("click",this.handleClick),this.props.stage.removeChild(this.shape),this.shape.graphics.clear()}},{key:"render",value:function(){return this.state.hovered?r.a.createElement(Ke,{stage:this.props.stage,vertex:this.props.vertex,divisor:this.props.divisor,decimals:this.props.decimals}):null}}]),t}(n.Component),Qe=function(e){return e.model.geom.vertices?e.model.geom.vertices.map(function(t,a){return r.a.createElement(Ze,{key:a,stage:e.stage,vertex:t,color:e.color,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY})}):null},Je=Object(l.b)(function(e){return{stage:e.app.stage,displayVertices:e.app.displayVertices,zoomFactor:e.app.zoomFactor,originX:e.app.originX,originY:e.app.originY,divisor:e.app.divisor,decimals:e.app.decimals}},function(e){return{}})(function(e){return e.layer.displayed&&e.displayVertices?e.layer.shapes.map(function(t,a){return r.a.createElement(Qe,{key:a,stage:e.stage,model:t,color:e.layer.color,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY})}):null}),qe=function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.props.layers.map(function(e){return r.a.createElement(r.a.Fragment,{key:e.name},r.a.createElement(Ye,{layer:e}),r.a.createElement(Ge,{layer:e}),r.a.createElement(Je,{layer:e}))})}}]),t}(n.Component),$e=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(o)))).measureCanvas=r.a.createRef(),a.measureStage=null,a.state={startX:void 0,startY:void 0,endX:void 0,endY:void 0,measureStarted:!1},a.handleMouseDown=function(e){e.preventDefault(),a.measureStage.clear(),a.state.measureStarted?(a.setState({startX:void 0,startY:void 0,endX:void 0,endY:void 0,measureStarted:!1}),a.measureStage.canvas.style.cursor="auto"):(a.setState({startX:a.measureStage.C2W_X(e.stageX),startY:a.measureStage.C2W_Y(e.stageY),measureStarted:!0}),a.measureStage.canvas.style.cursor="crosshair")},a.handleMouseMove=function(e){a.state.measureStarted&&a.setState({endX:a.measureStage.C2W_X(e.stageX),endY:a.measureStage.C2W_Y(e.stageY)})},a.handleMouseUp=function(e){},a.handleMouseWheel=function(e){e.preventDefault();var t=e.detail||e.wheelDelta;0!==t&&(a.props.handleMouseWheelMove(a.props.stage,e.offsetX,e.offsetY,t),a.draw())},a.handleMouseWheelFox=function(e){e.preventDefault(),0!==e.detail&&(a.props.handleMouseWheelMove(a.props.stage,e.layerX,e.layerY,-e.detail),a.draw())},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"draw",value:function(){var e=this.measureStage,t=e.canvas.getContext("2d");this.measureStage.origin=this.props.stage.origin,this.measureStage.resolution=this.props.stage.resolution,this.measureStage.zoomFactor=this.props.stage.zoomFactor,this.measureStage.clear();var a,n,r,o,s,i=Math.min(e.W2C_X(this.state.startX),e.W2C_X(this.state.endX)),l=Math.min(e.W2C_Y(this.state.startY),e.W2C_Y(this.state.endY)),c=Math.abs(e.W2C_Scalar(this.state.startX-this.state.endX)),u=Math.abs(e.W2C_Scalar(this.state.startY-this.state.endY));t.beginPath(),t.rect(i,l,c,u),t.moveTo(e.W2C_X(this.state.startX),e.W2C_Y(this.state.startY)),t.lineTo(e.W2C_X(this.state.endX),e.W2C_Y(this.state.endY)),t.lineWidth=1,t.strokeStyle="black",t.stroke();var p=this.measurement();t.font="12pt Arial",r=t.measureText(p).width,Math.abs(e.W2C_X(this.state.endX)-i)<=2?(t.textAlign="left",a=i+3,o=i):(t.textAlign="right",o=(a=i+c-3)-r-3),s=(n=Math.abs(e.W2C_Y(this.state.endY)-l)<=2?l-3:l+u+12+3)-12-3,t.fillStyle="white",t.globalAlpha=.4,t.fillRect(o,s,r+6,18),t.fillStyle="black",t.globalAlpha=1,t.fillText(this.measurement(),a,n)}},{key:"measurement",value:function(){var e=this.state.endX-this.state.startX,t=this.state.endY-this.state.startY,a=Math.sqrt(e*e+t*t);return"DX="+this.format(e)+",DY="+this.format(t)+",D="+this.format(a)}},{key:"format",value:function(e){return(e/this.props.divisor).toFixed(this.props.decimals)}},{key:"componentDidMount",value:function(){this.measureStage=new Ae(this.measureCanvas.current),this.measureStage.origin=this.props.stage.origin,this.measureStage.resolution=this.props.stage.resolution,this.measureStage.zoomFactor=this.props.stage.zoomFactor,this.measureStage.on("stagemousedown",this.handleMouseDown),this.measureStage.on("stagemousemove",this.handleMouseMove),this.measureStage.on("stagemouseup",this.handleMouseUp),this.measureStage.canvas.addEventListener("mousewheel",this.handleMouseWheel),this.measureStage.canvas.addEventListener("DOMMouseScroll",this.handleMouseWheelFox)}},{key:"componentDidUpdate",value:function(){this.state.measureStarted&&this.draw()}},{key:"componentWillUnmount",value:function(){this.measureStage.clear(),this.measureStage.removeAllChildren(),this.measureStage.removeAllEventListeners()}},{key:"render",value:function(){var e=this.props.stage.canvas,t=e.width,a=e.height,n=e.offsetTop,o=e.offsetLeft;return r.a.createElement("canvas",{tabIndex:"1",ref:this.measureCanvas,width:t,height:a,style:{position:"absolute",top:n,left:o}})}}]),t}(n.Component),et=Object(l.b)(function(e){var t=e.app;return{stage:t.stage,divisor:t.divisor,decimals:t.decimals}},function(e){return{handleMouseWheelMove:function(t,a,n,r){return e(Te(t,a,n,r))}}})($e),tt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(J.a)(this,Object(q.a)(t).call(this))).segment=new we.d,e.stage.addChild(a.segment),a.labelShape=new we.f,a.labelShape.x=0,a.labelShape.y=0,e.stage.addChild(a.labelShape),a}return Object($.a)(t,e),Object(f.a)(t,[{key:"format",value:function(e){return(e/this.props.divisor).toFixed(this.props.decimals)}},{key:"redrawLabel",value:function(){if(this.labelShape){var e=this.props.stage,t=this.props.shortestSegment.box,a=(t.xmin+t.xmax)/2,n=(t.ymin+t.ymax)/2,r=6/(e.zoomFactor*e.resolution),o=4/(e.zoomFactor*e.resolution);t.ymin===t.ymax&&(r=0,o=-o),this.labelShape.text=this.format(this.props.shortestSegment.length);this.labelShape.font="".concat(14,"px Arial");var s=1/(e.zoomFactor*e.resolution),i=a+r,l=n+o;this.labelShape.setTransform(i,l,s,-s)}}},{key:"draw",value:function(){this.props.shortestSegment&&(this.segment.graphics=Ie(this.props.shortestSegment),this.redrawLabel())}},{key:"componentDidMount",value:function(){this.draw()}},{key:"componentDidUpdate",value:function(){this.segment.graphics.clear(),this.props.firstMeasuredShape&&this.props.secondMeasuredShape&&this.props.firstMeasuredLayer.displayed&&this.props.secondMeasuredLayer.displayed&&(this.draw(),this.redrawLabel())}},{key:"componentWillUnmount",value:function(){this.props.stage.removeChild(this.segment),this.segment.graphics.clear(),this.props.stage.removeChild(this.labelShape),this.labelShape.text=""}},{key:"render",value:function(){return null}}]),t}(n.Component),at=function(e){var t=e.stage,a=e.coordX,n=e.coordY,o=e.divisor,s=e.decimals,i=t.canvas,l=i.offsetTop+10,c=i.width-200,u=t.C2W_X(a),p=t.C2W_Y(n);return r.a.createElement("div",{style:{position:"absolute",top:l,left:c,backgroundColor:"white",opacity:.8}},r.a.createElement("h5",{style:{margin:0,padding:3}},"X: ",Ue(u,o,s)," Y: ",Ue(p,o,s)))},nt=a(62),rt=a.n(nt),ot=document.getElementById("modal-root"),st=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(J.a)(this,Object(q.a)(t).call(this,e))).el=document.createElement("div"),a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){ot.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){ot.removeChild(this.el)}},{key:"render",value:function(){return s.a.createPortal(this.props.children,this.el)}}]),t}(n.Component),it=a(42),lt=a.n(it),ct=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).onBackDropClicked=function(e){"backDrop"===e.target.id&&a.props.closePopup()},a.handleKeyDown=function(e){"Escape"===e.code&&a.props.closePopup()},a.elementDrag=function(e){e=e||window.event,a.offsetX=a.dragX-e.clientX,a.offsetY=a.dragY-e.clientY,a.dragX=e.clientX,a.dragY=e.clientY;var t=e.target;t.style.top=t.offsetTop-a.offsetY+"px",t.style.left=t.offsetLeft-a.offsetX+"px"},a.closeDragElement=function(e){e.target.onmouseup=null,e.target.onmousemove=null},a.dragMouseDown=function(e){e=e||window.event,a.dragX=e.clientX,a.dragY=e.clientY,e.target.onmouseup=a.closeDragElement,e.target.onmousemove=a.elementDrag},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return this.props.showPopup?r.a.createElement(st,null,r.a.createElement("div",{id:"backDrop",className:lt.a.BackDrop,onClick:this.onBackDropClicked},r.a.createElement("div",{className:lt.a.ModalPopup,onMouseDown:this.dragMouseDown},r.a.createElement("header",null,this.props.header),this.props.children))):null}}]),t}(n.Component),ut=function(e){return r.a.createElement(ct,{showPopup:e.showAboutPopup,closePopup:e.toggleAboutPopup,header:"Info"},r.a.createElement("div",{className:rt.a.AboutPopup},r.a.createElement("h2",null,e.title," v",e.version),r.a.createElement("label",null,"Build date: "),r.a.createElement("span",null,"April 2019"),r.a.createElement("br",null),r.a.createElement("label",null,"Github depository: "),r.a.createElement("a",{href:"https://github.com/alexbol99/debug-viewer1"},"https://github.com/alexbol99/debug-viewer1"),r.a.createElement("br",null),r.a.createElement("label",null,"3d party graphics library: "),r.a.createElement("a",{href:"https://github.com/CreateJS/EaselJS/tree/2.0"},"https://github.com/CreateJS/EaselJS/tree/2.0"),r.a.createElement("br",null)))},pt=a(63),dt=a.n(pt);function ht(e,t){e.startElement("point"),e.writeAttribute("x",t.geom.x),e.writeAttribute("y",t.geom.y),e.writeAttribute("label",t.label),e.endElement()}function mt(e,t){e.startElement("segment"),e.writeAttribute("xs",t.geom.ps.x),e.writeAttribute("ys",t.geom.ps.y),e.writeAttribute("xe",t.geom.pe.x),e.writeAttribute("ye",t.geom.pe.y),e.writeAttribute("label",t.label),e.endElement()}function ft(e,t){e.startElement("arc"),e.writeAttribute("xs",Math.round(t.geom.start.x)),e.writeAttribute("ys",Math.round(t.geom.start.y)),e.writeAttribute("xe",Math.round(t.geom.end.x)),e.writeAttribute("ye",Math.round(t.geom.end.y)),e.writeAttribute("xc",t.geom.center.x),e.writeAttribute("yc",t.geom.center.y),e.writeAttribute("cw",t.geom.counterClockwise===y.e?"yes":"no"),e.writeAttribute("label",t.label),e.endElement()}function yt(e,t){e.startElement("circle"),e.writeAttribute("xc",t.geom.center.x),e.writeAttribute("yc",t.geom.center.y),e.writeAttribute("label",t.label),e.endElement()}function vt(e,t){e.startElement("profile");var a=!0,n=!1,r=void 0;try{for(var o,s=t.faces[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var i=o.value;i.orientation()===y.j.CW?e.startElement("island"):e.startElement("hole"),e.writeAttribute("n_edges","".concat(i.size));var l=!0,c=!1,u=void 0;try{for(var p,d=i[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var h=p.value;e.startElement("edge");var m=h.shape;m instanceof y.p?(e.writeAttribute("type","segment"),e.writeAttribute("xs",m.ps.x),e.writeAttribute("ys",m.ps.y),e.writeAttribute("xe",m.pe.x),e.writeAttribute("ye",m.pe.y)):h.shape instanceof y.a?(e.writeAttribute("type","curve"),e.writeAttribute("xs",Math.round(m.start.x)),e.writeAttribute("ys",Math.round(m.start.y)),e.writeAttribute("xe",Math.round(m.end.x)),e.writeAttribute("ye",Math.round(m.end.y)),e.writeAttribute("xc",m.center.x),e.writeAttribute("yc",m.center.y),e.writeAttribute("cw",m.counterClockwise===y.e?"yes":"no")):e.writeAttribute("type","unknown"),e.endElement()}}catch(f){c=!0,u=f}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.endElement()}}catch(f){n=!0,r=f}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}e.endElement()}function gt(e){var t=new dt.a(!0);t.startDocument("1.0","UTF-8"),t.startElement("shapes"),t.startElement("title").text("test polygon in xml format").endElement();var a=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var i=o.value;i.geom instanceof y.n?ht(t,i):i.geom instanceof y.p?mt(t,i):i.geom instanceof y.a?ft(t,i):i.geom instanceof y.f?yt(t,i):i.geom instanceof y.c||i.geom instanceof y.o&&vt(t,i.geom)}}catch(l){n=!0,r=l}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return t.endDocument(),t.toString()}var Et=a(64),bt=a.n(Et),_t=function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.showPopup?this.props.layers.map(function(e){return e.displayed?{filename:"".concat(e.name,".xml"),xmlString:gt(e.shapes)}:null}):[];return this.props.showPopup&&this.props.layers.length>0?r.a.createElement(ct,{showPopup:this.props.showPopup,closePopup:this.props.closePopup,header:"Download files"},r.a.createElement("div",{className:bt.a.DownloadPopup},r.a.createElement("h5",null,"Click to the following links to start download"),r.a.createElement("ul",null,e.map(function(e){return null===e?null:r.a.createElement("li",{key:e.filename},r.a.createElement("a",{href:"data:text/json;charset=utf-8,"+encodeURIComponent(e.xmlString),download:e.filename},e.filename))})))):null}}]),t}(n.Component),Ot=document.getElementById("snackbar-root"),St=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(J.a)(this,Object(q.a)(t).call(this,e))).el=document.createElement("div"),a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){Ot.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){Ot.removeChild(this.el)}},{key:"render",value:function(){return s.a.createPortal(this.props.children,this.el)}}]),t}(n.Component),wt=a(65),At=a.n(wt),Tt=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).state={display:!0},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"animationEndHandler",value:function(){this.setState({display:!1}),this.props.onAnimationEnd()}},{key:"render",value:function(){return this.state.display?r.a.createElement(St,null,r.a.createElement("div",{className:At.a.Snackbar,onAnimationEnd:this.props.onAnimationEnd},r.a.createElement("h3",null,this.props.message))):null}}]),t}(n.Component),Dt=a(29),Ct=a.n(Dt);function kt(e){for(var t=[],a=0,n=Array.from(e);a<n.length;a++){var r=n[a],o=r.getAttribute("type");if("segment"===o){var s=new y.n(parseInt(r.getAttribute("xs"),10),parseInt(r.getAttribute("ys"),10)),i=new y.n(parseInt(r.getAttribute("xe"),10),parseInt(r.getAttribute("ye"),10));t.push(new y.p(s,i))}if("curve"===o){var l=new y.n(parseInt(r.getAttribute("xs"),10),parseInt(r.getAttribute("ys"),10)),c=new y.n(parseInt(r.getAttribute("xe"),10),parseInt(r.getAttribute("ye"),10)),u=new y.n(parseInt(r.getAttribute("xc"),10),parseInt(r.getAttribute("yc"),10)),p="no"===r.getAttribute("cw"),d=Object(y.w)(u,l).slope,h=Object(y.w)(u,c).slope;y.t.Utils.EQ(d,h)&&(h=p?h+2*Math.PI:h-2*Math.PI);var m=Object(y.w)(u,l).length;t.push(new y.a(u,m,d,h,p))}}return t}function Lt(e){var t=new y.o,a=e.getAttribute("color");t.style={stroke:a||void 0,fill:a||void 0,alpha:1};var n=e.getAttribute("label");t.label=n;for(var r=e.getElementsByTagName("island"),o=0,s=Array.from(r);o<s.length;o++){var i=s[o].getElementsByTagName("edge");t.addFace(kt(i))}for(var l=e.getElementsByTagName("hole"),c=0,u=Array.from(l);c<u.length;c++){var p=u[c].getElementsByTagName("edge");t.addFace(kt(p))}return t}function Pt(e){var t=new y.n(parseInt(e.getAttribute("xs"),10),parseInt(e.getAttribute("ys"),10)),a=new y.n(parseInt(e.getAttribute("xe"),10),parseInt(e.getAttribute("ye"),10)),n=new y.p(t,a),r=e.getAttribute("label");return n.label=r,n}function Nt(e){var t=new y.n(parseInt(e.getAttribute("xs"),10),parseInt(e.getAttribute("ys"),10)),a=new y.n(parseInt(e.getAttribute("xe"),10),parseInt(e.getAttribute("ye"),10)),n=new y.n(parseInt(e.getAttribute("xc"),10),parseInt(e.getAttribute("yc"),10)),r="no"===e.getAttribute("cw"),o=Object(y.w)(n,t).slope,s=Object(y.w)(n,a).slope;y.t.Utils.EQ(o,s)&&(s=r?s+2*Math.PI:s-2*Math.PI);var i=Object(y.w)(n,t).length,l=new y.a(n,i,o,s,r),c=e.getAttribute("label");return l.label=c,l}function It(e){var t=new y.n(parseInt(e.getAttribute("x"),10),parseInt(e.getAttribute("y"),10)),a=e.getAttribute("label");return t.label=a,t}function Mt(e){var t=new y.t.Image;return t.center=new y.n(parseInt(e.getAttribute("xc"),10),parseInt(e.getAttribute("yc"),10)),t.width=parseInt(e.getAttribute("width"),10),t.height=parseInt(e.getAttribute("height"),10),t.uri=e.getAttribute("uri"),t}y.t.Image=function(){function e(){Object(m.a)(this,e),this.uri="",this.center=new y.t.Point,this.width=0,this.height=0}return Object(f.a)(e,[{key:"box",get:function(){return new y.t.Box(this.center.x-this.width/2,this.center.y-this.height/2,this.center.x+this.height/2,this.center.y+this.height/2)}}]),e}();var xt=1016e4,jt=10160;function Ut(e){return Math.round(Number(e)*xt,0)}function Rt(e){return Math.round(Number(e)*jt,0)}function Ft(e,t){for(var a,n,r=[],o=t,s=e[o],i=s.split(" "),l=new y.n(Ut(i[1]),Ut(i[2])),c=!1;;){switch((i=(s=e[o]).split(" "))[0]){case"OS":a=new y.n(Ut(i[1]),Ut(i[2])),r.push(new y.p(l,a)),l=a.clone();break;case"OC":a=new y.n(Ut(i[1]),Ut(i[2])),n=new y.n(Ut(i[3]),Ut(i[4]));var u="Y"===i[5]?y.t.CW:y.t.CCW,p=Object(y.w)(n,l).slope,d=Object(y.w)(n,a).slope;y.q.EQ(p,d)&&(d+=2*Math.PI,u=!0);var h=Object(y.w)(n,l).length;r.push(new y.a(n,h,p,d,u)),l=a.clone();break;case"OE":c=!0}if(c)break;o++}return r}function Bt(e,t){var a=e.split(" "),n=new y.n(Ut(a[1]),Ut(a[2])),r=new y.n(Ut(a[3]),Ut(a[4])),o=new y.p(n,r),s=t[Number(a[5])];return o.aperture=s,o}function Yt(e,t){var a=e.split(" "),n=new y.n(Ut(a[1]),Ut(a[2])),r=new y.n(Ut(a[3]),Ut(a[4])),o=new y.n(Ut(a[5]),Ut(a[6])),s="Y"===a[10]?y.t.CW:y.t.CCW,i=Object(y.w)(o,n).slope,l=Object(y.w)(o,r).slope;y.t.Utils.EQ(i,l)&&(l+=2*Math.PI,s=!0);var c=Object(y.w)(o,n).length,u=new y.a(o,c,i,l,s),p=t[Number(a[7])];return u.aperture=p,u}var Wt=25.500025,Xt=400,zt=3.0303;function Gt(e){var t=Number(e);return Math.round(t*Wt*Xt,0)}var Ht=400;function Vt(e){return Math.round(Number(e)*Ht,0)}function Kt(e,t){var a=new ie;a.filename=e;var n=(new O).parse(t);if(n.length>0){var r=!0,o=!1,s=void 0;try{for(var i,l=n[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var c=i.value;a.shapes.push(c)}}catch(u){o=!0,s=u}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}}return a}var Zt=function(e,t,a,n,r,o){var s=new Promise(function(s,i){e.onload=function(e,t,a,n,r,o,s){return function(s){var i,l=s.target.result,c=e.name.split("."),u=c[c.length-1];i="xml"===u?function(e,t){var a=new ie;a.filename=e;var n=(new DOMParser).parseFromString(t,"text/xml"),r=n.getElementsByTagName("title");r&&r.length>0&&(a.title=r[0].firstChild.nodeValue);for(var o=n.getElementsByTagName("profile"),s=0,i=Array.from(o);s<i.length;s++){var l=Lt(i[s]);a.profiles.push(l)}for(var c=n.getElementsByTagName("material"),u=0,p=Array.from(c);u<p.length;u++){var d=Lt(p[u]);a.materials.push(d)}for(var h=n.getElementsByTagName("segment"),m=0,f=Array.from(h);m<f.length;m++){var y=Pt(f[m]);a.shapes.push(y)}for(var v=n.getElementsByTagName("curve"),g=0,E=Array.from(v);g<E.length;g++){var b=Nt(E[g]);a.shapes.push(b)}for(var _=n.getElementsByTagName("point"),O=0,S=Array.from(_);O<S.length;O++){var w=It(S[O]);a.shapes.push(w)}for(var A=n.getElementsByTagName("picture"),T=0,D=Array.from(A);T<D.length;T++){var C=Mt(D[T]);a.shapes.push(C)}return a}(e.name,l):"csv"===u?function(e,t){var a=new ie;a.filename=e;for(var n=t.match(/[^\r\n]+/g),r=0;r<n.length;r++){var o=n[r].split(","),s=Vt(o[0]),i=Vt(o[1]),l=Number(o[2]),c=Number(o[3]),u=Object(y.u)(s,i);u.nx=l,u.ny=c,a.shapes.push(u)}return a}(e.name,l):"txt"===u?Kt(e.name,l):"json"===u?le(e.name,l):function(e,t){var a=new ie;a.filename=e;for(var n,r=t.match(/[^\r\n]+/g),o=[],s=0;s<r.length;s++){var i=r[s],l=i.split(" ");if("$"!==l[0].substr(0,1))switch(l[0]){case"S":n=new y.o;var c=i.split(" ")[1];n.polarity=c;break;case"OB":var u=s,p=Ft(r,u);n.addFace(p),s=u+p.length+1;break;case"SE":a.shapes.push(n);break;case"L":var d=Bt(i,o);a.shapes.push(d);break;case"A":var h=Yt(i,o);a.shapes.push(h)}else{var m=Number(l[0].substr(1)),f=Rt(l[1].substr(1));o[m]=f}}return a}(e.name,l);var p=L.newLayer(t,a);""!==e.name&&(p.name=e.name),p.title=i.title;var d=!0,h=!1,m=void 0;try{for(var f,v=i.profiles[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var g=f.value;if(g.edges.size>0&&g.faces.size>0){var E=new D(g,void 0,g.label);p.add(E)}}}catch(j){h=!0,m=j}finally{try{d||null==v.return||v.return()}finally{if(h)throw m}}var b=!0,_=!1,O=void 0;try{for(var S,w=i.materials[Symbol.iterator]();!(b=(S=w.next()).done);b=!0){var A=S.value;if(A.edges.size>0&&A.faces.size>0){var T=new D(A,void 0,A.label);p.add(T)}}}catch(j){_=!0,O=j}finally{try{b||null==w.return||w.return()}finally{if(_)throw O}}var C=!0,k=!1,P=void 0;try{for(var N,I=i.shapes[Symbol.iterator]();!(C=(N=I.next()).done);C=!0){var M=N.value,x=new D(M,void 0,M.label);p.add(x)}}catch(j){k=!0,P=j}finally{try{C||null==I.return||I.return()}finally{if(k)throw P}}e===r[0]&&(L.setAffected(a,p),p.color=L.getNextColor(a),p.displayed=!0,n({type:"PAN_AND_ZOOM_TO_SHAPE",stage:t,shape:p})),n({type:"ADD_NEW_LAYER",layer:p}),n({type:"ASYNC_OPERATION_ENDED"}),o(!0)}}(t,a,n,r,o,s),e.readAsText(t)});return r({type:"ASYNC_OPERATION_STARTED"}),s},Qt=function(e,t,a,n,r,o){return new Promise(function(s,i){e.addEventListener("load",function(){var e=function(e){var t={},a=e.name.split("_"),n=a[0].substr(1),r=a[1]?a[1].substr(1):void 0,o=isNaN(r)?0:Gt(r)+9e4,s=isNaN(n)?0:Gt(n)-4e4;return t.center=new y.n(o,s),t.width=zt*Xt*1e3,t.box=new y.c(t.center.x-t.width/2,t.center.y-t.width/2,t.center.x+t.width/2,t.center.y+t.width/2),t}(t);e.uri=this.result;var i=new D(e),l=L.newLayer(a,n);""!==t.name&&(l.name=t.name),l.add(i),t===o[0]&&(L.setAffected(n,l),l.color=L.getNextColor(n),l.displayed=!0,r({type:"PAN_AND_ZOOM_TO_SHAPE",stage:a,shape:l})),r({type:"ADD_NEW_LAYER",layer:l}),r({type:"ASYNC_OPERATION_ENDED"}),s(!0)},!1),e.readAsDataURL(t)})},Jt=function(e,t,a,n,r){if(""===e.type||e.type.match("text.*")||e.type.match("application.*")||e.type.match("image.*")){var o=new FileReader;return e.type.match("text.*")||e.type.match("application.*")||e.name.match("features*")?Zt(o,e,t,a,n,r):e.type.match("image.*")?Qt(o,e,t,a,n,r):Promise.reject("not supported file")}},qt=function(e,t,a){return function(n){n({type:"ASYNC_OPERATION_STARTED"});for(var r=[],o=0,s=Array.from(e);o<s.length;o++){var i=s[o],l=Jt(i,t,a,n,e);r.push(l)}return Promise.all(r).then(function(e){n($t(e))}).catch(function(e){alert(e.message),n({type:"ASYNC_OPERATION_ENDED"})})}},$t=function(e){return{type:"FILES_UPLOAD_COMPLETED",uploadedFiles:e}},ea=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(o)))).inputElement=r.a.createRef(),a.clipboardWindowRef=r.a.createRef(),a.clipboardWindowWidth=0,a.clipboardWindowHeight=0,a.state={dragOver:!1,clipboardData:""},a.openFilesButtonClicked=function(){return a.inputElement.current.click()},a.pasteHandler=function(e){e.stopPropagation(),a.props.onPaste(e.clipboardData),e.clipboardData.items[0].getAsString(function(e){return a.setState({clipboardData:e})})},a.dropHandler=function(e){e.preventDefault();var t=[];if(e.dataTransfer.items){for(var n=0;n<e.dataTransfer.items.length;n++)if("file"===e.dataTransfer.items[n].kind){var r=e.dataTransfer.items[n].getAsFile();t.push(r)}}else t=e.dataTransfer.files;a.props.readFiles(t,a.props.stage,a.props.layers),a.setState({dragOver:!1})},a.dragOverHandler=function(e){e.preventDefault(),a.setState({dragOver:!0})},a.dragLeaveHandler=function(e){e.preventDefault(),a.setState({dragOver:!1})},a.filesSelectedHandler=function(e){if(File&&FileReader&&FileList){var t=e.target.files;a.props.readFiles(t,a.props.stage,a.props.layers)}},a.closePopup=function(){a.props.initUploadState(),a.props.closePopup()},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){this.props.uploadCompleted}},{key:"componentDidMount",value:function(){this.clipboardWindowWidth=this.clipboardWindowRef.current.clientWidth,this.clipboardWindowHeight=this.clipboardWindowRef.current.clientHeight}},{key:"render",value:function(){var e=""===this.state.clipboardData?30:0,t=""===this.state.clipboardData?60:0,a="";if(""!==this.state.clipboardData&&(a="Added 1 layer"),this.props.uploadCompleted&&this.props.uploadedFiles.length>0){var n=this.props.uploadedFiles.length;1===n&&(a="File uploaded. Added 1 layer"),n>1&&(a="Files uploaded. Added ".concat(n," layers"))}return this.props.showPopup?r.a.createElement(ct,{showPopup:this.props.showPopup,closePopup:this.closePopup,header:"Upload files"},r.a.createElement("div",{className:Ct.a.UploadPopup},r.a.createElement("div",{className:this.state.dragOver?"".concat(Ct.a.UploadTarget," ").concat(Ct.a.UploadTargetDragOver):"".concat(Ct.a.UploadTarget," ").concat(Ct.a.UploadTargetDragLeave),style:{paddingLeft:e,paddingRight:e,paddingTop:t,paddingBottom:t},onPaste:this.pasteHandler,onDrop:this.dropHandler,onDragOverCapture:this.dragOverHandler,onDragLeaveCapture:this.dragLeaveHandler,ref:this.clipboardWindowRef},""===this.state.clipboardData?r.a.createElement("span",null,"Paste from buffer / Drop files"):r.a.createElement("p",{style:{width:this.clipboardWindowWidth,height:this.clipboardWindowHeight}},this.state.clipboardData)),r.a.createElement("h2",null,"or"),r.a.createElement("button",{onClick:this.openFilesButtonClicked},"Open local files"),r.a.createElement("input",{style:{display:"none"},type:"file",ref:this.inputElement,name:"files[]",multiple:!0,onChange:this.filesSelectedHandler}),""!==a?r.a.createElement(Tt,{onAnimationEnd:this.props.initUploadState,message:a}):null)):null}}]),t}(n.Component),ta=Object(l.b)(function(e){return{layers:e.layers,stage:e.app.stage,uploadCompleted:e.upload.uploadCompleted,uploadedFiles:e.upload.uploadedFiles}},function(e){return{readFiles:function(t,a,n){return e(qt(t,a,n))},initUploadState:function(){return e({type:"INITIALIZE_UPLOAD_STATE"})}}})(ea),aa=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).state={done:!1},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){this.props.stage&&!this.state.done&&(this.props.fetchDocumentFromDatabase(this.props.stage,this.props.match.params.id),this.setState({done:!0}))}},{key:"render",value:function(){return null}}]),t}(n.Component),na=Object(l.b)(function(e){return{stage:e.app.stage}},function(e){return{fetchDocumentFromDatabase:function(t,a){return e(function(e,t){return function(a){a({type:"CLEAR_ALL_BUTTON_CLICKED"}),a({type:"ASYNC_OPERATION_STARTED"});var n="",r=void 0,o=void 0,s="/documents/"+t+".json",i='/geom.json?orderBy="id"&equalTo="'+t+'"';Promise.all([ne.get(s),ne.get(i)]).then(function(s){n=s[0].data.name,r=s[0].data.lastUpdated;var i=!0,l=!1,c=void 0;try{for(var u,p=Object.values(s[1].data)[0].layers[Symbol.iterator]();!(i=(u=p.next()).done);i=!0){var d=u.value,h=new C;h.shapes=le(d.shapes),h.name=d.name,o||(o=h),a(oe(h)),a(se(h))}}catch(m){l=!0,c=m}finally{try{i||null==p.return||p.return()}finally{if(l)throw c}}a(function(e,t,a,n){return{type:"REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED",id:e,name:t,owner:a,lastUpdated:n}}(t,n,"Alex Bol",r)),a(re(e,o)),a({type:"ASYNC_OPERATION_ENDED"})}).catch(function(e){alert(e.message),a({type:"ASYNC_OPERATION_ENDED"})})}}(t,a))}}})(aa),ra=a(66),oa=a.n(ra),sa=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).setHomeView=function(){var e=L.getAffected(a.props.layers);e&&(a.props.setHomeView(a.props.stage,e),a.forceUpdate())},a.onSaveDocumentButtonClicked=function(){if(0!==a.props.layers.length){var e=null;try{e=a.props.stage.toDataURL()}catch(n){console.log(n)}var t={name:""===a.props.document.name?ce(a.props.documentsList):a.props.document.name,dataURL:e,lastUpdated:(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString(),userId:a.props.userId};a.props.document.id?a.props.updateDocumentInDatabase(a.props.document.id,t,a.props.layers):a.props.addDocumentToDatabase(t,a.props.layers,a.props.history)}},a.clearCurrentDocument=function(){a.props.clearCurrentDocument(),a.props.clearAllLayers(),a.props.history.push("/")},a.handleKeyDown=function(e){if("mainCanvas"===e.target.id)switch(e.code){case"KeyH":a.setHomeView();break;case"KeyW":a.props.toggleWidthMode();break;case"KeyE":a.props.toggleDisplayVertices()}},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){window.onresize=this.props.resizeStage,document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"render",value:function(){var e=this.props.stage?r.a.createElement(at,{key:"displayCoordinatedTool",stage:this.props.stage,units:this.props.units,divisor:this.props.divisor,decimals:this.props.decimals,coordX:this.props.mouse.x,coordY:this.props.mouse.y}):null,t=this.props.measurePointsActive?r.a.createElement(et,null):null,a=this.props.measureShapesTool.firstMeasuredShape&&this.props.measureShapesTool.secondMeasuredShape&&this.props.measureShapesTool.firstMeasuredLayer.displayed&&this.props.measureShapesTool.secondMeasuredLayer.displayed,n=this.props.measureShapesTool.distance&&this.props.measureShapesTool.shortestSegment&&a?r.a.createElement(tt,{key:"MeasureShapesTool",stage:this.props.stage,firstMeasuredShape:this.props.measureShapesTool.firstMeasuredShape,secondMeasuredShape:this.props.measureShapesTool.secondMeasuredShape,firstMeasuredLayer:this.props.measureShapesTool.firstMeasuredLayer,secondMeasuredLayer:this.props.measureShapesTool.secondMeasuredLayer,distance:this.props.measureShapesTool.distance,shortestSegment:this.props.measureShapesTool.shortestSegment,divisor:this.props.divisor,decimals:this.props.decimals}):null;return r.a.createElement("main",{className:oa.a["Main-content"]},r.a.createElement(be,{measurePointsActive:this.props.measurePointsActive,units:this.props.units,showSkeletonRecognitionButton:this.props.showSkeletonRecognitionButton,onHomeButtonPressed:this.setHomeView,onPanByDragPressed:this.props.togglePanByDrag,onMeasurePointsButtonPressed:this.props.toggleMeasureBetweenPoints,onMeasureBetweenShapesButtonPressed:this.props.toggleMeasureBetweenShapes,onToggleWidthModePressed:this.props.toggleWidthMode,onToggleVerticesPressed:this.props.toggleDisplayVertices,onToggleLabelsPressed:this.props.toggleDisplayLabels,onShowAboutPopupPressed:this.props.toggleAboutPopup,onSkeletonRecognitionButtonPressed:this.props.applySkeletonRecognition,onUnitClicked:this.props.toggleUnits,onSaveDocumentButtonClicked:this.onSaveDocumentButtonClicked,onClearAllButtonClicked:this.clearCurrentDocument,onLayerListButtonClicked:this.props.toggleLayerList,onShowDownloadPopupPressed:this.props.toggleDownloadPopup,onShowUploadPopupPressed:this.props.toggleUploadPopup}),r.a.createElement(Ce,null),this.props.stage?r.a.createElement(Ne,{stage:this.props.stage,onStageUnmounted:this.props.destroyStage},r.a.createElement(qe,{layers:this.props.layers}),e,t,n):null,r.a.createElement(Pe,null),this.props.showAboutPopup?r.a.createElement(ut,{showAboutPopup:this.props.showAboutPopup,toggleAboutPopup:this.props.toggleAboutPopup,title:this.props.title,version:this.props.version,build:this.props.build}):null,this.props.showDownloadPopup?r.a.createElement(_t,{showPopup:this.props.showDownloadPopup,closePopup:this.props.toggleDownloadPopup,title:"Download document",layers:this.props.layers}):null,this.props.showUploadPopup?r.a.createElement(ta,{showPopup:this.props.showUploadPopup,closePopup:this.props.toggleUploadPopup,title:"Upload files",onPaste:this.props.pasteDataFromBuffer}):null,r.a.createElement(ee.a,{path:"/documents/:id",component:na}))}}]),t}(n.Component),ia=Object(l.b)(function(e,t){return{stage:e.app.stage,title:e.app.title,version:e.app.version,build:e.app.build,displayVertices:e.app.displayVertices,displayLabels:e.app.displayLabels,widthOn:e.app.widthOn,zoomFactor:e.app.zoomFactor,units:e.app.units,showSkeletonRecognitionButton:e.app.showSkeletonRecognitionButton,divisor:e.app.divisor,decimals:e.app.decimals,measurePointsActive:e.app.measurePointsActive,showAboutPopup:e.app.showAboutPopup,showDownloadPopup:e.app.showDownloadPopup,showUploadPopup:e.app.showUploadPopup,layers:e.layers,mouse:e.mouse,measureShapesTool:e.measureShapesTool,document:e.cloudStorage.document,documentsList:e.cloudStorage.documentsList,token:e.auth.token,userId:e.auth.userId}},function(e){return{resizeStage:function(){return e({type:"STAGE_RESIZED"})},destroyStage:function(){return e({type:"STAGE_UNMOUNTED"})},setHomeView:function(t,a){return e(re(t,a))},toggleUnits:function(){return e({type:"TOGGLE_UNITS_CLICKED"})},toggleWidthMode:function(){return e({type:"TOGGLE_WIDTH_MODE_CLICKED"})},toggleDisplayVertices:function(){return e({type:"TOGGLE_DISPLAY_VERTICES_CLICKED"})},toggleDisplayLabels:function(){return e({type:"TOGGLE_DISPLAY_LABELS_CLICKED"})},toggleAboutPopup:function(){return e({type:"TOGGLE_ABOUT_POPUP_CLICKED"})},toggleMeasureBetweenPoints:function(){return e({type:"MEASURE_POINTS_BUTTON_PRESSED"})},toggleMeasureBetweenShapes:function(){return e({type:"MEASURE_SHAPES_BUTTON_PRESSED"})},togglePanByDrag:function(){return e({type:"PAN_BY_DRAG_BUTTON_CLICKED"})},toggleLayerList:function(){return e({type:"TOGGLE_SHOW_LAYER_LIST_CLICKED"})},toggleDownloadPopup:function(){return e({type:"TOGGLE_DOWNLOAD_POPUP_CLICKED"})},toggleUploadPopup:function(){return e({type:"TOGGLE_UPLOAD_POPUP_CLICKED"})},applySkeletonRecognition:function(){return e({type:"SKELETON_RECOGNITION_BUTTON_PRESSED"})},pasteDataFromBuffer:function(t){return e(function(e){return{type:"DATA_FROM_BUFFER_PASTED",data:e}}(t))},clearAllLayers:function(){return e({type:"CLEAR_ALL_BUTTON_CLICKED"})},addDocumentToDatabase:function(t,a,n){return e(function(e,t,a){return function(n){var r=void 0;n({type:"ASYNC_OPERATION_STARTED"}),ne.post("/documents.json",e).then(function(e){r=e.data.name;var a=L.toJSON(t),n={id:r,layers:a};return ne.post("/geom.json",n)}).then(function(e){n(function(e,t){return{type:"REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED",id:e,lastUpdated:t}}(r,Date.now())),n({type:"ASYNC_OPERATION_ENDED"}),a.push("/documents/"+r)}).catch(function(e){alert(e.message),n({type:"ASYNC_OPERATION_ENDED"})})}}(t,a,n))},updateDocumentInDatabase:function(t,a,n){return e(function(e,t,a){return function(n){n({type:"ASYNC_OPERATION_STARTED"}),ne.put("/documents/".concat(e,".json"),t).then(function(t){n({type:"REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED",lastUpdated:Date.now()});var a='/geom.json?orderBy="id"&equalTo="'+e+'"';return ne.get(a)}).then(function(t){var n=L.toJSON(a),r={id:e,layers:n},o=Object.keys(t.data)[0];return ne.put("/geom/".concat(o,".json"),r)}).then(function(e){n({type:"ASYNC_OPERATION_ENDED"})}).catch(function(e){alert(e.message),n({type:"ASYNC_OPERATION_ENDED"})})}}(t,a,n))},clearCurrentDocument:function(){return e({type:"CLEAR_ALL_BUTTON_CLICKED"})}}})(sa),la=a(69),ca=a.n(la),ua=function(e){return r.a.createElement("div",{className:ca.a["Layer-list-toolbar"]},r.a.createElement("button",{title:"Add layer",onClick:e.onAddLayerButtonClicked},r.a.createElement(pe.a,{name:"plus",size:"2x",style:{color:"grey"}})),r.a.createElement("button",{title:"Edit selected layer's name and info",onClick:e.onEditLayerButtonClicked},r.a.createElement(pe.a,{name:"pencil-alt",size:"2x",style:{color:"grey"}})),r.a.createElement("button",{title:"Delete selected layer",onClick:e.onDeleteLayerButtonClicked},r.a.createElement(pe.a,{name:"trash-alt",size:"2x",style:{color:"grey"}})),r.a.createElement("button",{title:"Sort layer list",onClick:e.onSortLayersButtonClicked},r.a.createElement(pe.a,{name:"sort-alpha-down",size:"2x",style:{color:"grey"}})))},pa=a(70),da=a.n(pa),ha=function(e){var t=function(t){if(!t)return!1;t.stopPropagation(),t.preventDefault();var a=t.currentTarget[0].value,n=t.currentTarget[1].value,r=Object.assign({},e.layer,{name:a,title:n});return e.onSubmitLayerEditForm(r),!1},a=function(e){e.stopPropagation(),e.target.focus()};return r.a.createElement("form",{className:da.a["Layer-edit-form"],id:"layerEditForm",action:"",onSubmit:t,onMouseMove:function(e){e.stopPropagation()}},r.a.createElement("article",null,r.a.createElement("label",null,"Name:"),r.a.createElement("input",{type:"text",id:"layer-name",name:"layerName",defaultValue:e.layer.name,onClick:a})),r.a.createElement("article",null,r.a.createElement("label",null,"Description:"),r.a.createElement("textarea",{id:"layer-title",name:"layerTitle",cols:"70",rows:"3",defaultValue:e.layer.title,onClick:a})),r.a.createElement("input",{type:"submit",style:{display:"none"}}),r.a.createElement("button",{onClick:function(t){e.onEscapeLayerEditForm()}},"Cancel"),r.a.createElement("button",{onClick:function(e){return t(e.target.parent)}},"OK"))},ma=a(31),fa=a.n(ma),ya=function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){if("CANVAS"!==document.activeElement.nodeName){var e=this.refs.layerName;this.props.layer.affected&&e.focus()}}},{key:"rgba",value:function(e,t){var a,n,r,o;return e?(e=e.replace("#",""),a=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16),o=t):(a=147,n=128,r=108,o=0),"rgba(".concat(a,",").concat(n,",").concat(r,",").concat(o/100,")")}},{key:"render",value:function(){var e=this.props.layer.displayed?"Layer-displayed":"Layer-undisplayed",t=e?this.rgba(this.props.layer.color,100):this.rgba(),a=e?this.rgba(this.props.layer.color,30):this.rgba(),n=this.props.layer.affected?1:0,o=0===this.props.layer.shapes.length?.6:1;return[r.a.createElement("li",{key:1,className:fa.a.Layer,onClick:this.props.onLayerClicked,onDoubleClick:this.props.onLayerDoubleClicked},r.a.createElement("div",{className:fa.a.LayerSelectionBox,onClick:this.props.onAffectedBoxClicked},r.a.createElement("h4",{className:fa.a.LayerSelectionMark,style:{opacity:n,color:t}},"\u2713")),r.a.createElement("div",{className:fa.a.LayerNameBox,style:{backgroundColor:a,opacity:o}},r.a.createElement("h4",{ref:"layerName",title:this.props.layer.title,tabIndex:"1"},this.props.layer.name))),r.a.createElement(ct,{key:2,showPopup:this.props.layer.edited,closePopup:this.props.onEscapeLayerEditForm,header:"Layer properties"},r.a.createElement(ha,{layer:this.props.layer,onSubmitLayerEditForm:this.props.onSubmitLayerEditForm,onEscapeLayerEditForm:this.props.onEscapeLayerEditForm}))]}}]),t}(n.Component),va=a(44),ga=a.n(va),Ea=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).height=0,a.handleKeyDown=function(e){if(e.target.parentElement.parentElement&&e.target.parentElement.parentElement.parentElement&&e.target.parentElement.parentElement.parentElement.id&&"layersList"===e.target.parentElement.parentElement.parentElement.id)switch(e.code){case"ArrowRight":case"ArrowDown":a.props.setAffectedNextLayer();break;case"ArrowLeft":case"ArrowUp":a.props.setAffectedPrevLayer()}},a.onLayerListClicked=function(){a.forceUpdate()},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){this.height=this.refs.layersComponent.clientHeight}},{key:"render",value:function(){var e=this,t=this.props.showLayerList?ga.a["App-layers-displayed"]:ga.a["App-layers"];return r.a.createElement("div",{className:t,ref:"layersComponent",onClick:this.onLayerListClicked},r.a.createElement(ua,{onAddLayerButtonClicked:function(){return e.props.onAddLayerButtonClicked(e.props.stage)},onEditLayerButtonClicked:this.props.onEditLayerButtonClicked,onDeleteLayerButtonClicked:this.props.onDeleteLayerButtonClicked,onSortLayersButtonClicked:this.props.onSortLayersButtonClicked}),r.a.createElement("ul",{id:"layersList",style:{maxHeight:.82*(this.height-40)}},this.props.layers.map(function(t){return r.a.createElement(ya,{key:t.name,layer:t,onLayerClicked:function(){return e.props.onLayerClicked(t)},onAffectedBoxClicked:function(a){return e.props.onAffectedBoxClicked(a,t)},onSubmitLayerEditForm:e.props.onSubmitLayerEditForm,onEscapeLayerEditForm:e.props.onEscapeLayerEditForm})})))}}]),t}(n.Component),ba=Object(l.b)(function(e){return{layers:e.layers,stage:e.app.stage,showLayerList:e.app.showLayerList}},function(e){return{onAddLayerButtonClicked:function(t){return e(function(e){return{type:"ADD_LAYER_BUTTON_PRESSED",stage:e}}(t))},onEditLayerButtonClicked:function(){return e({type:"OPEN_LAYER_EDIT_FORM_PRESSED"})},onDeleteLayerButtonClicked:function(){return e({type:"DELETE_LAYER_BUTTON_PRESSED"})},onSortLayersButtonClicked:function(){return e({type:"SORT_LAYERS_BUTTON_PRESSED"})},onLayerClicked:function(t){return e(se(t))},onAffectedBoxClicked:function(t,a){return e(function(e,t){return e.stopPropagation(),{type:"TOGGLE_AFFECTED_LAYER_PRESSED",layer:t}}(t,a))},onSubmitLayerEditForm:function(t){return e(function(e){return{type:"SUBMIT_LAYER_EDIT_FORM_PRESSED",newLayer:e}}(t))},onEscapeLayerEditForm:function(){return e({type:"ESCAPE_LAYER_EDIT_FORM_PRESSED"})},setAffectedNextLayer:function(){return e({type:"LAYERS_LIST_ARROW_DOWN_PRESSED"})},setAffectedPrevLayer:function(){return e({type:"LAYERS_LIST_ARROW_UP_PRESSED"})}}})(Ea),_a=a(71),Oa=a.n(_a),Sa=function(){return r.a.createElement("aside",{className:Oa.a["App-aside"]},r.a.createElement("h5",null,"\xa0"))},wa=Object(l.b)(function(e){var t=e.cloudStorage,a=e.auth;return{document:t.document,username:a.username}},function(e){return{pasteDataFromBuffer:function(t){return e({type:"DATA_FROM_BUFFER_PASTED",data:t.clipboardData})},updateDocumentName:function(t){return e(function(e){return{type:"DOCUMENT_NAME_UPDATED",name:e}}(t))}}})(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"App-body",onPaste:e.pasteDataFromBuffer},r.a.createElement(ia,{history:e.history,onManageCloudStorageButtonClicked:e.onManageCloudStorageButtonClicked}),r.a.createElement(ba,null),r.a.createElement(Sa,null)))}),Aa=a(45),Ta=a.n(Aa),Da=Object(ee.e)(function(e){var t="/documents"===e.location.pathname?Ta.a["App-header-documents-page"]:Ta.a["App-header"];return r.a.createElement("header",{className:t},r.a.createElement("h2",null,"Debug Viewer"))}),Ca=(a(110),function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).state={done:!1},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;if(this.props.stage&&!this.state.done){var t=this.props.stage,a=this.props.layers;Promise.all([ae()("https://gist.githubusercontent.com/alexbol99/e570fe783be88b556f4ca4b332da73f7/raw/741c87a7ceccdeadd9fbbac05bdfda22ebe94927/poly234.txt")]).then(function(n){for(var r=0;r<1;r++){var o=n[r],s=L.newLayer(t,a);s.color=L.getNextColor(a),s.name="poly",s.title="",s.affected=!1,s.displayed=!0;var i=Kt(s.name,o.data),l=!0,c=!1,u=void 0;try{for(var p,d=i.shapes[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var h=p.value,m=new D(h,void 0,h.label);s.add(m)}}catch(f){c=!0,u=f}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.props.panAndZoomToShape(t,s),e.props.addNewLayer(s),e.props.asyncOperationEnded()}}).catch(function(t){console.log(t),e.props.asyncOperationEnded()}),this.setState({done:!0}),this.props.asyncOperationStarted()}}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return null}}]),t}(n.Component)),ka=Object(l.b)(function(e){return{layers:e.layers,stage:e.app.stage}},function(e){return{panAndZoomToShape:function(t,a){return e({type:"PAN_AND_ZOOM_TO_SHAPE",stage:t,shape:a})},addNewLayer:function(t){return e({type:"ADD_NEW_LAYER",layer:t})},asyncOperationStarted:function(){return e({type:"ASYNC_OPERATION_STARTED"})},asyncOperationEnded:function(){return e({type:"ASYNC_OPERATION_ENDED"})}}})(Ca),La=function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.applySkeletonRecognition()}},{key:"render",value:function(){return null}}]),t}(n.Component),Pa=Object(l.b)(function(e){return{layers:e.layers,stage:e.app.stage}},function(e){return{applySkeletonRecognition:function(){return e({type:"SKELETON_RECOGNITION_URI"})}}})(La),Na=function(){function e(){Object(m.a)(this,e)}return Object(f.a)(e,null,[{key:"apply",value:function(t,a){for(var n=Number.POSITIVE_INFINITY,r=0,o=Object(v.a)(a.edges);r<o.length;r++){var s=o[r],i=e.edge2polygon(s,t);i<n&&(n=i)}return n}},{key:"edge2polygon",value:function(t,a){var n=t.shape.box,r=new y.c(Number.NEGATIVE_INFINITY,n.ymin,Number.POSITIVE_INFINITY,n.ymax),o=Number.POSITIVE_INFINITY,s=a.edges.search(r),i=!0,l=!1,c=void 0;try{for(var u,p=s[Symbol.iterator]();!(i=(u=p.next()).done);i=!0){var d=u.value,h=void 0;d.shape instanceof y.p&&t.shape instanceof y.p?h=e.segment2segment(d.shape,t.shape):d.shape instanceof y.a&&t.shape instanceof y.p?h=e.segment2arc(t.shape,d.shape):d.shape instanceof y.p&&t.shape instanceof y.a?h=e.segment2arc(d.shape,t.shape):d.shape instanceof y.a&&t.shape instanceof y.a&&(h=e.arc2arc(d.shape,t.shape)),h<o&&(o=h)}}catch(m){l=!0,c=m}finally{try{i||null==p.return||p.return()}finally{if(l)throw c}}return o}},{key:"point2shape",value:function(e,t){var a=new y.i(e,new y.r(0,1)).intersect(t),n=Number.POSITIVE_INFINITY,r=!0,o=!1,s=void 0;try{for(var i,l=a[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var c=i.value,u=e.distanceTo(c),p=Object(M.a)(u,2),d=p[0];p[1];d<n&&(n=d)}}catch(h){o=!0,s=h}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return n}},{key:"segment2segment",value:function(t,a){var n=Number.POSITIVE_INFINITY,r=!0,o=!1,s=void 0;try{for(var i,l=t.vertices[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var c=i.value,u=e.point2shape(c,a);u<n&&(n=u)}}catch(g){o=!0,s=g}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}var p=!0,d=!1,h=void 0;try{for(var m,f=a.vertices[Symbol.iterator]();!(p=(m=f.next()).done);p=!0){var y=m.value,v=e.point2shape(y,t);v<n&&(n=v)}}catch(g){d=!0,h=g}finally{try{p||null==f.return||f.return()}finally{if(d)throw h}}return n}},{key:"segment2arc",value:function(t,a){for(var n,r=Number.POSITIVE_INFINITY,o=new y.r(t.start,t.end),s=0,i=[(o=o.normalize()).rotate90CCW().multiply(a.r),o.rotate90CW().multiply(a.r)];s<i.length;s++){var l=i[s],c=a.center.translate(l);c.on(a)&&(n=e.point2shape(c,t))<r&&(r=n)}var u=!0,p=!1,d=void 0;try{for(var h,m=a.vertices[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){var f=h.value,v=e.point2shape(f,t);v<r&&(r=v)}}catch(A){p=!0,d=A}finally{try{u||null==m.return||m.return()}finally{if(p)throw d}}var g=!0,E=!1,b=void 0;try{for(var _,O=t.vertices[Symbol.iterator]();!(g=(_=O.next()).done);g=!0){var S=_.value,w=e.point2shape(S,a);w<r&&(r=w)}}catch(A){E=!0,b=A}finally{try{g||null==O.return||O.return()}finally{if(E)throw b}}return r}},{key:"arc2arc",value:function(t,a){var n,r=Number.POSITIVE_INFINITY,o=t.clone();if(o.r+=a.r,(n=e.point2shape(a.center,o))<r){var s=t.distanceTo(e.translateArc(a,new y.r(-n,0))),i=Object(M.a)(s,2),l=i[0];i[1];y.t.Utils.EQ_0(l)&&(r=n)}if(y.t.Utils.GE(t.r,a.r)){var c=t.clone();if(c.r-=a.r,(n=e.point2shape(a.center,c))<r){var u=t.distanceTo(e.translateArc(a,new y.r(-n,0))),p=Object(M.a)(u,2),d=p[0];p[1];y.t.Utils.EQ_0(d)&&(r=n)}}if(y.t.Utils.LT(t.r,a.r)){var h=a.clone();if(h.r-=t.r,(n=e.point2shape(t.center,h))<r){var m=t.distanceTo(e.translateArc(a,new y.r(-n,0))),f=Object(M.a)(m,2),v=f[0];f[1];y.t.Utils.EQ_0(v)&&(r=n)}}var g=!0,E=!1,b=void 0;try{for(var _,O=t.vertices[Symbol.iterator]();!(g=(_=O.next()).done);g=!0){var S=_.value,w=e.point2shape(S,a);w<r&&(r=w)}}catch(N){E=!0,b=N}finally{try{g||null==O.return||O.return()}finally{if(E)throw b}}var A=!0,T=!1,D=void 0;try{for(var C,k=a.vertices[Symbol.iterator]();!(A=(C=k.next()).done);A=!0){var L=C.value,P=e.point2shape(L,t);P<r&&(r=P)}}catch(N){T=!0,D=N}finally{try{A||null==k.return||k.return()}finally{if(T)throw D}}return r}},{key:"translateArc",value:function(e,t){var a=e.clone();return a.pc=a.pc.translate(t),a}},{key:"translate",value:function(e,t){var a=new y.o,n=!0,r=!1,o=void 0;try{for(var s,i=e.faces[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value,c=[],u=!0,p=!1,d=void 0;try{for(var h,m=l[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){var f=h.value;if(f.shape instanceof y.p)c.push(new y.p(f.shape.ps.translate(t),f.shape.pe.translate(t)));else if(f.shape instanceof y.a){var v=f.shape.clone();v.pc=f.shape.pc.translate(t),c.push(v)}}}catch(g){p=!0,d=g}finally{try{u||null==m.return||m.return()}finally{if(p)throw d}}a.addFace(c)}}catch(g){r=!0,o=g}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return a}}]),e}();Na.Flatten=y.t;var Ia=Na,Ma=y.t.vector,xa=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(J.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).state={done:!1,data:[]},a}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;if(this.props.stage&&!this.state.done){var t=this.props.stage,a=this.props.layers,n=L.newLayer(t,a);n.color=L.getNextColor(a),n.name="collision_demo",n.title="collision_demo",n.affected=!0,n.displayed=!0,ae()("https://gist.githubusercontent.com/alexbol99/81893d40ec5eaa00d0336c35e069dd73/raw/b9328a4c6d7d6a44f375c68b4ec207690f40fd19/Block_53388_2parts_Cont.txt").then(function(a){var r=e.props.parser.parseToPolygon(a.data);n.add(r);var o=Ma(2*(r.box.xmax-r.box.xmin),0),s=r.translate(o);n.add(s);var i=Ia.apply(s,r),l=s.translate(Ma(-i,0));n.add(l),e.props.panAndZoomToShape(t,n),e.props.addNewLayer(n),e.props.applyCollisionDemo(),e.props.asyncOperationEnded()}),this.setState({done:!0}),this.props.asyncOperationStarted()}}},{key:"render",value:function(){return null}}]),t}(n.Component),ja=Object(l.b)(function(e){return{layers:e.layers,stage:e.app.stage,parser:e.app.parser}},function(e){return{panAndZoomToShape:function(t,a){return e({type:"PAN_AND_ZOOM_TO_SHAPE",stage:t,shape:a})},addNewLayer:function(t){return e({type:"ADD_NEW_LAYER",layer:t})},applyCollisionDemo:function(){return e({type:"COLLISION_DEMO_URI"})},asyncOperationStarted:function(){return e({type:"ASYNC_OPERATION_STARTED"})},asyncOperationEnded:function(){return e({type:"ASYNC_OPERATION_ENDED"})}}})(xa),Ua=a(46),Ra=a.n(Ua),Fa=function(){return r.a.createElement(st,null,r.a.createElement("div",{className:Ra.a.BackDrop},r.a.createElement("div",{className:Ra.a.Loader},"Loading ...")))},Ba=function(e,t){return{type:"AUTHENTICATION_SUCCEED",token:e,userId:t,username:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null}},Ya=function(e){return{type:"AUTHENTICATION_FAILED",error:e}},Wa=function(){return localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),localStorage.removeItem("userId"),{type:"AUTHENTICATION_LOGOUT"}},Xa=function(e){return function(t){setTimeout(function(){var e=localStorage.getItem("email"),a=localStorage.getItem("password");t(e&&a?za(e,a):Wa())},1e3*e)}},za=function(e,t){return function(a){a({type:"AUTHENTICATION_STARTED"});var n={email:e,password:t,returnSecureToken:!0};localStorage.setItem("email",e),localStorage.setItem("password",t);ae.a.post("https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=AIzaSyDMUAcjgolAlapdpFmPEz8SaId1DZw7MpQ",n).then(function(e){var t=new Date((new Date).getTime()+1e3*e.data.expiresIn);localStorage.setItem("token",e.data.idToken),localStorage.setItem("expirationDate",t),localStorage.setItem("userId",e.data.localId),a(Ba(e.data.idToken,e.data.localId)),a(Xa(e.data.expiresIn));var n="?auth="+e.data.idToken+'&orderBy="userId"&equalTo="'+e.data.localId+'"';return ae.a.get("https://debug-viewer.firebaseio.com/users.json"+n)}).then(function(e){if(Object.values(e.data.length>0)){var t=Object.values(e.data)[0].username;localStorage.setItem("username",t),a(function(e){return{type:"AUTENTICATION_SET_USERNAME",username:e}}(Object.values(e.data)[0].username))}}).catch(function(e){a(Ya(e.response.data.error))})}},Ga=function(e){function t(){return Object(m.a)(this,t),Object(J.a)(this,Object(q.a)(t).apply(this,arguments))}return Object($.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.authCheckState()}},{key:"componentDidUpdate",value:function(){"/"===this.props.location.pathname&&void 0!==this.props.document.id&&this.props.history.push("/documents/"+this.props.document.id)}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Da,{title:this.props.title,version:this.props.version,isAuthenticated:this.props.isAuthenticated,username:this.props.username}),r.a.createElement(wa,null),r.a.createElement(ee.c,null,r.a.createElement(ee.a,{path:"/demo",exact:!0,component:ka}),r.a.createElement(ee.a,{path:"/skeleton",component:Pa}),r.a.createElement(ee.a,{path:"/collision-distance",component:ja})),this.props.showSpinner?r.a.createElement(Fa,null):null)}}]),t}(n.Component),Ha=Object(ee.e)(Object(l.b)(function(e){var t=e.auth,a=e.app,n=e.cloudStorage;return{title:a.title,version:a.version,showSpinner:a.showSpinner,document:n.document,isAuthenticated:null!==t.token,username:t.username}},function(e){return{authCheckState:function(){return e(function(e){var t=localStorage.getItem("token");if(t){var a=localStorage.getItem("userId"),n=localStorage.getItem("username"),r=new Date(localStorage.getItem("expirationDate"));if(r>new Date){var o=r.getTime()-(new Date).getTime();e(Ba(t,a,n)),e(Xa(o/1e3))}else e(Wa())}else e(Wa())})}}})(Ga)),Va=(a(111),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d),Ka=Object(i.e)(G,Va(Object(i.a)(H,V,Q,K,c.a)));s.a.render(r.a.createElement(l.a,{store:Ka},r.a.createElement(u.a,{basename:""},r.a.createElement(Ha,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},24:function(e,t,a){e.exports={Button:"Button_Button__ZRIQC",IconTrigger:"Button_IconTrigger__3UsvH",IconModeActive:"Button_IconModeActive__33wYT",IconModeNotActive:"Button_IconModeNotActive__2mK3K",DrawerButton:"Button_DrawerButton__29vkr"}},29:function(e,t,a){e.exports={UploadPopup:"UploadPopup_UploadPopup__30N0W",fadeIn:"UploadPopup_fadeIn__1hmSa",UploadTarget:"UploadPopup_UploadTarget__1gw3w",UploadTargetDragLeave:"UploadPopup_UploadTargetDragLeave__1MlZ6",UploadTargetDragOver:"UploadPopup_UploadTargetDragOver__322O6"}},31:function(e,t,a){e.exports={Layer:"LayerListElement_Layer__1WgQk",LayerSelectionBox:"LayerListElement_LayerSelectionBox__2DXrV",LayerSelectionMark:"LayerListElement_LayerSelectionMark__2zYS5",LayerNameBox:"LayerListElement_LayerNameBox__1m2fQ","Layer-displayed":"LayerListElement_Layer-displayed__223Ba","Layer-undisplayed":"LayerListElement_Layer-undisplayed__3_DcN"}},40:function(e,t,a){e.exports={ButtonSeparator:"ButtonSeparator_ButtonSeparator__2hXOe",IconSeparator:"ButtonSeparator_IconSeparator__1LZbY"}},41:function(e,t,a){e.exports={"App-toolbar":"ToolbarComponent_App-toolbar__3E3eP","App-toolbar-units":"ToolbarComponent_App-toolbar-units__3ug9X",DrawerButton:"ToolbarComponent_DrawerButton__3u3jP"}},42:function(e,t,a){e.exports={BackDrop:"ModalPopup_BackDrop__3HTI8",ModalPopup:"ModalPopup_ModalPopup__yAVS4",fadeIn:"ModalPopup_fadeIn__3ymPT"}},44:function(e,t,a){e.exports={"App-layers":"LayersList_App-layers__dDR80","App-layers-displayed":"LayersList_App-layers-displayed__1Bq_a",fadeIn:"LayersList_fadeIn__jzmIN"}},45:function(e,t,a){e.exports={"App-header":"HeaderComponent_App-header__19h2h","App-header-documents-page":"HeaderComponent_App-header-documents-page__2TPYD"}},46:function(e,t,a){e.exports={BackDrop:"Spinner_BackDrop__19thA",Loader:"Spinner_Loader__2rJlS",load2:"Spinner_load2__2_wJ9"}},58:function(e,t,a){e.exports={"App-canvas":"CanvasComponent_App-canvas__3v_so"}},59:function(e,t,a){e.exports={"App-status-bar":"StatusComponent_App-status-bar__21gqW"}},60:function(e,t,a){e.exports={LabelsLayer:"labelsLayer_LabelsLayer__2RodY",LabelComponent:"labelsLayer_LabelComponent__nMUCB"}},61:function(e,t,a){e.exports={VertexLabel:"VertexLabel_VertexLabel__33mho",fadeIn:"VertexLabel_fadeIn__1X9i3"}},62:function(e,t,a){e.exports={AboutPopup:"AboutPopup_AboutPopup__2Ghnq"}},64:function(e,t,a){e.exports={DownloadPopup:"DownloadPopup_DownloadPopup__cTKTB",fadeIn:"DownloadPopup_fadeIn__3zx4f",Open:"DownloadPopup_Open__1XqIT",Close:"DownloadPopup_Close__r-CbX"}},65:function(e,t,a){e.exports={Snackbar:"Snackbar_Snackbar__1PFDn",fadeInOut:"Snackbar_fadeInOut__3embo"}},66:function(e,t,a){e.exports={"Main-content":"MainComponent_Main-content__1ZoSP"}},69:function(e,t,a){e.exports={"Layer-list-toolbar":"LayerListToolbar_Layer-list-toolbar__GYX1Q"}},70:function(e,t,a){e.exports={"Layer-edit-form":"LayerEditForm_Layer-edit-form__ihOJE"}},71:function(e,t,a){e.exports={"App-aside":"AsideComponent_App-aside__1yhWy"}},73:function(e,t,a){e.exports=a(112)}},[[73,1,2]]]);
//# sourceMappingURL=main.7b17e63e.chunk.js.map