(this["webpackJsonpdebug-viewer1"]=this["webpackJsonpdebug-viewer1"]||[]).push([[0],{113:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){"use strict";a.r(t);var n=a(23),r=a.n(n),o=a(31),s=a(13),i=a(60),c=a(33);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(10),p="NEW_STAGE_CREATED",u="STAGE_RESIZED",d="STAGE_UNMOUNTED",h="PAN_BY_DRAG_BUTTON_CLICKED",f="MEASURE_POINTS_BUTTON_PRESSED",m="MEASURE_SHAPES_BUTTON_PRESSED",g="TOGGLE_ABOUT_POPUP_CLICKED",v="TOGGLE_UNITS_CLICKED",y="TOGGLE_WIDTH_MODE_CLICKED",b="TOGGLE_DISPLAY_VERTICES_CLICKED",O="TOGGLE_DISPLAY_LABELS_CLICKED",j="TOGGLE_SHOW_LAYER_LIST_CLICKED",w="TOGGLE_DOWNLOAD_POPUP_CLICKED",S="TOGGLE_UPLOAD_POPUP_CLICKED",k="MOUSE_MOVED_ON_STAGE",x="MOUSE_DOWN_ON_STAGE",_="MOUSE_UP_ON_STAGE",A="MOUSE_WHEEL_MOVE_ON_STAGE",E="MOUSE_ROLL_OVER_SHAPE",C="MOUSE_ROLL_OUT_SHAPE",L="MOUSE_CLICKED_ON_SHAPE",D="PINCH_DOWN_ON_STAGE",I="PINCH_MOVED_ON_STAGE",M="PINCH_UP_ON_STAGE",T="PAN_AND_ZOOM_TO_SHAPE",P="ADD_LAYER_BUTTON_PRESSED",N="ADD_NEW_LAYER",F="DELETE_LAYER_BUTTON_PRESSED",U="SORT_LAYERS_BUTTON_PRESSED",B="TOGGLE_DISPLAY_LAYER_PRESSED",W="TOGGLE_AFFECTED_LAYER_PRESSED",Y="OPEN_LAYER_EDIT_FORM_PRESSED",R="SUBMIT_LAYER_EDIT_FORM_PRESSED",X="ESCAPE_LAYER_EDIT_FORM_PRESSED",z="LAYERS_LIST_ARROW_DOWN_PRESSED",H="LAYERS_LIST_ARROW_UP_PRESSED",V="FILES_UPLOAD_COMPLETED",q="INITIALIZE_UPLOAD_STATE",G="DATA_FROM_BUFFER_PASTED",K="AABB_TREE_NEXT_LEVEL",Q="SKELETON_RECOGNITION_URI",J="SKELETON_RECOGNITION_BUTTON_PRESSED",Z="ASYNC_OPERATION_STARTED",$="ASYNC_OPERATION_ENDED",ee="REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED",te="REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED",ae="REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED",ne="REQUEST_FETCH_DOCUMENTS_FROM_DATABASE_SUCCEED",re="DELETE_DOCUMENT_FROM_DATABASE_SUCCEED",oe="DOCUMENT_SELECTED_FROM_LIST",se="DOCUMENT_NAME_UPDATED",ie="CLEAR_ALL_BUTTON_CLICKED",ce="AUTHENTICATION_STARTED",le="AUTHENTICATION_SUCCEED",pe="AUTHENTICATION_FAILED",ue="AUTHENTICATION_LOGOUT",de="AUTENTICATION_SET_USERNAME",he={token:null,userId:null,username:null,error:null,loading:!1},fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ce:return Object(l.a)(Object(l.a)({},e),{},{error:null,loading:!0});case le:return Object(l.a)(Object(l.a)({},e),{},{error:null,token:t.token,userId:t.userId,username:t.username,loading:!1});case pe:return Object(l.a)(Object(l.a)({},e),{},{error:t.error,token:null,userId:null,username:null,loading:!1});case ue:return Object(l.a)(Object(l.a)({},e),{},{token:null,userId:null,username:null});case de:return Object(l.a)(Object(l.a)({},e),{},{username:t.username});default:return e}},me=a(4),ge=a(2),ve=a(3),ye=a(0),be=a(11);function Oe(e,t,a,n){var r=Object(ye.t)(e,t).slope,o=Object(ye.t)(e,a).slope;ye.n.EQ(r,o)&&(o+=2*Math.PI,n=!0);var s=Object(ye.t)(e,t).length;return new ye.a(e,s,r,o,n)}var je=ye.q.BooleanOperations,we=(je.unify,je.subtract,je.BOOLEAN_UNION),Se=ye.q.BooleanOperations,ke=Se.addToIntPoints,xe=Se.getSortedArray,_e=Se.splitByIntersections,Ae=ye.q.BooleanOperations,Ee=Ae.removeNotRelevantChains,Ce=Ae.removeOldFaces,Le=Ae.restoreFaces;function De(e,t){var a,n,r=Math.abs(t),o=new ye.l,s=e.clone();s.r=e.r+r,a=function(e,t,a,n){var r=Object(ye.t)(e,t).slope,o=r+a;ye.n.EQ(r,o)&&(o+=2*Math.PI,n=!0);var s=Object(ye.t)(e,t).length;return new ye.a(e,s,r,o,n)}(e.end,s.end,Math.PI,e.counterClockwise),n=function(e,t,a,n){var r=Object(ye.t)(e,t).slope,o=r-a;ye.n.EQ(o,r)&&(r+=2*Math.PI,n=!0);var s=Object(ye.t)(e,t).length;return new ye.a(e,s,o,r,n)}(e.start,s.start,Math.PI,e.counterClockwise);var i=void 0;i=e.r>r?new ye.a(e.pc,e.r-r,e.endAngle,e.startAngle,e.counterClockwise===ye.d?ye.c:ye.d):new ye.m(a.end,n.start),o.addFace([s,a,i,n]),Object(be.a)(o.faces)[0].setArcLength();var c=ye.f.getSelfIntersections(Object(be.a)(o.faces)[0],o.edges,!1);c=c.slice(0,c.length/2);var l,p,u=[];l=Object(be.a)(o.edges)[1],p=Object(be.a)(o.edges)[3];var d,h=Object(me.a)(c);try{for(h.s();!(d=h.n()).done;){var f=d.value;ke(l,f,u),ke(p,f,u)}}catch(S){h.e(S)}finally{h.f()}var m=xe(u);_e(o,m);var g,v=ye.j,y=Object(me.a)(m);try{for(y.s();!(g=y.n()).done;){var b=g.value;b.edge_before.bv=v,b.edge_after.bv=v===ye.j?ye.g:ye.j,v=b.edge_after.bv}}catch(S){y.e(S)}finally{y.f()}Ee(o,we,m,!0);var O,j,w=u.length;w>0&&(O=m[0].edge_before,j=m[w-1].edge_after,O.next=j,j.prev=O,m[0].edge_after=m[w-1].edge_after,m[w-1].edge_before=m[0].edge_before,4===w&&(O=m[2].edge_before,j=m[1].edge_after,O.next=j,j.prev=O,m[2].edge_after=m[1].edge_after,m[1].edge_before=m[2].edge_before),Ce(o,u),Le(o,u,u));return Object(be.a)(o.faces)[0].orientation()===ye.i.CCW&&o.reverse(),o}function Ie(e,t){var a=Math.abs(t),n=new ye.l,r=Object(ye.t)(e.end.x-e.start.x,e.end.y-e.start.y).normalize(),o=r.rotate90CCW().multiply(a),s=r.rotate90CW().multiply(a),i=e.translate(o),c=e.translate(s).reverse(),l=Oe(e.end,i.end,c.start,ye.d),p=Oe(e.start,c.end,i.start,ye.d);return n.addFace([i,l,c,p]),n}var Me=function(){function e(){Object(ge.a)(this,e),this.filename="",this.title="",this.profiles=[],this.materials=[],this.shapes=[]}return Object(ve.a)(e,[{key:"box",get:function(){var e,t=new ye.b,a=Object(me.a)(this.profiles);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.merge(n.box)}}catch(p){a.e(p)}finally{a.f()}var r,o=Object(me.a)(this.materials);try{for(o.s();!(r=o.n()).done;){var s=r.value;t.merge(s.box)}}catch(p){o.e(p)}finally{o.f()}var i,c=Object(me.a)(this.shapes);try{for(c.s();!(i=c.n()).done;){var l=i.value;t.merge(l.box)}}catch(p){c.e(p)}finally{c.f()}return t}}]),e}();function Te(e,t,a,n){var r=Object(ye.t)(e,t).slope,o=Object(ye.t)(e,a).slope;ye.n.EQ(r,o)&&(o+=2*Math.PI,n=!0);var s=Object(ye.t)(e,t).length;return Object(ye.p)(e,s,r,o,n)}function Pe(e,t,a){for(var n,r,o,s,i=[],c=new ye.l,l=t+1;l<a;l++){var p=e[l].split(" ");if("A"===p[0])r=Object(ye.r)(parseInt(p[5]),parseInt(p[6])),o=Object(ye.r)(parseInt(p[7]),parseInt(p[8])),s=Te(Object(ye.r)(parseInt(p[9]),parseInt(p[10])),r,o,!!p[12].includes("1"));else"L"===p[0]&&(r=Object(ye.r)(parseInt(p[1]),parseInt(p[2])),o=Object(ye.r)(parseInt(p[3]),parseInt(p[4])),s=Object(ye.s)(r,o));0===i.length&&(n=r),i.push(s),o.equalTo(n)&&(c.addFace(i),i=[])}return c}function Ne(e){for(var t=null,a=[],n=e.match(/[^\r\n]+/g),r=0;r<n.length;r++){var o=n[r].split(" ");if("S"!==o[0]){if("E"===o[0]&&null!==t){var s=Pe(n,t,r);t=null,null,a.push(s)}}else t=r}return a}function Fe(e,t){var a=new Me;return a.filename=e,a.shapes=Ne(t),a}var Ue=function(){function e(){Object(ge.a)(this,e)}return Object(ve.a)(e,[{key:"parseToWatchArray",value:function(e){var t,a=e.match(/[^\r\n]+/g),n=[],r=Object(me.a)(a);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(o.substring(o.indexOf("{")))}}catch(s){r.e(s)}finally{r.f()}return n}},{key:"parseToPoint",value:function(e){var t,a,n=e.match(/\{([^)]+)\}/)[1];t=parseInt(n.split("=")[1].split(",")[0],10),a=parseInt(n.split("=")[1].split(",")[0],10),(isNaN(t)||isNaN(a))&&(t=parseInt(n.trim().split(" ")[0].split("=")[1],10),a=parseInt(n.trim().split(" ")[1].split("=")[1],10));var r=new ye.k(t,a);return r.label=e.split(/\s+/)[1],r}},{key:"parseToSegment",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new ye.k(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new ye.k(parseInt(r[0],10),parseInt(r[1],10));return new ye.m(n,o)}},{key:"parseToArc",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new ye.k(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new ye.k(parseInt(r[0],10),parseInt(r[1],10)),s=t[2].split("=")[1].split(","),i=new ye.k(parseInt(s[0],10),parseInt(s[1],10)),c="0"===t[3].split("=")[1],l=Object(ye.t)(i,n).slope,p=Object(ye.t)(i,o).slope;ye.q.Utils.EQ(l,p)&&(p=c?p+2*Math.PI:p-2*Math.PI);var u=Object(ye.t)(i,n).length;return new ye.a(i,u,l,p,c)}},{key:"parseToCircle",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new ye.k(parseInt(a[0],10),parseInt(a[1],10)),r=parseInt(t[1].split("=")[1],10);return new ye.e(n,r)}},{key:"parseToRectangle",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=parseInt(a[0],10),r=parseInt(a[1],10),o=parseInt(t[1].split("=")[1],10),s=parseInt(t[2].split("=")[1],10),i=new ye.b(n,r,n+o,r+s),c=new ye.l;return c.addFace(i),c}},{key:"parseToODBLine",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new ye.k(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new ye.k(parseInt(r[0],10),parseInt(r[1],10)),s=parseInt(t[2].split("=")[1],10),i=new ye.m(n,o);return s>0?Ie(i,s):new ye.l}},{key:"parseToODBArc",value:function(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),a=t[0].split("=")[1].split(","),n=new ye.k(parseInt(a[0],10),parseInt(a[1],10)),r=t[1].split("=")[1].split(","),o=new ye.k(parseInt(r[0],10),parseInt(r[1],10)),s=t[2].split("=")[1].split(","),i=new ye.k(parseInt(s[0],10),parseInt(s[1],10)),c="0"===t[3].split("=")[1],l=Object(ye.t)(i,n).slope,p=Object(ye.t)(i,o).slope;ye.q.Utils.EQ(l,p)&&(p=c?p+2*Math.PI:p-2*Math.PI);var u=Object(ye.t)(i,n).length,d=new ye.a(i,u,l,p,c),h=parseInt(t[4].split("=")[1],10);return h>0?De(d,h):new ye.l}},{key:"parseToPolygon",value:function(e){for(var t=new ye.l,a=e.match(/[^\r\n]+/g),n=0;n<a.length;n++){var r=a[n];if(r.search("mat_cont_poly_struc")>=0){for(var o=r.match(/\{([^)]+)\}/)[1].split(" ")[0].split("=")[1],s=parseInt(o,10),i=[],c=n+2;c<n+2+s;c++)if((r=a[c]).search("mat_seg_struc")>=0){var l=this.parseToSegment(r);i.push(l)}else if(r.search("mat_curve_struc")>=0){var p=this.parseToArc(r);i.push(p)}t.addFace(i)}}return t}},{key:"parseToPoints",value:function(e){var t,a=[],n=e.match(/[^\r\n]+/g),r=Object(me.a)(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.search("point_struc")>=0){var s=o.match(/\{([^)]+)\}/)[1].split("=")[1].split(","),i=new ye.k(parseInt(s[0],10),parseInt(s[1],10));i.label=o.split(/\s+/)[1],a.push(i)}}}catch(c){r.e(c)}finally{r.f()}return a}},{key:"parseToShapes",value:function(e){var t,a=[],n=e.match(/[^\r\n]+/g);if(1===n[0].length&&"N"===n[0])return a=Ne(e);var r,o=Object(me.a)(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.search("point_struc")>=0?t=this.parseToPoint(s):s.search("_seg_struc")>=0?t=this.parseToSegment(s):s.search("_curve_struc")>=0?t=this.parseToArc(s):s.search("_circle_struc")>=0?t=this.parseToCircle(s):s.search("_rect_struc")>=0?t=this.parseToRectangle(s):s.search("_line_struc")>=0?t=this.parseToODBLine(s):s.search("_arc_struc")>=0&&(t=this.parseToODBArc(s)),a.push(t)}}catch(i){o.e(i)}finally{o.f()}return a}},{key:"parse",value:function(e){var t=this.parseToPolygon(e);if(t.edges.size>0&&t.faces.size>0)return[t];var a=this.parseToShapes(e);if(a.length>0)return a;var n=this.parseToPoints(e);return n.length>0?n:void 0}}]),e}(),Be=[{name:"pixels",decimals:0,divisor:1},{name:"inch",decimals:7,divisor:1016e4},{name:"mm",decimals:6,divisor:4e5}],We={title:"Debug Viewer",version:"2.1.3",build:"",units:"pixels",decimals:0,divisor:1,parser:new Ue,widthOn:!0,displayVertices:!1,displayLabels:!0,measurePointsActive:!1,zoomFactor:void 0,originX:void 0,originY:void 0,showAboutPopup:!1,importDataToNewLayer:!0,showSkeletonRecognitionButton:!1,applySkeletonRecognition:!1,stage:null,showSpinner:!1,showLayerList:!1,showDownloadPopup:!1,showUploadPopup:!1},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object.assign({},e,{stage:t.stage,zoomFactor:t.stage.zoomFactor*t.stage.resolution,originX:t.stage.origin.x,originY:t.stage.origin.y});case d:return Object.assign({},e,{stage:null,zoomFactor:void 0,originX:void 0,originY:void 0});case A:case T:case I:return Object.assign({},e,{zoomFactor:t.stage.zoomFactor*t.stage.resolution,originX:t.stage.origin.x,originY:t.stage.origin.y});case k:return Object.assign({},e,{originX:t.stage.origin.x,originY:t.stage.origin.y});case v:var a=Be.findIndex((function(t){return e.units===t.name})),n=Be[(a+1)%3];return Object.assign({},e,{units:n.name,decimals:n.decimals,divisor:n.divisor});case y:return Object.assign({},e,{widthOn:!e.widthOn,displayVertices:!!e.widthOn&&e.displayVertices});case b:return e.displayVertices?Object.assign({},e,{displayVertices:!1}):Object.assign({},e,{widthOn:!1,displayVertices:!0});case O:return Object.assign({},e,{displayLabels:!e.displayLabels});case g:return Object.assign({},e,{showAboutPopup:!e.showAboutPopup});case h:return Object.assign({},e,{measurePointsActive:!1});case f:return Object.assign({},e,{measurePointsActive:!0});case m:return Object.assign({},e,{measurePointsActive:!1});case Q:return Object.assign({},e,{showSkeletonRecognitionButton:!0});case J:return Object.assign({},e,{applySkeletonRecognition:!0});case Z:return Object.assign({},e,{showSpinner:!0});case $:return Object.assign({},e,{showSpinner:!1});case K:return e;case j:return Object(l.a)(Object(l.a)({},e),{},{showLayerList:!e.showLayerList});case w:return Object(l.a)(Object(l.a)({},e),{},{showDownloadPopup:!e.showDownloadPopup});case S:return Object(l.a)(Object(l.a)({},e),{},{showUploadPopup:!e.showUploadPopup});default:return e}},Re={strokeStyle:1,stroke:"#FF0303",fill:"#FF0303",alpha:1},Xe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(ge.a)(this,e),this.geom=t,this.style=a||Re,this.label=n}return Object(ve.a)(e,[{key:"clone",value:function(){var t=new e(this.geom,this.style,this.label);return Object.assign(t,this)}},{key:"box",get:function(){return this.geom.box}}]),e}(),ze=function(){function e(t){Object(ge.a)(this,e),this.stage=t,this.shapes=[],this.name="",this.color="",this.title="",this.displayed=!1,this.edited=!1,this.affected=!1}return Object(ve.a)(e,[{key:"clone",value:function(){var t=new e(this.stage);return Object.assign(t,this)}},{key:"add",value:function(e){if(e instanceof Xe)this.shapes.push(e);else{var t=new Xe(e,{},e.label);this.shapes.push(t)}return this}},{key:"addShapesArray",value:function(e){var t,a=Object(me.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;this.add(n)}}catch(r){a.e(r)}finally{a.f()}return this}},{key:"box",get:function(){var e,t=new ye.b,a=Object(me.a)(this.shapes);try{for(a.s();!(e=a.n()).done;){var n=e.value;t=t.merge(n.geom instanceof ye.b?n.clone():n.box)}}catch(r){a.e(r)}finally{a.f()}return t}},{key:"center",get:function(){var e=this.box;return new ye.k((e.xmin+e.xmax)/2,(e.ymin+e.ymax)/2)}},{key:"toggleDisplayed",value:function(e){var t=!this.displayed;return Object.assign(this.clone(),{displayed:t,color:e})}},{key:"setAffected",value:function(e){return this.affected=e,this}},{key:"setEdited",value:function(e){return Object.assign(this.clone(),{edited:e})}},{key:"setNameAndTitle",value:function(e,t){return Object.assign(this.clone(),{name:e,title:t,edited:!1})}},{key:"setAlpha",value:function(){var e,t=Object(me.a)(this.shapes);try{for(t.s();!(e=t.n()).done;){e.value.alpha=this.displayed?1:0}}catch(a){t.e(a)}finally{t.f()}return this.shapes}},{key:"toJSON",value:function(){return{name:this.name,title:this.title,shapes:JSON.stringify(this.shapes,null," ")}}}]),e}(),He=["#FF0303","#4AA403","#540080","#FFFF40","#FF0080","#AED424","#545400","#FFA980","#A95480","#A9A9FF","#00FF00","#FFEE76","#A40576","#4385C8","#1CC826","#BDBD00","#48316E","#14616E","#8040BD","#DC7676","#924845","#A90000","#FFA900"],Ve=function(){function e(){Object(ge.a)(this,e)}return Object(ve.a)(e,null,[{key:"newLayer",value:function(t,a){var n=new ze(t);return n.name=e.getNewName(a),0===a.length&&(n.displayed=!1,n.affected=!1),n}},{key:"defaultName",get:function(){return"layer"}},{key:"getNewName",value:function(t){for(var a=e.defaultName,n=1,r=function(e){return e.name===a};t.find(r);)a=e.defaultName+n,n++;return a}},{key:"getAffected",value:function(e){return e.find((function(e){return e.affected}))}},{key:"setAffected",value:function(t,a){var n=e.getAffected(t);n&&(n.affected=!1),a.affected=!0}},{key:"getNextColor",value:function(e){var t,a="",n=Object(me.a)(He);try{var r=function(){var n=t.value;if(!e.find((function(e){return e.displayed&&e.color===n})))return a=n,"break"};for(n.s();!(t=n.n()).done;){if("break"===r())break}}catch(o){n.e(o)}finally{n.f()}return a}},{key:"delete",value:function(t,a){var n=t.findIndex((function(e){return e===a})),r=t.filter((function(e){return e!==a}));return n>0&&(r[n-1].affected=!0,""===r[n-1].color&&(r[n-1].color=e.getNextColor(r)),r[n-1].displayed=!0),r}},{key:"sort",value:function(e){var t=e.slice();return t.sort((function(e,t){var a=e.name.toUpperCase(),n=t.name.toUpperCase();return a<n?-1:a>n?1:0})),t}},{key:"toJSON",value:function(e){return e.map((function(e){return e.toJSON()}))}}]),e}(),qe=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,n=t.find((function(e){return e.affected})),r=t.findIndex((function(e){return e.affected}));switch(a.type){case P:return e=Ve.newLayer(a.stage,t),[].concat(Object(be.a)(t),[e]);case N:return[].concat(Object(be.a)(t),[a.layer]);case F:return n?Ve.delete(t,n):t;case ie:return[];case U:return Ve.sort(t);case B:var o="";if(!a.layer.displayed&&""===(o=Ve.getNextColor(t)))return;return t.map((function(e){if(e!==a.layer)return a.layer.displayed?e:e.setAffected(!1);var t=e.toggleDisplayed(o);return t.affected=t.displayed,t}));case W:return t.map((function(e){return e!==a.layer?e.setAffected(!1):e.setAffected(!e.affected)}));case Y:return t.map((function(e){return e!==n?e:e.setEdited(!0)}));case R:return t.map((function(e){return e.edited?e.setNameAndTitle(a.newLayer.name,a.newLayer.title):e}));case X:return t.map((function(e){return e.edited?e.setEdited(!1):e}));case z:if(r===t.length-1)return t;var s=t[r+1];return t.map((function(e){if(e===n){var t=e.toggleDisplayed("");return t.affected=!1,t}if(e===s){var a=n.color,r=e.toggleDisplayed(a);return r.affected=!0,r}return e}));case H:if(0===r)return t;var i=t[r-1];return t.map((function(e){if(e===n){var t=e.toggleDisplayed("");return t.affected=!1,t}if(e===i){var a=e.toggleDisplayed(n.color);return a.displayed=!0,a.affected=!0,a}return e}));default:return t}},Ge={x:0,y:0,startX:void 0,startY:void 0,touchPoints:void 0},Ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object.assign({},e,{x:t.x,y:t.y});case x:return Object.assign({},e,{startX:t.x,startY:t.y});case _:return Object.assign({},e,{startX:void 0,startY:void 0});case D:return Object(l.a)(Object(l.a)({},e),{},{touchPoints:[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2}]});case M:return Object(l.a)(Object(l.a)({},e),{},{touchPoints:void 0});default:return e}},Qe=a(8),Je={measureShapesActive:!1,measureShapesFirstClick:!0,hoveredShape:null,firstMeasuredShape:null,secondMeasuredShape:null,firstMeasuredLayer:null,secondMeasuredLayer:null,distance:void 0,shortestSegment:null},Ze=window.mobilecheck(),$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object.assign({},Je,{measureShapesActive:!0});case h:case f:return Object.assign({},Je);case E:return Object.assign({},e,{hoveredShape:e.measureShapesActive?t.shape:null});case C:return Object.assign({},e,{hoveredShape:null});case L:if(!e.measureShapesActive)return e;if(e.measureShapesFirstClick)return Object.assign({},e,{firstMeasuredShape:t.shape,firstMeasuredLayer:t.layer,secondMeasuredShape:null,secondMeasuredLayer:null,measureShapesFirstClick:!1,distance:void 0,shortestSegment:null});if(t.shape===e.firstMeasuredShape)return e;var a,n,r=e.firstMeasuredShape.geom,o=t.shape.geom,s=ye.q.Distance.distance(r,o),i=Object(Qe.a)(s,2);return a=i[0],n=i[1],Object.assign({},e,{secondMeasuredShape:t.shape,secondMeasuredLayer:t.layer,measureShapesFirstClick:!0,distance:a,shortestSegment:n});case x:return e.hoveredShape||Ze?e:Object.assign({},e,{measureShapesFirstClick:!0,firstMeasuredShape:null,firstMeasuredLayer:null,secondMeasuredShape:null,secondMeasuredLayer:null,distance:void 0,shortestSegment:null});case F:return t.layer===e.firstMeasuredLayer||t.layer===e.secondMeasuredLayer?Object.assign({},Je):e;case B:return!t.layer.displayed||t.layer!==e.firstMeasuredLayer&&t.layer!==e.secondMeasuredLayer?e:Object.assign({},Je);default:return e}},et=a(73),tt=a(74),at={id:void 0,name:"",owner:"Alex Bol",lastUpdated:void 0},nt={document:at,documentsList:{}};function rt(e,t){if(null===t||void 0===t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var a in e)if(!t.hasOwnProperty(a)||e[a].lastUpdated===t[a].lastUpdated)return!1;return!0}var ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:case ae:return Object(l.a)(Object(l.a)({},e),{},{document:{id:t.id,name:t.name,owner:t.owner,lastUpdated:t.lastUpdated}});case te:return Object(l.a)(Object(l.a)({},e),{},{document:Object(l.a)(Object(l.a)({},e.document),{},{lastUpdated:t.lastUpdated})});case se:return Object(l.a)(Object(l.a)({},e),{},{document:Object(l.a)(Object(l.a)({},e.document),{},{name:t.name})});case re:var a=e.documentsList,n=t.id,r=(a[n],Object(et.a)(a,[n].map(tt.a)));return Object(l.a)(Object(l.a)({},e),{},{document:e.document.id===t.id?at:e.document,documentsList:r});case oe:return Object(l.a)(Object(l.a)({},e),{},{document:t.document});case ie:return Object(l.a)(Object(l.a)({},e),{},{document:at});case ne:return rt(e.documentsList,t.documentsList)?e:Object(l.a)(Object(l.a)({},e),{},{documentsList:t.documentsList});default:return e}},st={uploadStarted:!1,uploadCompleted:!1,uploadedFiles:[]},it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return st;case V:return Object(l.a)(Object(l.a)({},e),{},{uploadCompleted:!0,uploadedFiles:t.uploadedFiles});default:return e}},ct=Object(o.b)({auth:fe,app:Ye,layers:qe,upload:it,cloudStorage:ot,measureShapesTool:$e,mouse:Ke}),lt=function(e){e.getState,e.dispatch;return function(e){return function(t){t.type!==k&&console.log("ACTION: "+t.type,t),e(t)}}};function pt(e){return"segment"===e.name?new ye.q.Segment(e):"arc"===e.name?new ye.q.Arc(e):"point"===e.name?new ye.q.Point(e):void 0}function ut(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,n=new Me;n.filename=t;try{e=JSON.parse(a)}catch(u){throw new Error("Illegal JSON string")}if(e instanceof Array)try{var r,o=new ye.q.Polygon,s=Object(me.a)(e);try{for(s.s();!(r=s.n()).done;){var i=r.value;o.addFace(i)}}catch(d){s.e(d)}finally{s.f()}n.shapes.push(o)}catch(u){var c,l=Object(me.a)(e);try{for(l.s();!(c=l.n()).done;){var p=c.value;n.shapes.push(pt(p))}}catch(d){l.e(d)}finally{l.f()}}else n.shapes.push(pt(e));return n}ye.q.Image=function(){function e(){Object(ge.a)(this,e),this.uri="",this.center=new ye.q.Point,this.width=0,this.height=0}return Object(ve.a)(e,[{key:"box",get:function(){return new ye.q.Box(this.center.x-this.width/2,this.center.y-this.height/2,this.center.x+this.height/2,this.center.y+this.height/2)}}]),e}();var dt=function(e){var t=e.dispatch,a=e.getState;return function(e){return function(n){if(n.type!==G)return e(n);var r=a(),o=r.app.stage,s=r.layers,i=r.app.parser,c=void 0;r.app.importDataToNewLayer?(c=Ve.newLayer(o,s),s.push(c)):(c=s.find((function(e){return e.affected})))||(c=Ve.newLayer(o,s),s.push(c));var l,p=Object(me.a)(n.data.items);try{for(p.s();!(l=p.n()).done;){l.value.getAsString((function(e){var a;try{a=ut("",e).shapes}catch(l){console.log(l.message),a=i.parse(e)}if(a.length>0){var n,r=Object(me.a)(a);try{for(r.s();!(n=r.n()).done;){var s=n.value;c.add(s)}}catch(p){r.e(p)}finally{r.f()}}c.shapes.length>0&&(t({type:T,shape:c,stage:o}),t({type:B,layer:c}))}));break}}catch(u){p.e(u)}finally{p.f()}}}},ht=function(e){var t=e.getState;e.dispatch;return function(e){return function(a){var n=t().mouse,r=a.stage;if(r)switch(a.type){case u:r.resize();break;case x:r.panByMouseStart();break;case k:void 0!==a.dx&&void 0!==a.dy&&r.panByMouseMove(a.dx,a.dy);break;case _:r.panByMouseStop();break;case T:var o=a.shape.center,s=a.shape.box;if(isNaN(o.x)||isNaN(o.y))return;r.panToCoordinate(o.x,o.y),r.zoomToLimits(s.xmax-s.xmin,s.ymax-s.ymin);break;case A:var i=a.delta>0;r.zoomByMouse(a.x,a.y,i,1.2);break;case"CLEAR_ALL":r.removeAllChildren(),r.removeAllListeners();break;case D:r.zoomByPinchStart(a.x1,a.y1);break;case I:if(n.touchPoints){var c=n.touchPoints[0].x-n.touchPoints[1].x,l=n.touchPoints[0].y-n.touchPoints[1].y,p=Math.sqrt(c*c+l*l);c=a.x2-a.x1,l=a.y2-a.y1;var d=Math.sqrt(c*c+l*l)/p;r.zoomByPinchMove(a.x1,a.y1,d)}break;case M:r.zoomByPinchStop()}e(a)}}},ft=window.Algorithmia,mt=function(e){var t=e.dispatch,a=e.getState;return function(e){return function(n){if(n.type===J){var r=a(),o=r.app.stage,s=r.layers,i=Ve.getAffected(s),c=i.shapes.map((function(e){return[e.geom.x/400,e.geom.y/400,e.geom.nx,e.geom.ny]}));ft.client("simby4RUwqQmtMDaHAPj5wsQwlD1").algo("alexbol99/SeketonRecognition").pipe(c).then((function(e){if(e.error)return console.error("error: "+e.error);var a=Ve.newLayer(o,s);a.name="recognized",a.title="recognized";var n,r=Object(me.a)(e.result);try{for(r.s();!(n=r.n()).done;){var c=n.value,l=void 0;if(c[0]instanceof Array&&2===c[0].length){var p=Object(ye.r)(400*c[0][0],400*c[0][1]),u=400*c[1];l=Object(ye.p)(p,u,c[2],c[3],ye.q.CCW)}else l=Object(ye.s)(Object(ye.r)(400*c[0],400*c[1]),Object(ye.r)(400*c[2],400*c[3]));c[4]&&(l.label=c[4]),a.add(l)}}catch(d){r.e(d)}finally{r.f()}s.push(a),t({type:T,stage:o,shape:i})}))}return e(n)}}},gt=a(6),vt=a(7),yt=a(5),bt=a.n(yt),Ot=a(15),jt=a(22),wt=a.n(jt),St=wt.a.create({baseURL:"https://debug-viewer.firebaseio.com/"}),kt=function(e,t){return{type:T,stage:e,shape:t}},xt=function(){return{type:Z}},_t=function(){return{type:$}},At=function(e){return{type:N,layer:e}},Et=function(e){return{type:B,layer:e}},Ct=function(){return{type:ie}},Lt="document",Dt=function(e){for(var t=Lt,a=1,n=function(e){return e.name===t};Object.values(e).find(n);)t=Lt+a,a++;return t},It=function(e,t){return function(a){a(Ct()),a(xt());var n="",r=void 0,o=void 0,s="/documents/"+t+".json",i="/geom.json"+('?orderBy="id"&equalTo="'+t+'"');Promise.all([St.get(s),St.get(i)]).then((function(s){n=s[0].data.name,r=s[0].data.lastUpdated;var i,c=Object(me.a)(Object.values(s[1].data)[0].layers);try{for(c.s();!(i=c.n()).done;){var l=i.value,p=new ze;p.shapes=ut(l.shapes),p.name=l.name,o||(o=p),a(At(p)),a(Et(p))}}catch(u){c.e(u)}finally{c.f()}a(function(e,t,a,n){return{type:ae,id:e,name:t,owner:a,lastUpdated:n}}(t,n,"Alex Bol",r)),a(kt(e,o)),a(_t())})).catch((function(e){alert(e.message),a(_t())}))}},Mt=function(e,t,a){return function(n){var r=void 0;n(xt()),St.post("/documents.json",e).then((function(e){r=e.data.name;var a=Ve.toJSON(t),n={id:r,layers:a};return St.post("/geom.json",n)})).then((function(e){n(function(e,t){return{type:ee,id:e,lastUpdated:t}}(r,Date.now())),n(_t()),a.push("/documents/"+r)})).catch((function(e){alert(e.message),n(_t())}))}},Tt=function(e,t,a){return function(n){n(xt()),St.put("/documents/".concat(e,".json"),t).then((function(t){var a;n((a=Date.now(),{type:te,lastUpdated:a}));var r="/geom.json"+('?orderBy="id"&equalTo="'+e+'"');return St.get(r)})).then((function(t){var n=Ve.toJSON(a),r={id:e,layers:n},o=Object.keys(t.data)[0];return St.put("/geom/".concat(o,".json"),r)})).then((function(e){n(_t())})).catch((function(e){alert(e.message),n(_t())}))}},Pt=a(41),Nt=a.n(Pt),Ft=a(27),Ut=a.n(Ft),Bt=a(1),Wt=function(e){var t;switch(e.type){case"trigger":t=Ut.a.IconTrigger;break;case"mode":t=e.active?Ut.a.IconModeActive:Ut.a.IconModeNotActive;break;default:t=Ut.a.IconTrigger}var a=e.mobileOnly?Ut.a.DrawerButton:Ut.a.Button;return Object(Bt.jsx)("button",{title:e.title,onClick:e.onClick,className:a,children:Object(Bt.jsx)(Nt.a,{name:e.iconName,size:"2x",className:t})})},Yt=a(45),Rt=a.n(Yt),Xt=function(){return Object(Bt.jsx)("div",{className:Rt.a.ButtonSeparator,children:Object(Bt.jsx)(Nt.a,{name:"ellipsis-v",size:"2x",className:Rt.a.IconSeparator})})},zt=a(46),Ht=a.n(zt),Vt=(a(58),function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"render",value:function(){return Object(Bt.jsxs)("div",{className:Ht.a["App-toolbar"],children:[Object(Bt.jsx)(Wt,{type:"trigger",title:"Open files",iconName:"folder-open",onClick:this.props.onShowUploadPopupPressed}),Object(Bt.jsx)(Xt,{}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Show/hide layers",iconName:"layer-group",onClick:this.props.onLayerListButtonClicked}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Sort layers",iconName:"sort-alpha-down",onClick:this.props.onSortLayersButtonClicked}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Download layers",iconName:"file-download",onClick:this.props.onShowDownloadPopupPressed}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Delete all layers",iconName:"broom",onClick:this.props.onClearAllButtonClicked}),Object(Bt.jsx)(Xt,{}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Zoom and pan to home view",iconName:"home",onClick:this.props.onHomeButtonPressed}),Object(Bt.jsx)(Xt,{}),Object(Bt.jsx)(Wt,{type:"mode",title:"Pan by drag",iconName:"arrows-alt",active:!this.props.measurePointsActive,onClick:this.props.onPanByDragPressed}),Object(Bt.jsx)(Wt,{type:"mode",title:"Measure distance between points",iconName:"drafting-compass",active:this.props.measurePointsActive,onClick:this.props.onMeasurePointsButtonPressed}),Object(Bt.jsx)(Xt,{}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Measure distance between selected shapes",iconName:"ruler",onClick:this.props.onMeasureBetweenShapesButtonPressed}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Display solid or wire",iconName:"fill-drip",onClick:this.props.onToggleWidthModePressed}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Display vertices on/off",iconName:"draw-polygon",onClick:this.props.onToggleVerticesPressed}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Display labels on/off",iconName:"tag",onClick:this.props.onToggleLabelsPressed}),this.props.showSkeletonRecognitionButton?Object(Bt.jsx)(Wt,{type:"trigger",title:"Skeleton Recognition Demo",iconName:"tree",onClick:this.props.onSkeletonRecognitionButtonPressed}):null,Object(Bt.jsx)(Xt,{}),Object(Bt.jsx)("button",{className:Ht.a["App-toolbar-units"],onClick:this.props.onUnitClicked,children:this.props.units}),Object(Bt.jsx)(Xt,{}),Object(Bt.jsx)(Wt,{type:"trigger",title:"About",iconName:"info",onClick:this.props.onShowAboutPopupPressed}),Object(Bt.jsx)(Xt,{})]})}}]),a}(yt.Component)),qt=a(61),Gt=a.n(qt),Kt=a(30),Qt=a(16),Jt=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(e){var n;return Object(ge.a)(this,a),n=t.call(this,e),Qt.g.enable(Object(Kt.a)(n)),n.mouseMoveOutside=!1,n.enableMouseOver(20),n.canvas.clientWidth>0&&n.canvas.clientHeight>0&&(n.canvas.width=n.canvas.clientWidth,n.canvas.height=n.canvas.clientHeight),n.origin={x:n.canvas.width/2,y:n.canvas.height/2},n.resolution=1e-5,n.zoomFactor=1,n.oldOrigin={x:void 0,y:void 0},n.oldZoomFactor=void 0,n.pinchAnchorX=void 0,n.pinchAnchorY=void 0,n.pinchStarted=!1,n}return Object(ve.a)(a,[{key:"box",get:function(){var e=this.C2W_X(0),t=this.C2W_Y(this.canvas.height),a=this.C2W_X(this.canvas.width),n=this.C2W_Y(0);return new ye.b(e,t,a,n)}},{key:"clone",value:function(){var e=new a(this.canvas);return Object.assign(e,this)}},{key:"add",value:function(e){return this.addChild(e),this}},{key:"scalingFactor",value:function(){return this.resolution*this.zoomFactor}},{key:"C2W_Scalar",value:function(e){return e/this.scalingFactor()}},{key:"W2C_Scalar",value:function(e){return this.scalingFactor()*e}},{key:"C2W_X",value:function(e){return(e-this.origin.x)/this.scalingFactor()}},{key:"C2W_Y",value:function(e){return(this.origin.y-e)/this.scalingFactor()}},{key:"W2C_X",value:function(e){return this.scalingFactor()*e+this.origin.x}},{key:"W2C_Y",value:function(e){return this.origin.y-this.scalingFactor()*e}},{key:"W2C",value:function(e){return{x:this.W2C_X(e.x),y:this.W2C_Y(e.y)}}},{key:"panTo",value:function(e){this.origin={x:e.x,y:e.y}}},{key:"panBy",value:function(e,t){this.origin={x:this.origin.x+e,y:this.origin.y+t}}},{key:"zoomIn",value:function(e){var t=e||1.1;this.zoomFactor=Math.min(1e7,t*this.zoomFactor)}},{key:"zoomOut",value:function(e){var t=e||1.1;this.zoomFactor=Math.max(.001,this.zoomFactor/t)}},{key:"zoom",value:function(e,t,a,n){var r=this.C2W_X(e),o=this.C2W_Y(t);a?this.zoomIn(n):this.zoomOut(n);var s=this.W2C_X(r),i=this.W2C_Y(o);return this.panBy(e-s,t-i),[s,i]}},{key:"zoomByMouse",value:function(e,t,a,n){this.zoom(e,t,a,n)}},{key:"zoomToLimits",value:function(e,t){0===e&&(e=4e5),0===t&&(t=4e5);var a=Math.min(this.canvas.width/(1.1*e),this.canvas.height/(1.1*t))/this.resolution/this.zoomFactor,n=this.canvas.width/2,r=this.canvas.height/2;this.zoom(n,r,!0,a)}},{key:"resize",value:function(){this.canvas.clientWidth>0&&this.canvas.clientHeight>0&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight)}},{key:"panByMouseStart",value:function(){this.oldOrigin.x=this.origin.x,this.oldOrigin.y=this.origin.y,this.zoomByPinchStop()}},{key:"panByMouseMove",value:function(e,t){this.pinchStarted||void 0!==e&&void 0!==t&&void 0!==this.oldOrigin.x&&void 0!==this.oldOrigin.y&&(this.origin={x:this.oldOrigin.x+e,y:this.oldOrigin.y+t})}},{key:"panByMouseStop",value:function(){this.oldOrigin.x=void 0,this.oldOrigin.y=void 0}},{key:"panToCoordinate",value:function(e,t){var a=this.W2C_X(e),n=this.W2C_Y(t),r=this.canvas.width/2-a,o=this.canvas.height/2-n;this.panBy(r,o)}},{key:"zoomByPinchStart",value:function(e,t){this.oldZoomFactor=this.zoomFactor,this.pinchAnchorX=this.C2W_X(e),this.pinchAnchorY=this.C2W_Y(t),this.pinchStarted=!0,this.panByMouseStop()}},{key:"zoomByPinchMove",value:function(e,t,a){this.zoomFactor=a*this.oldZoomFactor,this.origin={x:e-this.scalingFactor()*this.pinchAnchorX,y:t+this.scalingFactor()*this.pinchAnchorY}}},{key:"zoomByPinchStop",value:function(){this.oldZoomFactor=void 0,this.pinchAnchorX=void 0,this.pinchAnchorY=void 0,this.pinchStarted=!1}},{key:"clear",value:function(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}}]),a}(Qt.e),Zt=function(e,t,a,n){return{type:A,stage:e,x:t,y:a,delta:n}},$t=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).canvasElement=Object(yt.createRef)(),e.handleMouseMove=function(t){if(e.props.stage.canvas.focus(),t.nativeEvent.touches&&1!==t.nativeEvent.touches.length){if(t.nativeEvent.touches&&2===t.nativeEvent.touches.length){var a=[{x:t.nativeEvent.touches[0].clientX-t.nativeEvent.target.offsetLeft,y:t.nativeEvent.touches[0].clientY-t.nativeEvent.target.offsetTop},{x:t.nativeEvent.touches[1].clientX-t.nativeEvent.target.offsetLeft,y:t.nativeEvent.touches[1].clientY-t.nativeEvent.target.offsetTop}];e.props.handlePinchMove(e.props.stage,a)}}else e.props.handleMouseMove(e.props.stage,t.stageX,t.stageY,e.props.mouse.startX?t.stageX-e.props.mouse.startX:void 0,e.props.mouse.startY?t.stageY-e.props.mouse.startY:void 0)},e.handleMouseDown=function(t){if(t.nativeEvent.touches&&1!==t.nativeEvent.touches.length){if(t.nativeEvent.touches&&2===t.nativeEvent.touches.length){var a=[{x:t.nativeEvent.touches[0].clientX-t.nativeEvent.target.offsetLeft,y:t.nativeEvent.touches[0].clientY-t.nativeEvent.target.offsetTop},{x:t.nativeEvent.touches[1].clientX-t.nativeEvent.target.offsetLeft,y:t.nativeEvent.touches[1].clientY-t.nativeEvent.target.offsetTop}];e.props.handlePinchDown(e.props.stage,a)}}else e.props.handleMouseDown(e.props.stage,t.stageX,t.stageY)},e.handleMouseUp=function(t){t.stopPropagation(),t.preventDefault(),t.nativeEvent.touches&&1!==t.nativeEvent.touches.length?t.nativeEvent.touches&&2===t.nativeEvent.touches.length&&e.props.handlePinchUp(e.props.stage):e.props.handleMouseUp(e.props.stage)},e.handleMouseLeave=function(t){e.props.stage.canvas.blur(),document.body.focus()},e.handleMouseWheel=function(t){var a=t.detail||t.wheelDelta;0!==a&&e.props.handleMouseWheelMove(e.props.stage,t.offsetX,t.offsetY,a)},e.handleMouseWheelFox=function(t){0!==t.detail&&e.props.handleMouseWheelMove(e.props.stage,t.layerX,t.layerY,-t.detail)},e}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){var e=new Jt(this.canvasElement.current);e.on("stagemousedown",this.handleMouseDown),e.on("stagemousemove",this.handleMouseMove),e.on("stagemouseup",this.handleMouseUp),e.on("mouseleave",this.handleMouseLeave),e.canvas.addEventListener("mousewheel",this.handleMouseWheel,{passive:!0}),e.canvas.addEventListener("DOMMouseScroll",this.handleMouseWheelFox,{passive:!0}),this.props.registerStage(e)}},{key:"render",value:function(){return Object(Bt.jsx)("canvas",{tabIndex:"1",ref:this.canvasElement,id:"mainCanvas",className:Gt.a["App-canvas"],width:"100",height:"100"})}}]),a}(yt.Component),ea=Object(s.b)((function(e){return{stage:e.app.stage,mouse:e.mouse}}),(function(e){return{registerStage:function(t){return e(function(e){return{type:p,stage:e}}(t))},handleMouseDown:function(t,a,n){return e(function(e,t,a){return{type:x,stage:e,x:t,y:a}}(t,a,n))},handleMouseUp:function(t,a,n){return e(function(e,t,a){return{type:_,stage:e,x:t,y:a}}(t,a,n))},handleMouseMove:function(t,a,n,r,o){return e(function(e,t,a,n,r){return{type:k,stage:e,x:t,y:a,dx:n,dy:r}}(t,a,n,r,o))},handleMouseWheelMove:function(t,a,n,r){return e(Zt(t,a,n,r))},handlePinchDown:function(t,a){return e(function(e,t){return{type:D,stage:e,x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}(t,a))},handlePinchMove:function(t,a){return e(function(e,t){return{type:I,stage:e,x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}(t,a))},handlePinchUp:function(t){return e(function(e){return{type:M,stage:e}}(t))}}}))($t),ta=a(62),aa=a.n(ta),na=function(){return Object(Bt.jsx)("div",{className:aa.a["App-status-bar"],children:Object(Bt.jsx)("div",{children:Object(Bt.jsx)("h5",{children:"\xa0"})})})},ra=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"componentDidUpdate",value:function(){if(this.props.stage.canvas&&this.props.stage.canvas.getContext("2d")){var e=this.props.stage.origin,t=this.props.stage.zoomFactor*this.props.stage.resolution;this.props.stage.setTransform(e.x,e.y,t,-t),this.props.stage.update()}}},{key:"componentWillUnmount",value:function(){this.props.onStageUnmounted()}},{key:"render",value:function(){return Object(Bt.jsx)(yt.Fragment,{children:this.props.children})}}]),a}(yt.Component);function oa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e instanceof ye.k?sa(e,t):e instanceof ye.m?ia(e,t):e instanceof ye.a?ca(e,t):e instanceof ye.e?la(e,t):e instanceof ye.b?pa(e,t):e instanceof ye.l?ha(e,t):null}function sa(e,t){var a=t&&t.radius?t.radius:3,n=t&&t.fill?t.fill:"#FF0303",r=new Qt.b;return r.fill=r.beginFill(n).command,r.circle=r.drawCircle(e.x,e.y,a).command,r}function ia(e,t){var a=new Qt.b,n=t&&void 0!==t.strokeStyle?t.strokeStyle:2,r=!t||void 0===t.ignoreScale||t.ignoreScale,o=t&&t.stroke?t.stroke:"black";return a.setStrokeStyle(n,1,0,10,r).beginStroke(o).moveTo(e.ps.x,e.ps.y).lineTo(e.pe.x,e.pe.y).endStroke()}function ca(e,t){var a=new Qt.b,n=t&&t.strokeStyle?t.strokeStyle:2,r=!t||void 0===t.ignoreScale||t.ignoreScale,o=t&&t.stroke?t.stroke:"black";return a.setStrokeStyle(n,1,0,10,r).beginStroke(o).arc(e.pc.x,e.pc.y,e.r,e.startAngle,e.endAngle,!e.counterClockwise).endStroke()}function la(e,t){var a=new Qt.b,n=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";return a.setStrokeStyle(n,0,0,10,!0),a.stroke=a.beginStroke(r).command,a.fill=a.beginFill(o).command,a.drawCircle(e.pc.x,e.pc.y,e.r),a}function pa(e,t){var a=new Qt.b,n=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";return a.setStrokeStyle(n,0,0,10,!0),a.stroke=a.beginStroke(r).command,a.fill=a.beginFill(o).command,a.drawRect(e.xmin,e.ymin,e.xmax-e.xmin,e.ymax-e.ymin),a}function ua(e,t){t.shape instanceof ye.m?function(e,t){e.lineTo(t.pe.x,t.pe.y)}(e,t.shape):t.shape instanceof ye.a&&function(e,t){e.arc(t.pc.x,t.pc.y,t.r,t.startAngle,t.endAngle,!t.counterClockwise)}(e,t.shape)}function da(e,t){var a=t.first.start;e.moveTo(a.x,a.y);var n,r=Object(me.a)(t);try{for(r.s();!(n=r.n()).done;){ua(e,n.value)}}catch(o){r.e(o)}finally{r.f()}}function ha(e,t){var a=new Qt.b,n=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";a.setStrokeStyle(n,0,0,10,!0),a.stroke=a.beginStroke(r).command,a.fill=a.beginFill(o).command;var s,i=Object(me.a)(e.faces);try{for(i.s();!(s=i.n()).done;){da(a,s.value)}}catch(c){i.e(c)}finally{i.f()}return a.endStroke(),a}var fa=function(e,t){for(var a=!0,n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];if(t[o]!==e[o]){a=!1;break}}return a},ma=function(e,t,a){return(e/t).toFixed(a)},ga=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(e){var n;return Object(ge.a)(this,a),(n=t.call(this)).handleMouseOver=function(e){n.props.onMouseOver(n.props.model)},n.handleMouseOut=function(e){n.props.onMouseOut()},n.handleClick=function(e){n.props.onClick(n.props.model,n.props.layer)},n.shape=new Qt.d,e.stage.addChild(n.shape),n}return Object(ve.a)(a,[{key:"redraw",value:function(){var e=this.props.stage,t=this.props.hovered||this.props.selected?"black":this.props.color,a=this.props.hovered||this.props.selected?1:.6,n=this.props.widthOn,r=this.props.model.geom.aperture?this.props.model.geom.aperture:void 0,o=n?this.props.color:"white";this.shape.graphics.isEmpty()?this.shape.graphics=oa(this.props.model.geom,{strokeStyle:r,ignoreScale:!0,stroke:t,fill:o,radius:3/(e.zoomFactor*e.resolution)}):(this.shape.graphics.stroke&&(this.shape.graphics.stroke.style=t),this.shape.graphics.fill&&(this.shape.graphics.fill.style=o),this.shape.graphics.circle&&(this.shape.graphics.circle.radius=3/(e.zoomFactor*e.resolution))),this.shape.alpha=this.props.displayed?a:0}},{key:"componentDidMount",value:function(){this.shape.on("mouseover",this.handleMouseOver),this.shape.on("mouseout",this.handleMouseOut),this.shape.on("click",this.handleClick),this.redraw()}},{key:"shouldComponentUpdate",value:function(e,t){return!fa(this.props,e)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.shape.off("mouseover",this.handleMouseOver),this.shape.off("mouseout",this.handleMouseOut),this.shape.off("click",this.handleClick),this.props.stage.removeChild(this.shape),this.shape.graphics.clear()}},{key:"render",value:function(){return null}}]),a}(yt.Component),va=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleMouseOver=function(t){e.props.onMouseOver(e.props.model)},e.handleMouseOut=function(t){e.props.onMouseOut()},e.handleClick=function(t){e.props.onClick(e.props.model,e.props.layer)},e}return Object(ve.a)(a,[{key:"redraw",value:function(){if(this.bitmap){this.bitmap.alpha=this.props.displayed?1:0;var e=this.props.model.geom.width,t=this.bitmap.image.naturalWidth/this.bitmap.image.naturalHeight;this.props.model.geom.height=this.props.model.geom.width/t;var a=e/this.bitmap.image.naturalWidth,n=e/(this.bitmap.image.naturalHeight*t),r=this.props.model.geom.center.x,o=this.props.model.geom.center.y;this.bitmap.setTransform(r,o,a,-n),this.bitmap.regX=this.bitmap.image.naturalWidth/2,this.bitmap.regY=this.bitmap.image.naturalHeight/2}}},{key:"loadImage",value:function(){var e=this,t=new Image;t.onload=function(){e.bitmap=new Qt.a(t),e.props.stage.addChild(e.bitmap),e.redraw(),e.props.onImageLoaded(e.props.model,e.props.layer,t)},t.setAttribute("crossOrigin","anonymous"),t.src=this.props.model.geom.uri}},{key:"componentDidMount",value:function(){this.loadImage()}},{key:"shouldComponentUpdate",value:function(e,t){return!fa(this.props,e)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.props.stage.removeChild(this.bitmap)}},{key:"render",value:function(){return null}}]),a}(yt.Component),ya=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onImageLoaded=function(t,a,n){e.props.setHomeView(e.props.stage,e.props.layer),e.forceUpdate()},e}return Object(ve.a)(a,[{key:"render",value:function(){var e=this;return this.props.layer.shapes.map((function(t,a){return t.geom.uri?Object(Bt.jsx)(va,{stage:e.props.stage,layer:e.props.layer,model:t,displayed:e.props.layer.displayed,hovered:t===e.props.hoveredShape,selected:t===e.props.firstMeasuredShape||t===e.props.secondMeasuredShape,color:e.props.layer.color,widthOn:e.props.widthOn,displayLabels:e.props.displayLabels,zoomFactor:e.props.zoomFactor,onMouseOver:e.props.onMouseOver,onMouseOut:e.props.onMouseOut,onClick:e.props.onClick,onImageLoaded:e.onImageLoaded},a):Object(Bt.jsx)(ga,{stage:e.props.stage,layer:e.props.layer,model:t,displayed:e.props.layer.displayed,hovered:t===e.props.hoveredShape,selected:t===e.props.firstMeasuredShape||t===e.props.secondMeasuredShape,color:e.props.layer.color,widthOn:e.props.widthOn,displayVertices:e.props.displayVertices,zoomFactor:e.props.zoomFactor,onMouseOver:e.props.handleMouseRollOverShape,onMouseOut:e.props.handleMouseRollOutShape,onClick:e.props.handleClickOnShape},a)}))}}]),a}(yt.Component),ba=Object(s.b)((function(e){return{stage:e.app.stage,layers:e.layers,displayVertices:e.app.displayVertices,displayLabels:e.app.displayLabels,widthOn:e.app.widthOn,zoomFactor:e.app.zoomFactor,units:e.app.units,divisor:e.app.divisor,decimals:e.app.decimals,measurePointsActive:e.app.measurePointsActive,showAboutPopup:e.app.showAboutPopup,showDownloadPopup:e.app.showDownloadPopup,showUploadPopup:e.app.showUploadPopup,measureShapesTool:e.measureShapesTool,hoveredShape:e.measureShapesTool.hoveredShape,firstMeasuredShape:e.measureShapesTool.firstMeasuredShape,secondMeasuredShape:e.measureShapesTool.secondMeasuredShape}}),(function(e){return{setHomeView:function(t,a){return e(kt(t,a))},handleMouseRollOverShape:function(t){return e(function(e){return{type:E,shape:e}}(t))},handleMouseRollOutShape:function(){return e({type:C})},handleClickOnShape:function(t,a){return e(function(e,t){return{type:L,shape:e,layer:t}}(t,a))}}}))(ya),Oa=a(63),ja=a.n(Oa),wa=function(e){var t=e.stage,a=e.shape,n=a.geom.center||a.geom,r=t.canvas.offsetLeft+t.W2C_X(n.x)+6,o=t.canvas.offsetTop+t.W2C_Y(n.y)-4;return r>t.canvas.offsetLeft&&r<t.canvas.offsetLeft+t.canvas.width&&o>t.canvas.offsetTop&&o<t.canvas.offsetTop+t.canvas.height?Object(Bt.jsx)("div",{style:{position:"absolute",left:r+"px",top:o+"px"},className:ja.a.LabelComponent,children:Object(Bt.jsx)("h5",{children:a.label})}):null},Sa=Object(s.b)((function(e){return{stage:e.app.stage,displayLabels:e.app.displayLabels,zoomFactor:e.app.zoomFactor,originX:e.app.originX,originY:e.app.originY}}),(function(e){return{}}))((function(e){return e.layer.displayed&&e.displayLabels?e.layer.shapes.map((function(t,a){return t.label&&""!==t.label.trim()?Object(Bt.jsx)(wa,{stage:e.stage,shape:t,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY},a):null})):null})),ka=a(64),xa=a.n(ka),_a=function(e){var t=e.stage,a=t.canvas.offsetLeft+t.W2C_X(e.vertex.x)+6,n=t.canvas.offsetTop+t.W2C_Y(e.vertex.y)-10,r=ma(e.vertex.x,e.divisor,e.decimals),o=ma(e.vertex.y,e.divisor,e.decimals);return Object(Bt.jsx)("div",{className:xa.a.VertexLabel,style:{left:a,top:n},children:Object(Bt.jsxs)("h5",{children:["x=",r," y=",o]})})},Aa=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(e){var n;return Object(ge.a)(this,a),(n=t.call(this)).handleMouseOver=function(e){n.shape.shadow=new Qt.c(n.props.color,0,0,10),n.setState({hovered:!0})},n.handleMouseOut=function(e){n.shape.shadow=null,n.setState({hovered:!1})},n.handleClick=function(e){console.log(n.props.vertex)},n.shape=new Qt.d,e.stage.addChild(n.shape),n.state={hovered:!1},n}return Object(ve.a)(a,[{key:"redraw",value:function(){var e=this.props.stage,t=this.props.color,a=this.props.color;this.shape.graphics.isEmpty()?this.shape.graphics=oa(this.props.vertex,{stroke:t,fill:a,radius:3/(e.zoomFactor*e.resolution)}):(this.shape.graphics.circle.radius=3/(e.zoomFactor*e.resolution),this.shape.graphics.fill.style=a),this.shape.alpha=1}},{key:"componentDidMount",value:function(){this.shape.on("mouseover",this.handleMouseOver),this.shape.on("mouseout",this.handleMouseOut),this.shape.on("click",this.handleClick),this.shape.mouseEnabled=!0,this.redraw()}},{key:"shouldComponentUpdate",value:function(e,t){return!fa(this.props,e)||!fa(this.state,t)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.shape.off("mouseover",this.handleMouseOver),this.shape.off("mouseout",this.handleMouseOut),this.shape.off("click",this.handleClick),this.props.stage.removeChild(this.shape),this.shape.graphics.clear()}},{key:"render",value:function(){return this.state.hovered?Object(Bt.jsx)(_a,{stage:this.props.stage,vertex:this.props.vertex,divisor:this.props.divisor,decimals:this.props.decimals}):null}}]),a}(yt.Component),Ea=function(e){return e.model.geom.vertices?e.model.geom.vertices.map((function(t,a){return Object(Bt.jsx)(Aa,{stage:e.stage,vertex:t,color:e.color,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY},a)})):null},Ca=Object(s.b)((function(e){return{stage:e.app.stage,displayVertices:e.app.displayVertices,zoomFactor:e.app.zoomFactor,originX:e.app.originX,originY:e.app.originY,divisor:e.app.divisor,decimals:e.app.decimals}}),(function(e){return{}}))((function(e){return e.layer.displayed&&e.displayVertices?e.layer.shapes.map((function(t,a){return Object(Bt.jsx)(Ea,{stage:e.stage,model:t,color:e.layer.color,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY},a)})):null})),La=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.props.layers.map((function(e){return Object(Bt.jsxs)(yt.Fragment,{children:[Object(Bt.jsx)(ba,{layer:e}),Object(Bt.jsx)(Sa,{layer:e}),Object(Bt.jsx)(Ca,{layer:e})]},e.name)}))}}]),a}(yt.Component),Da=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).measureCanvas=Object(yt.createRef)(),e.measureStage=null,e.state={startX:void 0,startY:void 0,endX:void 0,endY:void 0,measureStarted:!1},e.handleMouseDown=function(t){t.preventDefault(),e.measureStage.clear(),e.state.measureStarted?(e.setState({startX:void 0,startY:void 0,endX:void 0,endY:void 0,measureStarted:!1}),e.measureStage.canvas.style.cursor="auto"):(e.setState({startX:e.measureStage.C2W_X(t.stageX),startY:e.measureStage.C2W_Y(t.stageY),measureStarted:!0}),e.measureStage.canvas.style.cursor="crosshair")},e.handleMouseMove=function(t){e.state.measureStarted&&e.setState({endX:e.measureStage.C2W_X(t.stageX),endY:e.measureStage.C2W_Y(t.stageY)})},e.handleMouseUp=function(e){},e.handleMouseWheel=function(t){t.preventDefault();var a=t.detail||t.wheelDelta;0!==a&&(e.props.handleMouseWheelMove(e.props.stage,t.offsetX,t.offsetY,a),e.draw())},e.handleMouseWheelFox=function(t){t.preventDefault(),0!==t.detail&&(e.props.handleMouseWheelMove(e.props.stage,t.layerX,t.layerY,-t.detail),e.draw())},e}return Object(ve.a)(a,[{key:"draw",value:function(){var e=this.measureStage,t=e.canvas.getContext("2d");this.measureStage.origin=this.props.stage.origin,this.measureStage.resolution=this.props.stage.resolution,this.measureStage.zoomFactor=this.props.stage.zoomFactor,this.measureStage.clear();var a,n,r,o,s,i=Math.min(e.W2C_X(this.state.startX),e.W2C_X(this.state.endX)),c=Math.min(e.W2C_Y(this.state.startY),e.W2C_Y(this.state.endY)),l=Math.abs(e.W2C_Scalar(this.state.startX-this.state.endX)),p=Math.abs(e.W2C_Scalar(this.state.startY-this.state.endY));t.beginPath(),t.rect(i,c,l,p),t.moveTo(e.W2C_X(this.state.startX),e.W2C_Y(this.state.startY)),t.lineTo(e.W2C_X(this.state.endX),e.W2C_Y(this.state.endY)),t.lineWidth=1,t.strokeStyle="black",t.stroke();var u=this.measurement();t.font="12pt Arial",r=t.measureText(u).width,Math.abs(e.W2C_X(this.state.endX)-i)<=2?(t.textAlign="left",a=i+3,o=i):(t.textAlign="right",o=(a=i+l-3)-r-3),s=(n=Math.abs(e.W2C_Y(this.state.endY)-c)<=2?c-3:c+p+12+3)-12-3,t.fillStyle="white",t.globalAlpha=.4,t.fillRect(o,s,r+6,18),t.fillStyle="black",t.globalAlpha=1,t.fillText(this.measurement(),a,n)}},{key:"measurement",value:function(){var e=this.state.endX-this.state.startX,t=this.state.endY-this.state.startY,a=Math.sqrt(e*e+t*t);return"DX="+this.format(e)+",DY="+this.format(t)+",D="+this.format(a)}},{key:"format",value:function(e){return(e/this.props.divisor).toFixed(this.props.decimals)}},{key:"componentDidMount",value:function(){this.measureStage=new Jt(this.measureCanvas.current),this.measureStage.origin=this.props.stage.origin,this.measureStage.resolution=this.props.stage.resolution,this.measureStage.zoomFactor=this.props.stage.zoomFactor,this.measureStage.on("stagemousedown",this.handleMouseDown),this.measureStage.on("stagemousemove",this.handleMouseMove),this.measureStage.on("stagemouseup",this.handleMouseUp),this.measureStage.canvas.addEventListener("mousewheel",this.handleMouseWheel),this.measureStage.canvas.addEventListener("DOMMouseScroll",this.handleMouseWheelFox)}},{key:"componentDidUpdate",value:function(){this.state.measureStarted&&this.draw()}},{key:"componentWillUnmount",value:function(){this.measureStage.clear(),this.measureStage.removeAllChildren(),this.measureStage.removeAllEventListeners()}},{key:"render",value:function(){var e=this.props.stage.canvas,t=e.width,a=e.height,n=e.offsetTop,r=e.offsetLeft;return Object(Bt.jsx)("canvas",{tabIndex:"1",ref:this.measureCanvas,width:t,height:a,style:{position:"absolute",top:n,left:r}})}}]),a}(yt.Component),Ia=Object(s.b)((function(e){var t=e.app;return{stage:t.stage,divisor:t.divisor,decimals:t.decimals}}),(function(e){return{handleMouseWheelMove:function(t,a,n,r){return e(Zt(t,a,n,r))}}}))(Da),Ma=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(e){var n;return Object(ge.a)(this,a),(n=t.call(this)).segment=new Qt.d,e.stage.addChild(n.segment),n.labelShape=new Qt.f,n.labelShape.x=0,n.labelShape.y=0,e.stage.addChild(n.labelShape),n}return Object(ve.a)(a,[{key:"format",value:function(e){return(e/this.props.divisor).toFixed(this.props.decimals)}},{key:"redrawLabel",value:function(){if(this.labelShape){var e=this.props.stage,t=this.props.shortestSegment.box,a=(t.xmin+t.xmax)/2,n=(t.ymin+t.ymax)/2,r=6/(e.zoomFactor*e.resolution),o=4/(e.zoomFactor*e.resolution);t.ymin===t.ymax&&(r=0,o=-o),this.labelShape.text=this.format(this.props.shortestSegment.length);this.labelShape.font="".concat(14,"px Arial");var s=1/(e.zoomFactor*e.resolution),i=a+r,c=n+o;this.labelShape.setTransform(i,c,s,-s)}}},{key:"draw",value:function(){this.props.shortestSegment&&(this.segment.graphics=oa(this.props.shortestSegment),this.redrawLabel())}},{key:"componentDidMount",value:function(){this.draw()}},{key:"componentDidUpdate",value:function(){this.segment.graphics.clear(),this.props.firstMeasuredShape&&this.props.secondMeasuredShape&&this.props.firstMeasuredLayer.displayed&&this.props.secondMeasuredLayer.displayed&&(this.draw(),this.redrawLabel())}},{key:"componentWillUnmount",value:function(){this.props.stage.removeChild(this.segment),this.segment.graphics.clear(),this.props.stage.removeChild(this.labelShape),this.labelShape.text=""}},{key:"render",value:function(){return null}}]),a}(yt.Component),Ta=function(e){var t=e.stage,a=e.coordX,n=e.coordY,r=e.divisor,o=e.decimals,s=t.canvas,i=s.offsetTop+10,c=s.width-200,l=t.C2W_X(a),p=t.C2W_Y(n);return Object(Bt.jsx)("div",{style:{position:"absolute",top:i,left:c,backgroundColor:"white",opacity:.8},children:Object(Bt.jsxs)("h5",{style:{margin:0,padding:3},children:["X: ",ma(l,r,o)," Y: ",ma(p,r,o)]})})},Pa=a(65),Na=a.n(Pa),Fa=document.getElementById("modal-root"),Ua=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(e){var n;return Object(ge.a)(this,a),(n=t.call(this,e)).el=document.createElement("div"),n}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){Fa.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){Fa.removeChild(this.el)}},{key:"render",value:function(){return r.a.createPortal(this.props.children,this.el)}}]),a}(yt.Component),Ba=a(47),Wa=a.n(Ba),Ya=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onBackDropClicked=function(t){"backDrop"===t.target.id&&e.props.closePopup()},e.handleKeyDown=function(t){"Escape"===t.code&&e.props.closePopup()},e.elementDrag=function(t){t=t||window.event,e.offsetX=e.dragX-t.clientX,e.offsetY=e.dragY-t.clientY,e.dragX=t.clientX,e.dragY=t.clientY;var a=t.target;a.style.top=a.offsetTop-e.offsetY+"px",a.style.left=a.offsetLeft-e.offsetX+"px"},e.closeDragElement=function(e){e.target.onmouseup=null,e.target.onmousemove=null},e.dragMouseDown=function(t){t=t||window.event,e.dragX=t.clientX,e.dragY=t.clientY,t.target.onmouseup=e.closeDragElement,t.target.onmousemove=e.elementDrag},e}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return this.props.showPopup?Object(Bt.jsx)(Ua,{children:Object(Bt.jsx)("div",{id:"backDrop",className:Wa.a.BackDrop,onClick:this.onBackDropClicked,children:Object(Bt.jsxs)("div",{className:Wa.a.ModalPopup,onMouseDown:this.dragMouseDown,children:[Object(Bt.jsx)("header",{children:this.props.header}),this.props.children]})})}):null}}]),a}(yt.Component),Ra=function(e){return Object(Bt.jsx)(Ya,{showPopup:e.showAboutPopup,closePopup:e.toggleAboutPopup,header:"Info",children:Object(Bt.jsxs)("div",{className:Na.a.AboutPopup,children:[Object(Bt.jsxs)("h2",{children:[e.title," v",e.version]}),Object(Bt.jsx)("label",{children:"Build date: "}),Object(Bt.jsx)("span",{children:"02/10/2021"}),Object(Bt.jsx)("br",{}),Object(Bt.jsx)("label",{children:"Github depository: "}),Object(Bt.jsx)("a",{href:"https://github.com/alexbol99/debug-viewer1",children:"https://github.com/alexbol99/debug-viewer1"}),Object(Bt.jsx)("br",{}),Object(Bt.jsx)("label",{children:"3d party graphics library: "}),Object(Bt.jsx)("a",{href:"https://github.com/CreateJS/EaselJS/tree/2.0",children:"https://github.com/CreateJS/EaselJS/tree/2.0"}),Object(Bt.jsx)("br",{})]})})},Xa=a(66),za=a.n(Xa);function Ha(e,t){e.startElement("point"),e.writeAttribute("x",t.geom.x),e.writeAttribute("y",t.geom.y),e.writeAttribute("label",t.label),e.endElement()}function Va(e,t){e.startElement("segment"),e.writeAttribute("xs",t.geom.ps.x),e.writeAttribute("ys",t.geom.ps.y),e.writeAttribute("xe",t.geom.pe.x),e.writeAttribute("ye",t.geom.pe.y),e.writeAttribute("label",t.label),e.endElement()}function qa(e,t){e.startElement("arc"),e.writeAttribute("xs",Math.round(t.geom.start.x)),e.writeAttribute("ys",Math.round(t.geom.start.y)),e.writeAttribute("xe",Math.round(t.geom.end.x)),e.writeAttribute("ye",Math.round(t.geom.end.y)),e.writeAttribute("xc",t.geom.center.x),e.writeAttribute("yc",t.geom.center.y),e.writeAttribute("cw",t.geom.counterClockwise===ye.d?"yes":"no"),e.writeAttribute("label",t.label),e.endElement()}function Ga(e,t){e.startElement("circle"),e.writeAttribute("xc",t.geom.center.x),e.writeAttribute("yc",t.geom.center.y),e.writeAttribute("label",t.label),e.endElement()}function Ka(e,t){e.startElement("profile");var a,n=Object(me.a)(t.faces);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.orientation()===ye.i.CW?e.startElement("island"):e.startElement("hole"),e.writeAttribute("n_edges","".concat(r.size));var o,s=Object(me.a)(r);try{for(s.s();!(o=s.n()).done;){var i=o.value;e.startElement("edge");var c=i.shape;c instanceof ye.m?(e.writeAttribute("type","segment"),e.writeAttribute("xs",c.ps.x),e.writeAttribute("ys",c.ps.y),e.writeAttribute("xe",c.pe.x),e.writeAttribute("ye",c.pe.y)):i.shape instanceof ye.a?(e.writeAttribute("type","curve"),e.writeAttribute("xs",Math.round(c.start.x)),e.writeAttribute("ys",Math.round(c.start.y)),e.writeAttribute("xe",Math.round(c.end.x)),e.writeAttribute("ye",Math.round(c.end.y)),e.writeAttribute("xc",c.center.x),e.writeAttribute("yc",c.center.y),e.writeAttribute("cw",c.counterClockwise===ye.d?"yes":"no")):e.writeAttribute("type","unknown"),e.endElement()}}catch(l){s.e(l)}finally{s.f()}e.endElement()}}catch(l){n.e(l)}finally{n.f()}e.endElement()}function Qa(e){var t=new za.a(!0);t.startDocument("1.0","UTF-8"),t.startElement("shapes"),t.startElement("title").text("test polygon in xml format").endElement();var a,n=Object(me.a)(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.geom instanceof ye.k?Ha(t,r):r.geom instanceof ye.m?Va(t,r):r.geom instanceof ye.a?qa(t,r):r.geom instanceof ye.e?Ga(t,r):r.geom instanceof ye.b||r.geom instanceof ye.l&&Ka(t,r.geom)}}catch(o){n.e(o)}finally{n.f()}return t.endDocument(),t.toString()}var Ja=a(67),Za=a.n(Ja),$a=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"render",value:function(){var e=this.props.showPopup?this.props.layers.map((function(e){return e.displayed?{filename:"".concat(e.name,".xml"),xmlString:Qa(e.shapes)}:null})):[];return this.props.showPopup&&this.props.layers.length>0?Object(Bt.jsx)(Ya,{showPopup:this.props.showPopup,closePopup:this.props.closePopup,header:"Download files",children:Object(Bt.jsxs)("div",{className:Za.a.DownloadPopup,children:[Object(Bt.jsx)("h5",{children:"Click to the following links to start download"}),Object(Bt.jsx)("ul",{children:e.map((function(e){return null===e?null:Object(Bt.jsx)("li",{children:Object(Bt.jsx)("a",{href:"data:text/json;charset=utf-8,"+encodeURIComponent(e.xmlString),download:e.filename,children:e.filename})},e.filename)}))})]})}):null}}]),a}(yt.Component),en=document.getElementById("snackbar-root"),tn=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(e){var n;return Object(ge.a)(this,a),(n=t.call(this,e)).el=document.createElement("div"),n}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){en.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){en.removeChild(this.el)}},{key:"render",value:function(){return r.a.createPortal(this.props.children,this.el)}}]),a}(yt.Component),an=a(68),nn=a.n(an),rn=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={display:!0},e}return Object(ve.a)(a,[{key:"animationEndHandler",value:function(){this.setState({display:!1}),this.props.onAnimationEnd()}},{key:"render",value:function(){return this.state.display?Object(Bt.jsx)(tn,{children:Object(Bt.jsx)("div",{className:nn.a.Snackbar,onAnimationEnd:this.props.onAnimationEnd,children:Object(Bt.jsx)("h3",{children:this.props.message})})}):null}}]),a}(yt.Component),on=a(32),sn=a.n(on);function cn(e){for(var t=[],a=0,n=Array.from(e);a<n.length;a++){var r=n[a],o=r.getAttribute("type");if("segment"===o){var s=new ye.k(parseInt(r.getAttribute("xs"),10),parseInt(r.getAttribute("ys"),10)),i=new ye.k(parseInt(r.getAttribute("xe"),10),parseInt(r.getAttribute("ye"),10));t.push(new ye.m(s,i))}if("curve"===o){var c=new ye.k(parseInt(r.getAttribute("xs"),10),parseInt(r.getAttribute("ys"),10)),l=new ye.k(parseInt(r.getAttribute("xe"),10),parseInt(r.getAttribute("ye"),10)),p=new ye.k(parseInt(r.getAttribute("xc"),10),parseInt(r.getAttribute("yc"),10)),u="no"===r.getAttribute("cw"),d=Object(ye.t)(p,c).slope,h=Object(ye.t)(p,l).slope;ye.q.Utils.EQ(d,h)&&(h=u?h+2*Math.PI:h-2*Math.PI);var f=Object(ye.t)(p,c).length;t.push(new ye.a(p,f,d,h,u))}}return t}function ln(e){var t=new ye.l,a=e.getAttribute("color");t.style={stroke:a||void 0,fill:a||void 0,alpha:1};var n=e.getAttribute("label");t.label=n;for(var r=e.getElementsByTagName("island"),o=0,s=Array.from(r);o<s.length;o++){var i=s[o].getElementsByTagName("edge");t.addFace(cn(i))}for(var c=e.getElementsByTagName("hole"),l=0,p=Array.from(c);l<p.length;l++){var u=p[l].getElementsByTagName("edge");t.addFace(cn(u))}return t}function pn(e){var t=new ye.k(parseInt(e.getAttribute("xs"),10),parseInt(e.getAttribute("ys"),10)),a=new ye.k(parseInt(e.getAttribute("xe"),10),parseInt(e.getAttribute("ye"),10)),n=new ye.m(t,a),r=e.getAttribute("label");return n.label=r,n}function un(e){var t=new ye.k(parseInt(e.getAttribute("xs"),10),parseInt(e.getAttribute("ys"),10)),a=new ye.k(parseInt(e.getAttribute("xe"),10),parseInt(e.getAttribute("ye"),10)),n=new ye.k(parseInt(e.getAttribute("xc"),10),parseInt(e.getAttribute("yc"),10)),r="no"===e.getAttribute("cw"),o=Object(ye.t)(n,t).slope,s=Object(ye.t)(n,a).slope;ye.q.Utils.EQ(o,s)&&(s=r?s+2*Math.PI:s-2*Math.PI);var i=Object(ye.t)(n,t).length,c=new ye.a(n,i,o,s,r),l=e.getAttribute("label");return c.label=l,c}function dn(e){var t=new ye.k(parseInt(e.getAttribute("x"),10),parseInt(e.getAttribute("y"),10)),a=e.getAttribute("label");return t.label=a,t}function hn(e){var t=new ye.q.Image;return t.center=new ye.k(parseInt(e.getAttribute("xc"),10),parseInt(e.getAttribute("yc"),10)),t.width=parseInt(e.getAttribute("width"),10),t.height=parseInt(e.getAttribute("height"),10),t.uri=e.getAttribute("uri"),t}ye.q.Image=function(){function e(){Object(ge.a)(this,e),this.uri="",this.center=new ye.q.Point,this.width=0,this.height=0}return Object(ve.a)(e,[{key:"box",get:function(){return new ye.q.Box(this.center.x-this.width/2,this.center.y-this.height/2,this.center.x+this.height/2,this.center.y+this.height/2)}}]),e}();function fn(e){return Math.round(1016e4*Number(e),0)}function mn(e){return Math.round(10160*Number(e),0)}function gn(e,t){for(var a,n,r=[],o=t,s=e[o],i=s.split(" "),c=new ye.k(fn(i[1]),fn(i[2])),l=!1;;){switch((i=(s=e[o]).split(" "))[0]){case"OS":a=new ye.k(fn(i[1]),fn(i[2])),r.push(new ye.m(c,a)),c=a.clone();break;case"OC":a=new ye.k(fn(i[1]),fn(i[2])),n=new ye.k(fn(i[3]),fn(i[4]));var p="Y"===i[5]?ye.q.CW:ye.q.CCW,u=Object(ye.t)(n,c).slope,d=Object(ye.t)(n,a).slope;ye.n.EQ(u,d)&&(d+=2*Math.PI,p=!0);var h=Object(ye.t)(n,c).length;r.push(new ye.a(n,h,u,d,p)),c=a.clone();break;case"OE":l=!0}if(l)break;o++}return r}function vn(e,t){var a=e.split(" "),n=new ye.k(fn(a[1]),fn(a[2])),r=new ye.k(fn(a[3]),fn(a[4])),o=new ye.m(n,r),s=t[Number(a[5])];return o.aperture=s,o}function yn(e,t){var a=e.split(" "),n=new ye.k(fn(a[1]),fn(a[2])),r=new ye.k(fn(a[3]),fn(a[4])),o=new ye.k(fn(a[5]),fn(a[6])),s="Y"===a[10]?ye.q.CW:ye.q.CCW,i=Object(ye.t)(o,n).slope,c=Object(ye.t)(o,r).slope;ye.q.Utils.EQ(i,c)&&(c+=2*Math.PI,s=!0);var l=Object(ye.t)(o,n).length,p=new ye.a(o,l,i,c,s),u=t[Number(a[7])];return p.aperture=u,p}function bn(e){var t=Number(e);return Math.round(25.500025*t*400,0)}function On(e){return Math.round(400*Number(e),0)}function jn(e,t){var a=new Me;a.filename=e;var n=(new Ue).parse(t);if(n.length>0){var r,o=Object(me.a)(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;a.shapes.push(s)}}catch(i){o.e(i)}finally{o.f()}}return a}var wn=function(e,t,a,n,r,o){var s=new Promise((function(s,i){e.onload=function(e,t,a,n,r,o,s){return function(s){var i,c=s.target.result,l=e.name.split("."),p=l[l.length-1];if("xml"===p)i=function(e,t){var a=new Me;a.filename=e;var n=(new DOMParser).parseFromString(t,"text/xml"),r=n.getElementsByTagName("title");r&&r.length>0&&(a.title=r[0].firstChild.nodeValue);for(var o=n.getElementsByTagName("profile"),s=0,i=Array.from(o);s<i.length;s++){var c=ln(i[s]);a.profiles.push(c)}for(var l=n.getElementsByTagName("material"),p=0,u=Array.from(l);p<u.length;p++){var d=ln(u[p]);a.materials.push(d)}for(var h=n.getElementsByTagName("segment"),f=0,m=Array.from(h);f<m.length;f++){var g=pn(m[f]);a.shapes.push(g)}for(var v=n.getElementsByTagName("curve"),y=0,b=Array.from(v);y<b.length;y++){var O=un(b[y]);a.shapes.push(O)}for(var j=n.getElementsByTagName("point"),w=0,S=Array.from(j);w<S.length;w++){var k=dn(S[w]);a.shapes.push(k)}for(var x=n.getElementsByTagName("picture"),_=0,A=Array.from(x);_<A.length;_++){var E=hn(A[_]);a.shapes.push(E)}return a}(e.name,c);else if("csv"===p)i=function(e,t){var a=new Me;a.filename=e;for(var n=t.match(/[^\r\n]+/g),r=0;r<n.length;r++){var o=n[r].split(","),s=On(o[0]),i=On(o[1]),c=Number(o[2]),l=Number(o[3]),p=Object(ye.r)(s,i);p.nx=c,p.ny=l,a.shapes.push(p)}return a}(e.name,c);else if("txt"===p)i=jn(e.name,c);else if("json"===p)i=ut(e.name,c);else if("cdbg"===p)i=Fe(e.name,c);else{var u=c.match(/[^\r\n]+/g);i=1===u[0].length&&"N"===u[0]?Fe(e.name,c):function(e,t){var a=new Me;a.filename=e;for(var n,r=t.match(/[^\r\n]+/g),o=[],s=0;s<r.length;s++){var i=r[s],c=i.split(" ");if("$"!==c[0].substr(0,1))switch(c[0]){case"S":n=new ye.l;var l=i.split(" ")[1];n.polarity=l;break;case"OB":var p=s,u=gn(r,p);n.addFace(u),s=p+u.length+1;break;case"SE":a.shapes.push(n);break;case"L":var d=vn(i,o);a.shapes.push(d);break;case"A":var h=yn(i,o);a.shapes.push(h)}else{var f=Number(c[0].substr(1)),m=mn(c[1].substr(1));o[f]=m}}return a}(e.name,c)}var d=Ve.newLayer(t,a);""!==e.name&&(d.name=e.name),d.title=i.title;var h,f=Object(me.a)(i.profiles);try{for(f.s();!(h=f.n()).done;){var m=h.value;if(m.edges.size>0&&m.faces.size>0){var g=new Xe(m,void 0,m.label);d.add(g)}}}catch(x){f.e(x)}finally{f.f()}var v,y=Object(me.a)(i.materials);try{for(y.s();!(v=y.n()).done;){var b=v.value;if(b.edges.size>0&&b.faces.size>0){var O=new Xe(b,void 0,b.label);d.add(O)}}}catch(x){y.e(x)}finally{y.f()}var j,w=Object(me.a)(i.shapes);try{for(w.s();!(j=w.n()).done;){var S=j.value,k=new Xe(S,void 0,S.label);d.add(k)}}catch(x){w.e(x)}finally{w.f()}e===r[0]&&(Ve.setAffected(a,d),d.color=Ve.getNextColor(a),d.displayed=!0,n({type:T,stage:t,shape:d})),n({type:N,layer:d}),n({type:$}),o(!0)}}(t,a,n,r,o,s),e.readAsText(t)}));return r({type:Z}),s},Sn=function(e,t,a,n,r,o){return new Promise((function(s,i){e.addEventListener("load",(function(){var e=function(e){var t={},a=e.name.split("_"),n=a[0].substr(1),r=a[1]?a[1].substr(1):void 0,o=isNaN(r)?0:bn(r)+9e4,s=isNaN(n)?0:bn(n)-4e4;return t.center=new ye.k(o,s),t.width=1212120,t.box=new ye.b(t.center.x-t.width/2,t.center.y-t.width/2,t.center.x+t.width/2,t.center.y+t.width/2),t}(t);e.uri=this.result;var i=new Xe(e),c=Ve.newLayer(a,n);""!==t.name&&(c.name=t.name),c.add(i),t===o[0]&&(Ve.setAffected(n,c),c.color=Ve.getNextColor(n),c.displayed=!0,r({type:T,stage:a,shape:c})),r({type:N,layer:c}),r({type:$}),s(!0)}),!1),e.readAsDataURL(t)}))},kn=function(e,t,a,n,r){if(""===e.type||e.type.match("text.*")||e.type.match("application.*")||e.type.match("image.*")){var o=new FileReader;return e.type.match("text.*")||e.type.match("application.*")||e.name.match("features*")||e.name.includes(".cdbg")?wn(o,e,t,a,n,r):e.type.match("image.*")?Sn(o,e,t,a,n,r):Promise.reject("not supported file")}},xn=function(e,t,a){return function(n){n(xt());for(var r=[],o=0,s=Array.from(e);o<s.length;o++){var i=s[o],c=kn(i,t,a,n,e);r.push(c)}return Promise.all(r).then((function(e){n(_n(e))})).catch((function(e){alert(e.message),n(_t())}))}},_n=function(e){return{type:V,uploadedFiles:e}},An=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).inputElement=Object(yt.createRef)(),e.clipboardWindowRef=Object(yt.createRef)(),e.clipboardWindowWidth=0,e.clipboardWindowHeight=0,e.state={dragOver:!1,clipboardData:""},e.openFilesButtonClicked=function(){return e.inputElement.current.click()},e.pasteHandler=function(t){t.stopPropagation(),e.props.onPaste(t.clipboardData),t.clipboardData.items[0].getAsString((function(t){return e.setState({clipboardData:t})}))},e.dropHandler=function(t){t.preventDefault();var a=[];if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)if("file"===t.dataTransfer.items[n].kind){var r=t.dataTransfer.items[n].getAsFile();a.push(r)}}else a=t.dataTransfer.files;e.props.readFiles(a,e.props.stage,e.props.layers),e.setState({dragOver:!1})},e.dragOverHandler=function(t){t.preventDefault(),e.setState({dragOver:!0})},e.dragLeaveHandler=function(t){t.preventDefault(),e.setState({dragOver:!1})},e.filesSelectedHandler=function(t){if(File&&FileReader&&FileList){var a=t.target.files;e.props.readFiles(a,e.props.stage,e.props.layers)}},e.closePopup=function(){e.props.initUploadState(),e.props.closePopup()},e}return Object(ve.a)(a,[{key:"componentDidUpdate",value:function(){this.props.uploadCompleted}},{key:"componentDidMount",value:function(){this.clipboardWindowWidth=this.clipboardWindowRef.current.clientWidth,this.clipboardWindowHeight=this.clipboardWindowRef.current.clientHeight}},{key:"render",value:function(){var e=""===this.state.clipboardData?30:0,t=""===this.state.clipboardData?60:0,a="";if(""!==this.state.clipboardData&&(a="Added 1 layer"),this.props.uploadCompleted&&this.props.uploadedFiles.length>0){var n=this.props.uploadedFiles.length;1===n&&(a="1 layer added"),n>1&&(a="".concat(n," layers added"))}return this.props.showPopup?Object(Bt.jsx)(Ya,{showPopup:this.props.showPopup,closePopup:this.closePopup,header:"Open files",children:Object(Bt.jsxs)("div",{className:sn.a.UploadPopup,children:[Object(Bt.jsx)("div",{className:this.state.dragOver?"".concat(sn.a.UploadTarget," ").concat(sn.a.UploadTargetDragOver):"".concat(sn.a.UploadTarget," ").concat(sn.a.UploadTargetDragLeave),style:{paddingLeft:e,paddingRight:e,paddingTop:t,paddingBottom:t},onPaste:this.pasteHandler,onDrop:this.dropHandler,onDragOverCapture:this.dragOverHandler,onDragLeaveCapture:this.dragLeaveHandler,ref:this.clipboardWindowRef,children:""===this.state.clipboardData?Object(Bt.jsx)("span",{children:"Drop files here"}):Object(Bt.jsx)("p",{style:{width:this.clipboardWindowWidth,height:this.clipboardWindowHeight},children:this.state.clipboardData})}),Object(Bt.jsx)("h2",{children:"or"}),Object(Bt.jsx)("button",{onClick:this.openFilesButtonClicked,children:"Use system Open Dialog"}),Object(Bt.jsx)("input",{style:{display:"none"},type:"file",ref:this.inputElement,name:"files[]",multiple:!0,onChange:this.filesSelectedHandler}),""!==a?Object(Bt.jsx)(rn,{onAnimationEnd:this.props.initUploadState,message:a}):null]})}):null}}]),a}(yt.Component),En=Object(s.b)((function(e){return{layers:e.layers,stage:e.app.stage,uploadCompleted:e.upload.uploadCompleted,uploadedFiles:e.upload.uploadedFiles}}),(function(e){return{readFiles:function(t,a,n){return e(xn(t,a,n))},initUploadState:function(){return e({type:q})}}}))(An),Cn=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={done:!1},e}return Object(ve.a)(a,[{key:"componentDidUpdate",value:function(){this.props.stage&&!this.state.done&&(this.props.fetchDocumentFromDatabase(this.props.stage,this.props.match.params.id),this.setState({done:!0}))}},{key:"render",value:function(){return null}}]),a}(yt.Component),Ln=Object(s.b)((function(e){return{stage:e.app.stage}}),(function(e){return{fetchDocumentFromDatabase:function(t,a){return e(It(t,a))}}}))(Cn),Dn=a(69),In=a.n(Dn),Mn=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).setHomeView=function(){var t=Ve.getAffected(e.props.layers);t&&(e.props.setHomeView(e.props.stage,t),e.forceUpdate())},e.onSaveDocumentButtonClicked=function(){if(0!==e.props.layers.length){var t=null;try{t=e.props.stage.toDataURL()}catch(n){console.log(n)}var a={name:""===e.props.document.name?Dt(e.props.documentsList):e.props.document.name,dataURL:t,lastUpdated:(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString(),userId:e.props.userId};e.props.document.id?e.props.updateDocumentInDatabase(e.props.document.id,a,e.props.layers):e.props.addDocumentToDatabase(a,e.props.layers,e.props.history)}},e.clearCurrentDocument=function(){var t;e.props.clearCurrentDocument(),e.props.clearAllLayers(),null===(t=e.props.history)||void 0===t||t.push("/")},e.handleKeyDown=function(t){if("mainCanvas"===t.target.id)switch(t.code){case"KeyH":e.setHomeView();break;case"KeyW":e.props.toggleWidthMode();break;case"KeyE":e.props.toggleDisplayVertices()}},e.handlePaste=function(t){"CANVAS"===t.currentTarget.activeElement.tagName&&(t.stopPropagation(),e.props.pasteDataFromBuffer(t.clipboardData))},e}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){window.onresize=this.props.resizeStage,document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp),document.addEventListener("paste",this.handlePaste)}},{key:"render",value:function(){var e=this.props.stage?Object(Bt.jsx)(Ta,{stage:this.props.stage,units:this.props.units,divisor:this.props.divisor,decimals:this.props.decimals,coordX:this.props.mouse.x,coordY:this.props.mouse.y},"displayCoordinatedTool"):null,t=this.props.measurePointsActive?Object(Bt.jsx)(Ia,{}):null,a=this.props.measureShapesTool.firstMeasuredShape&&this.props.measureShapesTool.secondMeasuredShape&&this.props.measureShapesTool.firstMeasuredLayer.displayed&&this.props.measureShapesTool.secondMeasuredLayer.displayed,n=this.props.measureShapesTool.distance&&this.props.measureShapesTool.shortestSegment&&a?Object(Bt.jsx)(Ma,{stage:this.props.stage,firstMeasuredShape:this.props.measureShapesTool.firstMeasuredShape,secondMeasuredShape:this.props.measureShapesTool.secondMeasuredShape,firstMeasuredLayer:this.props.measureShapesTool.firstMeasuredLayer,secondMeasuredLayer:this.props.measureShapesTool.secondMeasuredLayer,distance:this.props.measureShapesTool.distance,shortestSegment:this.props.measureShapesTool.shortestSegment,divisor:this.props.divisor,decimals:this.props.decimals},"MeasureShapesTool"):null;return Object(Bt.jsxs)("main",{className:In.a["Main-content"],children:[Object(Bt.jsx)(Vt,{measurePointsActive:this.props.measurePointsActive,units:this.props.units,showSkeletonRecognitionButton:this.props.showSkeletonRecognitionButton,onShowUploadPopupPressed:this.props.toggleUploadPopup,onLayerListButtonClicked:this.props.toggleLayerList,onSortLayersButtonClicked:this.props.sortLayersList,onShowDownloadPopupPressed:this.props.toggleDownloadPopup,onClearAllButtonClicked:this.clearCurrentDocument,onHomeButtonPressed:this.setHomeView,onPanByDragPressed:this.props.togglePanByDrag,onMeasurePointsButtonPressed:this.props.toggleMeasureBetweenPoints,onMeasureBetweenShapesButtonPressed:this.props.toggleMeasureBetweenShapes,onToggleWidthModePressed:this.props.toggleWidthMode,onToggleVerticesPressed:this.props.toggleDisplayVertices,onToggleLabelsPressed:this.props.toggleDisplayLabels,onShowAboutPopupPressed:this.props.toggleAboutPopup,onSkeletonRecognitionButtonPressed:this.props.applySkeletonRecognition,onUnitClicked:this.props.toggleUnits,onSaveDocumentButtonClicked:this.onSaveDocumentButtonClicked}),Object(Bt.jsx)(ea,{}),this.props.stage?Object(Bt.jsxs)(ra,{stage:this.props.stage,onStageUnmounted:this.props.destroyStage,children:[Object(Bt.jsx)(La,{layers:this.props.layers}),e,t,n]}):null,Object(Bt.jsx)(na,{}),this.props.showAboutPopup?Object(Bt.jsx)(Ra,{showAboutPopup:this.props.showAboutPopup,toggleAboutPopup:this.props.toggleAboutPopup,title:this.props.title,version:this.props.version,build:this.props.build}):null,this.props.showDownloadPopup?Object(Bt.jsx)($a,{showPopup:this.props.showDownloadPopup,closePopup:this.props.toggleDownloadPopup,title:"Download document",layers:this.props.layers}):null,this.props.showUploadPopup?Object(Bt.jsx)(En,{showPopup:this.props.showUploadPopup,closePopup:this.props.toggleUploadPopup,title:"Upload files",onPaste:this.props.pasteDataFromBuffer}):null,Object(Bt.jsx)(Ot.a,{path:"/documents/:id",component:Ln})]})}}]),a}(yt.Component),Tn=Object(s.b)((function(e,t){return{stage:e.app.stage,title:e.app.title,version:e.app.version,build:e.app.build,displayVertices:e.app.displayVertices,displayLabels:e.app.displayLabels,widthOn:e.app.widthOn,zoomFactor:e.app.zoomFactor,units:e.app.units,showSkeletonRecognitionButton:e.app.showSkeletonRecognitionButton,divisor:e.app.divisor,decimals:e.app.decimals,measurePointsActive:e.app.measurePointsActive,showAboutPopup:e.app.showAboutPopup,showDownloadPopup:e.app.showDownloadPopup,showUploadPopup:e.app.showUploadPopup,layers:e.layers,mouse:e.mouse,measureShapesTool:e.measureShapesTool,document:e.cloudStorage.document,documentsList:e.cloudStorage.documentsList,token:e.auth.token,userId:e.auth.userId}}),(function(e){return{resizeStage:function(){return e({type:u})},destroyStage:function(){return e({type:d})},setHomeView:function(t,a){return e(kt(t,a))},toggleUnits:function(){return e({type:v})},toggleWidthMode:function(){return e({type:y})},toggleDisplayVertices:function(){return e({type:b})},toggleDisplayLabels:function(){return e({type:O})},toggleAboutPopup:function(){return e({type:g})},toggleMeasureBetweenPoints:function(){return e({type:f})},toggleMeasureBetweenShapes:function(){return e({type:m})},togglePanByDrag:function(){return e({type:h})},toggleLayerList:function(){return e({type:j})},toggleDownloadPopup:function(){return e({type:w})},toggleUploadPopup:function(){return e({type:S})},applySkeletonRecognition:function(){return e({type:J})},pasteDataFromBuffer:function(t){return e(function(e){return{type:G,data:e}}(t))},sortLayersList:function(){return e({type:U})},clearAllLayers:function(){return e(Ct())},addDocumentToDatabase:function(t,a,n){return e(Mt(t,a,n))},updateDocumentInDatabase:function(t,a,n){return e(Tt(t,a,n))},clearCurrentDocument:function(){return e({type:ie})}}}))(Mn),Pn=a(70),Nn=a.n(Pn),Fn=function(e){return Object(Bt.jsxs)("div",{className:Nn.a["Layer-list-toolbar"],children:[Object(Bt.jsx)(Wt,{type:"trigger",title:"Edit selected layer's name and info",iconName:"pencil-alt",onClick:e.onEditLayerButtonClicked}),Object(Bt.jsx)(Wt,{type:"trigger",title:"Delete selected layer",iconName:"trash-alt",onClick:e.onDeleteLayerButtonClicked})]})},Un=a(71),Bn=a.n(Un),Wn=function(e){var t=function(t){if(!t)return!1;t.stopPropagation(),t.preventDefault();var a=t.currentTarget[0].value,n=t.currentTarget[1].value,r=Object.assign({},e.layer,{name:a,title:n});return e.onSubmitLayerEditForm(r),!1},a=function(e){e.stopPropagation(),e.target.focus()};return Object(Bt.jsxs)("form",{className:Bn.a["Layer-edit-form"],id:"layerEditForm",action:"",onSubmit:t,onMouseMove:function(e){e.stopPropagation()},children:[Object(Bt.jsxs)("article",{children:[Object(Bt.jsx)("label",{children:"Name:"}),Object(Bt.jsx)("input",{type:"text",id:"layer-name",name:"layerName",defaultValue:e.layer.name,onClick:a})]}),Object(Bt.jsxs)("article",{children:[Object(Bt.jsx)("label",{children:"Description:"}),Object(Bt.jsx)("textarea",{id:"layer-title",name:"layerTitle",cols:"70",rows:"3",defaultValue:e.layer.title,onClick:a})]}),Object(Bt.jsx)("input",{type:"submit",style:{display:"none"}}),Object(Bt.jsx)("button",{onClick:function(t){e.onEscapeLayerEditForm()},children:"Cancel"}),Object(Bt.jsx)("button",{onClick:function(e){return t(e.target.parent)},children:"OK"})]})},Yn=a(36),Rn=a.n(Yn),Xn=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"componentDidUpdate",value:function(){if("CANVAS"!==document.activeElement.nodeName){var e=this.refs.layerName;this.props.layer.affected&&e.focus()}}},{key:"rgba",value:function(e,t){var a,n,r,o;return e?(e=e.replace("#",""),a=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16),o=t):(a=147,n=128,r=108,o=0),"rgba(".concat(a,",").concat(n,",").concat(r,",").concat(o/100,")")}},{key:"render",value:function(){var e=this.props.layer.displayed?"Layer-displayed":"Layer-undisplayed",t=e?this.rgba(this.props.layer.color,100):this.rgba(),a=e?this.rgba(this.props.layer.color,30):this.rgba(),n=this.props.layer.affected?1:0,r=0===this.props.layer.shapes.length?.6:1;return[Object(Bt.jsxs)("li",{className:Rn.a.Layer,onClick:this.props.onLayerClicked,onDoubleClick:this.props.onLayerDoubleClicked,children:[Object(Bt.jsx)("div",{className:Rn.a.LayerSelectionBox,onClick:this.props.onAffectedBoxClicked,children:Object(Bt.jsx)("h4",{className:Rn.a.LayerSelectionMark,style:{opacity:n,color:t},children:"\u2713"})}),Object(Bt.jsx)("div",{className:Rn.a.LayerNameBox,style:{backgroundColor:a,opacity:r},children:Object(Bt.jsx)("h4",{ref:"layerName",title:this.props.layer.title,tabIndex:"1",children:this.props.layer.name})})]},1),Object(Bt.jsx)(Ya,{showPopup:this.props.layer.edited,closePopup:this.props.onEscapeLayerEditForm,header:"Layer properties",children:Object(Bt.jsx)(Wn,{layer:this.props.layer,onSubmitLayerEditForm:this.props.onSubmitLayerEditForm,onEscapeLayerEditForm:this.props.onEscapeLayerEditForm})},2)]}}]),a}(yt.Component),zn=a(50),Hn=a.n(zn),Vn=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).height=0,e.handleKeyDown=function(t){if(t.target.parentElement.parentElement&&t.target.parentElement.parentElement.parentElement&&t.target.parentElement.parentElement.parentElement.id&&"layersList"===t.target.parentElement.parentElement.parentElement.id)switch(t.code){case"ArrowRight":case"ArrowDown":e.props.setAffectedNextLayer();break;case"ArrowLeft":case"ArrowUp":e.props.setAffectedPrevLayer()}},e.onLayerListClicked=function(){e.forceUpdate()},e}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){this.height=this.refs.layersComponent.clientHeight}},{key:"render",value:function(){var e=this,t=this.props.showLayerList?Hn.a["App-layers-displayed"]:Hn.a["App-layers"];return Object(Bt.jsxs)("div",{className:t,ref:"layersComponent",onClick:this.onLayerListClicked,children:[Object(Bt.jsx)(Fn,{onEditLayerButtonClicked:this.props.onEditLayerButtonClicked,onDeleteLayerButtonClicked:this.props.onDeleteLayerButtonClicked,onSortLayersButtonClicked:this.props.onSortLayersButtonClicked}),Object(Bt.jsx)("ul",{id:"layersList",style:{maxHeight:.82*(this.height-40)},children:this.props.layers.map((function(t){return Object(Bt.jsx)(Xn,{layer:t,onLayerClicked:function(){return e.props.onLayerClicked(t)},onAffectedBoxClicked:function(a){return e.props.onAffectedBoxClicked(a,t)},onSubmitLayerEditForm:e.props.onSubmitLayerEditForm,onEscapeLayerEditForm:e.props.onEscapeLayerEditForm},t.name)}))})]})}}]),a}(yt.Component),qn=Object(s.b)((function(e){return{layers:e.layers,stage:e.app.stage,showLayerList:e.app.showLayerList}}),(function(e){return{onEditLayerButtonClicked:function(){return e({type:Y})},onDeleteLayerButtonClicked:function(){return e({type:F})},onLayerClicked:function(t){return e(Et(t))},onAffectedBoxClicked:function(t,a){return e(function(e,t){return e.stopPropagation(),{type:W,layer:t}}(t,a))},onSubmitLayerEditForm:function(t){return e(function(e){return{type:R,newLayer:e}}(t))},onEscapeLayerEditForm:function(){return e({type:X})},setAffectedNextLayer:function(){return e({type:z})},setAffectedPrevLayer:function(){return e({type:H})}}}))(Vn),Gn=a(72),Kn=a.n(Gn),Qn=function(){return Object(Bt.jsx)("aside",{className:Kn.a["App-aside"],children:Object(Bt.jsx)("h5",{children:"\xa0"})})},Jn=Object(s.b)((function(e){var t=e.cloudStorage,a=e.auth;return{document:t.document,username:a.username}}),(function(e){return{pasteDataFromBuffer:function(t){return e({type:G,data:t.clipboardData})},updateDocumentName:function(t){return e(function(e){return{type:se,name:e}}(t))}}}))((function(e){return Object(Bt.jsx)(bt.a.Fragment,{children:Object(Bt.jsxs)("div",{className:"App-body",onPaste:e.pasteDataFromBuffer,children:[Object(Bt.jsx)(Tn,{history:e.history,onManageCloudStorageButtonClicked:e.onManageCloudStorageButtonClicked}),Object(Bt.jsx)(qn,{}),Object(Bt.jsx)(Qn,{})]})})})),Zn=a(51),$n=a.n(Zn),er=Object(Ot.f)((function(e){var t="/documents"===e.location.pathname?$n.a["App-header-documents-page"]:$n.a["App-header"];return Object(Bt.jsx)("header",{className:t,children:Object(Bt.jsx)("h2",{children:e.title})})})),tr=(a(113),function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={done:!1},e}return Object(ve.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;if(this.props.stage&&!this.state.done){var t=this.props.stage,a=this.props.layers;Promise.all([wt()("https://gist.githubusercontent.com/alexbol99/e570fe783be88b556f4ca4b332da73f7/raw/741c87a7ceccdeadd9fbbac05bdfda22ebe94927/poly234.txt")]).then((function(n){for(var r=0;r<1;r++){var o=n[r],s=Ve.newLayer(t,a);s.color=Ve.getNextColor(a),s.name="poly",s.title="",s.affected=!1,s.displayed=!0;var i,c=jn(s.name,o.data),l=Object(me.a)(c.shapes);try{for(l.s();!(i=l.n()).done;){var p=i.value,u=new Xe(p,void 0,p.label);s.add(u)}}catch(d){l.e(d)}finally{l.f()}e.props.panAndZoomToShape(t,s),e.props.addNewLayer(s),e.props.asyncOperationEnded()}})).catch((function(t){console.log(t),e.props.asyncOperationEnded()})),this.setState({done:!0}),this.props.asyncOperationStarted()}}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return null}}]),a}(yt.Component)),ar=Object(s.b)((function(e){return{layers:e.layers,stage:e.app.stage}}),(function(e){return{panAndZoomToShape:function(t,a){return e({type:T,stage:t,shape:a})},addNewLayer:function(t){return e({type:N,layer:t})},asyncOperationStarted:function(){return e(xt())},asyncOperationEnded:function(){return e(_t())}}}))(tr),nr=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){this.props.applySkeletonRecognition()}},{key:"render",value:function(){return null}}]),a}(yt.Component),rr=Object(s.b)((function(e){return{layers:e.layers,stage:e.app.stage}}),(function(e){return{applySkeletonRecognition:function(){return e({type:Q})}}}))(nr),or=function(){function e(){Object(ge.a)(this,e)}return Object(ve.a)(e,null,[{key:"apply",value:function(t,a){for(var n=Number.POSITIVE_INFINITY,r=0,o=Object(be.a)(a.edges);r<o.length;r++){var s=o[r],i=e.edge2polygon(s,t);i<n&&(n=i)}return n}},{key:"edge2polygon",value:function(t,a){var n,r=t.shape.box,o=new ye.b(Number.NEGATIVE_INFINITY,r.ymin,Number.POSITIVE_INFINITY,r.ymax),s=Number.POSITIVE_INFINITY,i=a.edges.search(o),c=Object(me.a)(i);try{for(c.s();!(n=c.n()).done;){var l=n.value,p=void 0;l.shape instanceof ye.m&&t.shape instanceof ye.m?p=e.segment2segment(l.shape,t.shape):l.shape instanceof ye.a&&t.shape instanceof ye.m?p=e.segment2arc(t.shape,l.shape):l.shape instanceof ye.m&&t.shape instanceof ye.a?p=e.segment2arc(l.shape,t.shape):l.shape instanceof ye.a&&t.shape instanceof ye.a&&(p=e.arc2arc(l.shape,t.shape)),p<s&&(s=p)}}catch(u){c.e(u)}finally{c.f()}return s}},{key:"point2shape",value:function(e,t){var a,n=new ye.h(e,new ye.o(0,1)).intersect(t),r=Number.POSITIVE_INFINITY,o=Object(me.a)(n);try{for(o.s();!(a=o.n()).done;){var s=a.value,i=e.distanceTo(s),c=Object(Qe.a)(i,2),l=c[0];c[1];l<r&&(r=l)}}catch(p){o.e(p)}finally{o.f()}return r}},{key:"segment2segment",value:function(t,a){var n,r=Number.POSITIVE_INFINITY,o=Object(me.a)(t.vertices);try{for(o.s();!(n=o.n()).done;){var s=n.value,i=e.point2shape(s,a);i<r&&(r=i)}}catch(d){o.e(d)}finally{o.f()}var c,l=Object(me.a)(a.vertices);try{for(l.s();!(c=l.n()).done;){var p=c.value,u=e.point2shape(p,t);u<r&&(r=u)}}catch(d){l.e(d)}finally{l.f()}return r}},{key:"segment2arc",value:function(t,a){for(var n,r=Number.POSITIVE_INFINITY,o=new ye.o(t.start,t.end),s=0,i=[(o=o.normalize()).rotate90CCW().multiply(a.r),o.rotate90CW().multiply(a.r)];s<i.length;s++){var c=i[s],l=a.center.translate(c);l.on(a)&&(n=e.point2shape(l,t))<r&&(r=n)}var p,u=Object(me.a)(a.vertices);try{for(u.s();!(p=u.n()).done;){var d=p.value,h=e.point2shape(d,t);h<r&&(r=h)}}catch(y){u.e(y)}finally{u.f()}var f,m=Object(me.a)(t.vertices);try{for(m.s();!(f=m.n()).done;){var g=f.value,v=e.point2shape(g,a);v<r&&(r=v)}}catch(y){m.e(y)}finally{m.f()}return r}},{key:"arc2arc",value:function(t,a){var n,r=Number.POSITIVE_INFINITY,o=t.clone();if(o.r+=a.r,(n=e.point2shape(a.center,o))<r){var s=t.distanceTo(e.translateArc(a,new ye.o(-n,0))),i=Object(Qe.a)(s,2),c=i[0];i[1];ye.q.Utils.EQ_0(c)&&(r=n)}if(ye.q.Utils.GE(t.r,a.r)){var l=t.clone();if(l.r-=a.r,(n=e.point2shape(a.center,l))<r){var p=t.distanceTo(e.translateArc(a,new ye.o(-n,0))),u=Object(Qe.a)(p,2),d=u[0];u[1];ye.q.Utils.EQ_0(d)&&(r=n)}}if(ye.q.Utils.LT(t.r,a.r)){var h=a.clone();if(h.r-=t.r,(n=e.point2shape(t.center,h))<r){var f=t.distanceTo(e.translateArc(a,new ye.o(-n,0))),m=Object(Qe.a)(f,2),g=m[0];m[1];ye.q.Utils.EQ_0(g)&&(r=n)}}var v,y=Object(me.a)(t.vertices);try{for(y.s();!(v=y.n()).done;){var b=v.value,O=e.point2shape(b,a);O<r&&(r=O)}}catch(x){y.e(x)}finally{y.f()}var j,w=Object(me.a)(a.vertices);try{for(w.s();!(j=w.n()).done;){var S=j.value,k=e.point2shape(S,t);k<r&&(r=k)}}catch(x){w.e(x)}finally{w.f()}return r}},{key:"translateArc",value:function(e,t){var a=e.clone();return a.pc=a.pc.translate(t),a}},{key:"translate",value:function(e,t){var a,n=new ye.l,r=Object(me.a)(e.faces);try{for(r.s();!(a=r.n()).done;){var o,s=a.value,i=[],c=Object(me.a)(s);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(l.shape instanceof ye.m)i.push(new ye.m(l.shape.ps.translate(t),l.shape.pe.translate(t)));else if(l.shape instanceof ye.a){var p=l.shape.clone();p.pc=l.shape.pc.translate(t),i.push(p)}}}catch(u){c.e(u)}finally{c.f()}n.addFace(i)}}catch(u){r.e(u)}finally{r.f()}return n}}]),e}();or.Flatten=ye.q;var sr=or,ir=ye.q.vector,cr=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){var e;Object(ge.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={done:!1,data:[]},e}return Object(ve.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;if(this.props.stage&&!this.state.done){var t=this.props.stage,a=this.props.layers,n=Ve.newLayer(t,a);n.color=Ve.getNextColor(a),n.name="collision_demo",n.title="collision_demo",n.affected=!0,n.displayed=!0,wt()("https://gist.githubusercontent.com/alexbol99/81893d40ec5eaa00d0336c35e069dd73/raw/b9328a4c6d7d6a44f375c68b4ec207690f40fd19/Block_53388_2parts_Cont.txt").then((function(a){var r=e.props.parser.parseToPolygon(a.data);n.add(r);var o=ir(2*(r.box.xmax-r.box.xmin),0),s=r.translate(o);n.add(s);var i=sr.apply(s,r),c=s.translate(ir(-i,0));n.add(c),e.props.panAndZoomToShape(t,n),e.props.addNewLayer(n),e.props.applyCollisionDemo(),e.props.asyncOperationEnded()})),this.setState({done:!0}),this.props.asyncOperationStarted()}}},{key:"render",value:function(){return null}}]),a}(yt.Component),lr=Object(s.b)((function(e){return{layers:e.layers,stage:e.app.stage,parser:e.app.parser}}),(function(e){return{panAndZoomToShape:function(t,a){return e({type:T,stage:t,shape:a})},addNewLayer:function(t){return e({type:N,layer:t})},applyCollisionDemo:function(){return e({type:"COLLISION_DEMO_URI"})},asyncOperationStarted:function(){return e(xt())},asyncOperationEnded:function(){return e(_t())}}}))(cr),pr=a(52),ur=a.n(pr),dr=function(){return Object(Bt.jsx)(Ua,{children:Object(Bt.jsx)("div",{className:ur.a.BackDrop,children:Object(Bt.jsx)("div",{className:ur.a.Loader,children:"Loading ..."})})})},hr=function(){return{type:ce}},fr=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:le,token:e,userId:t,username:a}},mr=function(e){return{type:pe,error:e}},gr=function(){return localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),localStorage.removeItem("userId"),{type:ue}},vr=function(e){return function(t){setTimeout((function(){var e=localStorage.getItem("email"),a=localStorage.getItem("password");t(e&&a?yr(e,a):gr())}),1e3*e)}},yr=function(e,t){return function(a){a(hr());var n={email:e,password:t,returnSecureToken:!0};localStorage.setItem("email",e),localStorage.setItem("password",t);wt.a.post("https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=AIzaSyDMUAcjgolAlapdpFmPEz8SaId1DZw7MpQ",n).then((function(e){var t=new Date((new Date).getTime()+1e3*e.data.expiresIn);localStorage.setItem("token",e.data.idToken),localStorage.setItem("expirationDate",t),localStorage.setItem("userId",e.data.localId),a(fr(e.data.idToken,e.data.localId)),a(vr(e.data.expiresIn));var n="?auth="+e.data.idToken+'&orderBy="userId"&equalTo="'+e.data.localId+'"';return wt.a.get("https://debug-viewer.firebaseio.com/users.json"+n)})).then((function(e){if(Object.values(e.data.length>0)){var t=Object.values(e.data)[0].username;localStorage.setItem("username",t),a(function(e){return{type:de,username:e}}(Object.values(e.data)[0].username))}})).catch((function(e){a(mr(e.response.data.error))}))}},br=function(e){Object(gt.a)(a,e);var t=Object(vt.a)(a);function a(){return Object(ge.a)(this,a),t.apply(this,arguments)}return Object(ve.a)(a,[{key:"componentDidMount",value:function(){this.props.authCheckState()}},{key:"componentDidUpdate",value:function(){"/"===this.props.location.pathname&&void 0!==this.props.document.id&&this.props.history.push("/documents/"+this.props.document.id)}},{key:"render",value:function(){return Object(Bt.jsxs)("div",{className:"App",children:[Object(Bt.jsx)(er,{title:this.props.title,version:this.props.version,isAuthenticated:this.props.isAuthenticated,username:this.props.username}),Object(Bt.jsx)(Jn,{}),Object(Bt.jsxs)(Ot.c,{children:[Object(Bt.jsx)(Ot.a,{path:"/demo",exact:!0,component:ar}),Object(Bt.jsx)(Ot.a,{path:"/skeleton",component:rr}),Object(Bt.jsx)(Ot.a,{path:"/collision-distance",component:lr})]}),this.props.showSpinner?Object(Bt.jsx)(dr,{}):null]})}}]),a}(yt.Component),Or=Object(Ot.f)(Object(s.b)((function(e){var t=e.auth,a=e.app,n=e.cloudStorage;return{title:a.title,version:a.version,showSpinner:a.showSpinner,document:n.document,isAuthenticated:null!==t.token,username:t.username}}),(function(e){return{authCheckState:function(){return e((function(e){var t=localStorage.getItem("token");if(t){var a=localStorage.getItem("userId"),n=localStorage.getItem("username"),r=new Date(localStorage.getItem("expirationDate"));if(r>new Date){var o=r.getTime()-(new Date).getTime();e(fr(t,a,n)),e(vr(o/1e3))}else e(gr())}else e(gr())}))}}}))(br)),jr=(a(114),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.c),wr=Object(o.d)(ct,jr(Object(o.a)(lt,dt,mt,ht,i.a)));r.a.render(Object(Bt.jsx)(s.a,{store:wr,children:Object(Bt.jsx)(c.a,{basename:"",children:Object(Bt.jsx)(Or,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},27:function(e,t,a){e.exports={Button:"Button_Button__2jIAh",IconTrigger:"Button_IconTrigger__1ZVK5",IconModeActive:"Button_IconModeActive__3a3sc",IconModeNotActive:"Button_IconModeNotActive__1FMkh",DrawerButton:"Button_DrawerButton__G0-5s"}},32:function(e,t,a){e.exports={UploadPopup:"UploadPopup_UploadPopup__35HLF",fadeIn:"UploadPopup_fadeIn__348Zu",UploadTarget:"UploadPopup_UploadTarget__37z4d",UploadTargetDragLeave:"UploadPopup_UploadTargetDragLeave__2NjYn",UploadTargetDragOver:"UploadPopup_UploadTargetDragOver__pUJSi"}},36:function(e,t,a){e.exports={Layer:"LayerListElement_Layer__3alr7",LayerSelectionBox:"LayerListElement_LayerSelectionBox__3bgAu",LayerSelectionMark:"LayerListElement_LayerSelectionMark__3Rfgw",LayerNameBox:"LayerListElement_LayerNameBox__1lgBy","Layer-displayed":"LayerListElement_Layer-displayed__mybMO","Layer-undisplayed":"LayerListElement_Layer-undisplayed__b9gqr"}},45:function(e,t,a){e.exports={ButtonSeparator:"ButtonSeparator_ButtonSeparator__3Pa7n",IconSeparator:"ButtonSeparator_IconSeparator__ktns5"}},46:function(e,t,a){e.exports={"App-toolbar":"ToolbarComponent_App-toolbar__o9k3P","App-toolbar-units":"ToolbarComponent_App-toolbar-units__2ZNgZ",DrawerButton:"ToolbarComponent_DrawerButton__rCzN_"}},47:function(e,t,a){e.exports={BackDrop:"ModalPopup_BackDrop__3Cx14",ModalPopup:"ModalPopup_ModalPopup__37PlM",fadeIn:"ModalPopup_fadeIn__1EYlZ"}},50:function(e,t,a){e.exports={"App-layers":"LayersList_App-layers__2Q2Bt","App-layers-displayed":"LayersList_App-layers-displayed__2NqF3",fadeIn:"LayersList_fadeIn__1rR2t"}},51:function(e,t,a){e.exports={"App-header":"HeaderComponent_App-header__27zJv","App-header-documents-page":"HeaderComponent_App-header-documents-page__2tn0L"}},52:function(e,t,a){e.exports={BackDrop:"Spinner_BackDrop__1LoFC",Loader:"Spinner_Loader__2ryyH",load2:"Spinner_load2__3hLmw"}},61:function(e,t,a){e.exports={"App-canvas":"CanvasComponent_App-canvas__1uJfS"}},62:function(e,t,a){e.exports={"App-status-bar":"StatusComponent_App-status-bar__1rxln"}},63:function(e,t,a){e.exports={LabelsLayer:"labelsLayer_LabelsLayer__2xbAy",LabelComponent:"labelsLayer_LabelComponent__eR6m-"}},64:function(e,t,a){e.exports={VertexLabel:"VertexLabel_VertexLabel__YWRN8",fadeIn:"VertexLabel_fadeIn__2XyxX"}},65:function(e,t,a){e.exports={AboutPopup:"AboutPopup_AboutPopup__2Jpao"}},67:function(e,t,a){e.exports={DownloadPopup:"DownloadPopup_DownloadPopup__vya4z",fadeIn:"DownloadPopup_fadeIn__21JnI",Open:"DownloadPopup_Open__1Cv4S",Close:"DownloadPopup_Close__17tFZ"}},68:function(e,t,a){e.exports={Snackbar:"Snackbar_Snackbar__1scqG",fadeInOut:"Snackbar_fadeInOut__1BjdD"}},69:function(e,t,a){e.exports={"Main-content":"MainComponent_Main-content__3bs5Y"}},70:function(e,t,a){e.exports={"Layer-list-toolbar":"LayerListToolbar_Layer-list-toolbar__6uKRs"}},71:function(e,t,a){e.exports={"Layer-edit-form":"LayerEditForm_Layer-edit-form__22A0t"}},72:function(e,t,a){e.exports={"App-aside":"AsideComponent_App-aside__27Dx9"}}},[[115,1,2]]]);
//# sourceMappingURL=main.ddc400bb.chunk.js.map