{"version":3,"sources":["components/AboutPopup/AboutPopup.module.css","components/UI/ModalPopup/ModalPopup.module.css","containers/MainComponent/MainComponent.module.css","components/LayersList/LayerListToolbar/LayerListToolbar.module.css","components/LayersList/LayerEditForm/LayerEditForm.module.css","components/LayersList/LayerListElement/LayerListElement.module.css","containers/LayerList/LayersList.module.css","components/Layout/AsideComponent/AsideComponent.module.css","components/MainComponent/DocumentName/DocumentName.module.css","components/Layout/HeaderComponent/HeaderComponent.module.css","components/UI/Spinner/Spinner.module.css","store/reducers/auth.js","store/actionTypes.js","models/createArcs.js","models/polygonOffset.js","dataParsers/parser.js","store/reducers/app.js","models/model.js","models/layer.js","models/layers.js","store/reducers/layers.js","store/reducers/mouse.js","store/reducers/measureShapesTool.js","store/reducers/cloudStorage.js","store/reducer.js","axios-database.js","store/actions/appActions.js","store/actions/layersActions.js","dataParsers/parseJSON.js","store/actions/cloudStorageActions.js","components/UI/Button/Button.js","components/UI/ButtonSeparator/ButtonSeparator.js","components/MainComponent/ToolbarComponent/ToolbarComponent.js","models/stage.js","store/actions/stageActions.js","components/MainComponent/CanvasComponent/CanvasComponent.js","components/Layout/StatusComponent/StatusComponent.js","components/MainComponent/GraphicsComponent/stageComponent.js","models/graphics.js","models/utils.js","components/MainComponent/GraphicsComponent/graphics/shapeComponent.js","firebase-storage.js","components/MainComponent/GraphicsComponent/graphics/imageComponent.js","components/MainComponent/GraphicsComponent/layerComponent.js","components/MainComponent/GraphicsComponent/domelements/labelComponent.js","components/MainComponent/GraphicsComponent/LabelsLayerComponent/labelsLayerComponent.js","components/MainComponent/GraphicsComponent/layersComponent.js","tools/measurePointsTool.js","tools/measureShapesTool.js","tools/displayCoordsTool.js","components/UI/Modal.js","components/UI/ModalPopup/ModalPopup.js","components/AboutPopup/AboutPopup.js","components/Constructions/CloudDocument.js","containers/MainComponent/MainComponent.js","components/LayersList/LayerListToolbar/LayerListToolbar.js","components/LayersList/LayerEditForm/LayerEditForm.js","components/LayersList/LayerListElement/LayerListElement.js","containers/LayerList/LayersList.js","components/Layout/AsideComponent/AsideComponent.js","components/MainComponent/DocumentName/DocumentName.js","AppBody.js","components/Layout/HeaderComponent/HeaderComponent.js","models/job.js","dataParsers/parserODB.js","components/Constructions/Demo.js","components/Constructions/SkeletonRecognition.js","models/collisionDistance.js","components/Constructions/CollisionDemo.js","components/UI/Spinner/Spinner.js","store/actions/auth.js","App.js","middleware/log.js","dataParsers/parserXML.js","dataParsers/parsePGM.js","dataParsers/parseCSV.js","middleware/readFiles.js","dataParsers/parseTXT.js","middleware/pasteData.js","middleware/stageController.js","middleware/skeleton_recognition.js","Preloader.js","components/UI/Button/Button.module.css","components/UI/ButtonSeparator/ButtonSeparator.module.css","components/MainComponent/ToolbarComponent/ToolbarComponent.module.css","components/MainComponent/CanvasComponent/CanvasComponent.module.css","components/Layout/StatusComponent/StatusComponent.module.css","components/MainComponent/GraphicsComponent/LabelsLayerComponent/labelsLayer.module.css"],"names":["module","exports","AboutPopup","BackDrop","ModalPopup","fadeIn","Main-content","Layer-list-toolbar","Layer-edit-form","Layer","LayerSelectionBox","LayerSelectionMark","LayerNameBox","Layer-displayed","Layer-undisplayed","App-layers","App-layers-displayed","Open","Close","App-aside","DocumentName","App-header","App-header-documents-page","Loader","load2","initialState","token","userId","username","error","loading","auth","state","arguments","length","undefined","action","type","Object","objectSpread","arcSE","center","start","end","counterClockwise","startAngle","vector","slope","endAngle","Utils","EQ","Math","PI","r","Arc","offsetArc","arc","value","arc_cap1","arc_cap2","w","abs","polygon","Polygon","arc_outer","clone","sweep","arcStartSweep","arcEndSweep","arc_inner","pc","CW","CCW","Segment","addFace","toConsumableArray","faces","setArcLength","ips","Face","getSelfIntersections","edges","slice","edge_cap1","edge_cap2","int_points","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","Symbol","iterator","next","done","pt","addToIntPoints","err","return","int_points_sorted","getSortedArray","splitByIntersections","bv","OUTSIDE","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","int_point","edge_before","edge_after","INSIDE","op","BOOLEAN_UNION","removeNotRelevantChains","num","prev","removeOldFaces","restoreFaces","orientation","ORIENTATION","reverse","offsetSegment","seg","v_seg_unit","x","y","normalize","v_left","rotate90CCW","multiply","v_right","rotate90CW","seg_left","translate","seg_right","cap1","cap2","Parser","classCallCheck","this","createClass","key","str","arrayOfLines","match","watchArray","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","line","push","substring","indexOf","termArr","split","psArr","ps","Point","parseInt","peArr","pe","pcArr","Flatten","circle","Circle","pllArr","xmin","ymin","width","height","box","Box","segment","i","search","nedgesStr","nedges","j","parseToSegment","parseToArc","points","pointArr","point","label","shape","shapes","parseToCircle","parseToRectangle","parseToODBLine","parseToODBArc","parseToPolygon","size","parseToPoints","parseToShapes","unitsList","name","decimals","divisor","defaultAppState","title","version","process","build","units","parser","widthOn","displayVertices","displayLabels","measurePointsActive","zoomFactor","originX","originY","showAboutPopup","importDataToNewLayer","showSkeletonRecognitionButton","applySkeletonRecognition","stage","showSpinner","showLayerList","app","assign","resolution","origin","curUnitsId","findIndex","newUnits","defaultStyle","strokeStyle","stroke","fill","alpha","Model","geom","style","model","color","displayed","edited","affected","layer","newShape","add","JSON","stringify","merge","xmax","ymax","colors","Layers","layers","getNewName","defaultName","inc","comparator","find","lay","currentAffectedLayer","getAffected","_arr","_loop","col","_i","index","l","newLayers","filter","getNextColor","sort","l1","l2","name1","toUpperCase","name2","map","toJSON","newLayer","affectedLayer","affectedLayerId","concat","delete","setAffected","toggleDisplayed","setEdited","setNameAndTitle","nextLayer","newCurLayer","newNextLayer","defaultMouseState","startX","startY","touchPoints","mouse","x1","y1","x2","y2","defaultMeasureShapesTool","measureShapesActive","measureShapesFirstClick","hoveredShape","firstMeasuredShape","secondMeasuredShape","firstMeasuredLayer","secondMeasuredLayer","distance","shortestSegment","is_mobile","window","mobilecheck","measureShapesTool","shape1","shape2","_Flatten$Distance$dis","Distance","_Flatten$Distance$dis2","slicedToArray","documentDefaultState","id","owner","lastUpdated","cloudStorageDefaultState","document","documentsList","cloudStorage","_state$documentsList","newList","objectWithoutProperties","_toPropertyKey","stateDocumentsList","actionDocumentsList","keys","hasOwnProperty","isUpToDate","reducer","combineReducers","instance","axios","create","baseURL","setHomeView","addNewLayer","toggleDisplayLayer","parseJSON","models","parse","Array","faceArray","uri","Image","get","documents","values","button","props","iconStyle","classes","IconTrigger","active","IconModeActive","IconModeNotActive","buttonStyle","mobileOnly","react_default","a","createElement","onClick","className","lib_default","iconName","buttonSeparator","ButtonSeparator","IconSeparator","ToolbarComponent","openJobButtonClicked","_this","refs","browseFiles","click","Button","onLayerListButtonClicked","fontSize","marginTop","marginBottom","display","ref","multiple","onChange","onFileSelected","onClearAllButtonClicked","onHomeButtonPressed","onPanByDragPressed","onMeasurePointsButtonPressed","onMeasureBetweenShapesButtonPressed","onToggleWidthModePressed","onToggleVerticesPressed","onToggleLabelsPressed","onSkeletonRecognitionButtonPressed","onUnitClicked","onShowAboutPopupPressed","Component","Stage","canvas","possibleConstructorReturn","getPrototypeOf","call","Touch","enable","assertThisInitialized","mouseMoveOutside","enableMouseOver","clientWidth","clientHeight","oldOrigin","oldZoomFactor","pinchAnchorX","pinchAnchorY","pinchStarted","addChild","scalar","scalingFactor","canvasX","canvasY","worldX","worldY","W2C_X","W2C_Y","newOrigin","deltaX","deltaY","ratio","curRatio","min","max","focusX","focusY","bIn","C2W_X","C2W_Y","zoomIn","zoomOut","newFocusX","newFocusY","panBy","zoom","zoomByPinchStop","dx","dy","panByMouseStop","getContext","clearRect","minX","minY","maxX","maxY","CreatejsStage","handleMouseWheelMove","delta","CanvasComponent","canvasElement","React","createRef","handleMouseMove","event","focus","nativeEvent","touches","clientX","target","offsetLeft","clientY","offsetTop","handlePinchMove","stageX","stageY","handleMouseDown","handlePinchDown","handleMouseUp","stopPropagation","preventDefault","handlePinchUp","handleMouseLeave","blur","body","handleMouseWheel","detail","wheelDelta","offsetX","offsetY","handleMouseWheelFox","layerX","layerY","current","on","addEventListener","passive","registerStage","tabIndex","styles","connect","dispatch","actions","StatusComponent","StageComponent","setTransform","update","onStageUnmounted","Fragment","children","graphics","radius","Graphics","beginFill","command","drawCircle","graphics_point","ignoreScale","setStrokeStyle","beginStroke","moveTo","lineTo","endStroke","graphics_segment","graphics_arc","graphics_circle","drawRect","graphics_box","face","setGraphicsFace","graphics_polygon","setGraphicsEdge","edge","setGraphicsEdgeSegment","setGraphicsEdgeArc","first","is_equal","obj1","obj2","equal","ShapeComponent","_Component","params","handleMouseOver","onMouseOver","handleMouseOut","onMouseOut","handleClick","Shape","vertexShapes","vertices","vertex","vertexShape","mouseEnabled","inherits","isEmpty","hovered","selected","aperture","redrawVertices","redraw","nextProps","nextState","off","removeChild","clear","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","storage","ImageComponent","_getPrototypeOf2","_len","args","_key","apply","bitmap","image","naturalWidth","naturalHeight","scaleX","scaleY","tx","ty","regX","regY","_this2","img","onload","Bitmap","onImageLoaded","setAttribute","refFromURL","getDownloadURL","then","url","src","catch","console","log","loadImage","LayerComponent","imageComponent_ImageComponent","shapeComponent_ShapeComponent","labelComponent","_ref","left","top","position","LabelComponent","labelsLayerComponent","trim","domelements_labelComponent","LayersComponent","layerComponent_LayerComponent","LabelsLayerComponent_labelsLayerComponent","MeasurePointsTool","measureCanvas","measureStage","endX","endY","measureStarted","setState","cursor","draw","context","textX","textY","textWidth","backX","backY","pllX","pllY","W2C_Scalar","beginPath","rect","lineWidth","text","measurement","font","measureText","textAlign","fillStyle","globalAlpha","fillRect","textHeight","fillText","dist","sqrt","format","toFixed","removeAllChildren","removeAllEventListeners","mainCanvas","MeasureShapesTool","labelShape","Text","unscale","redrawLabel","DisplayCoordsTool","coordX","coordY","margin","padding","modalRoot","getElementById","Modal","el","appendChild","ReactDOM","createPortal","onBackDropClicked","ev","closePopup","handleKeyDown","code","elementDrag","dragX","dragY","element","closeDragElement","onmouseup","onmousemove","dragMouseDown","removeEventListener","showPopup","UI_Modal","onMouseDown","UI_ModalPopup_ModalPopup","toggleAboutPopup","href","CloudDocument","fetchDocumentFromDatabase","firstLayer","docUrl","geomUrl","Promise","all","responses","data","layerData","layerActions","requestFetchDocumentFromDatabaseSucceed","appActions","alert","message","cloudActions","MainComponent","handleFileSelect","File","FileReader","FileList","files","forceUpdate","onSaveDocumentButtonClicked","dataURL","toDataURL","e","payload","Date","toLocaleDateString","toLocaleTimeString","updateDocumentInDatabase","addDocumentToDatabase","history","clearCurrentDocument","clearAllLayers","toggleWidthMode","toggleDisplayVertices","onresize","resizeStage","handleKeyUp","displayCoordsTool","tools_displayCoordsTool","measurePointsTool","tools_measurePointsTool","measuredLayersDisplayed","tools_measureShapesTool","MainComponent_ToolbarComponent_ToolbarComponent","togglePanByDrag","toggleMeasureBetweenPoints","toggleMeasureBetweenShapes","toggleDisplayLabels","toggleUnits","toggleLayerList","MainComponent_CanvasComponent_CanvasComponent","stageComponent","destroyStage","layersComponent","handleMouseRollOverShape","handleMouseRollOutShape","handleClickOnShape","Layout_StatusComponent_StatusComponent","components_AboutPopup_AboutPopup","Route","path","component","ownProps","post","response","layersJSON","geomPayload","registerDocumentAddedToDatabase","now","put","geomId","reponse","LayerListToolbar","onAddLayerButtonClicked","onEditLayerButtonClicked","onDeleteLayerButtonClicked","onSortLayersButtonClicked","LayerEditForm","onSubmitLayerEditForm","form","parentElement","layerName","layerTitle","setFocus","onSubmit","defaultValue","cols","rows","onEscapeLayerEditForm","LayerListElement","activeElement","nodeName","elem","hex","opacity","g","b","percent","replace","rgba","bgcolor","layerNameOpacity","onLayerClicked","onDoubleClick","onLayerDoubleClicked","onAffectedBoxClicked","backgroundColor","LayersList_LayerEditForm_LayerEditForm","LayersList","setAffectedNextLayer","setAffectedPrevLayer","onLayerListClicked","LayersList_LayerListToolbar_LayerListToolbar","maxHeight","LayersList_LayerListElement_LayerListElement","AsideComponent","handleChange","updateDocumentName","shareDocument","navigator","share","location","resp","placeholder","prevState","withRouter","pasteDataFromBuffer","clipboardData","onPaste","containers_MainComponent_MainComponent","onManageCloudStorageButtonClicked","LayerList_LayersList","Layout_AsideComponent_AsideComponent","pathname","Job","filename","profiles","materials","inch2pixels","mils2pixels","InchToPixels","round","Number","MilsToPixels","parsePolygon","lines","terms","end_of_face","parseLine","apertures","ap_value","parseArc","parseODB","job","substr","polarity","odbLine","odbArc","ap_key","Demo","panAndZoomToShape","asyncOperationEnded","asyncOperationStarted","SkeletonRecognition","CollisionDistance","polygon1","polygon2","collision_distance","POSITIVE_INFINITY","edge2polygon","edge2","shapeBox","NEGATIVE_INFINITY","resp_edges","edge1","segment2segment","segment2arc","arc2arc","intersections","Line","Vector","intersect","ip","_point$distanceTo","distanceTo","_point$distanceTo2","segment1","segment2","point2shape","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","v_s","_arr2","_i2","v","tangent_point","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","arc1","arc2","arc_enlarged","_arc1$distanceTo","translateArc","_arc1$distanceTo2","dist_tmp","EQ_0","GE","arc_reduced","_arc1$distanceTo3","_arc1$distanceTo4","LT","_arc1$distanceTo5","_arc1$distanceTo6","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","vec","arc_tmp","newPolygon","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","arc_trans","CollisionDemo","collision","polygon3","applyCollisionDemo","spinner","authSucceed","authFailed","logout","localStorage","removeItem","checkAuthTimeout","expirationTime","setTimeout","email","getItem","password","logIn","authData","returnSecureToken","setItem","expirationDate","getTime","expiresIn","idToken","localId","queryParams","authSetUsername","App","authCheckState","Layout_HeaderComponent_HeaderComponent","isAuthenticated","Switch","AppBody","Spinner","timeLeft","getState","parseEdges","edgesXML","from","getAttribute","polygonsXML","islands","getElementsByTagName","holes","_arr3","_i3","parseSegment","segmentXML","parseCurve","curveXML","parsePoint","pointXML","parseImage","imageXML","pgmResolution","microns2pixels","sizeX","toPixels","micron2pixels","micronToPixels","readAsText","reader","file","theFile","string","result","namesplitted","extension","xmlDoc","DOMParser","parseFromString","titles","firstChild","nodeValue","profilesXML","_arr4","_i4","materialXML","_arr5","_i5","segmentsXML","_arr6","_i6","curvesXML","_arr7","_i7","curve","pointsXML","_arr8","_i8","imagesXML","_arr9","_i9","parseXML","px","py","nx","ny","parseCSV","shapesArray","parseTXT","readAsImage","yStr","xStr","isNaN","readAsDataURL","readFile","readFiles","pasteData","items","getAsString","stageController","resize","panByMouseStart","panByMouseMove","panToCoordinate","zoomToLimits","zoomByMouse","removeAllListeners","zoomByPinchStart","distStart","zoomByPinchMove","Algorithmia","skeleton_recognition","currentLayer","input","client","algo","pipe","output","row","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","Preloader","es","BrowserRouter","basename","src_App_0","DrawerButton","App-toolbar","App-toolbar-units","App-canvas","App-status-bar","LabelsLayer"],"mappings":"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","file":"static/js/3.ae6125de.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"AboutPopup\":\"AboutPopup_AboutPopup__1HH4R\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"BackDrop\":\"ModalPopup_BackDrop__3-oG9\",\"ModalPopup\":\"ModalPopup_ModalPopup__1AvS-\",\"fadeIn\":\"ModalPopup_fadeIn__2twM6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Main-content\":\"MainComponent_Main-content__1w1St\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Layer-list-toolbar\":\"LayerListToolbar_Layer-list-toolbar__1SOXw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Layer-edit-form\":\"LayerEditForm_Layer-edit-form__1_dNQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Layer\":\"LayerListElement_Layer__1LybR\",\"LayerSelectionBox\":\"LayerListElement_LayerSelectionBox__11__5\",\"LayerSelectionMark\":\"LayerListElement_LayerSelectionMark__20kD0\",\"LayerNameBox\":\"LayerListElement_LayerNameBox__2w-wI\",\"Layer-displayed\":\"LayerListElement_Layer-displayed__1IqeA\",\"Layer-undisplayed\":\"LayerListElement_Layer-undisplayed__37KZD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App-layers\":\"LayersList_App-layers__YRpy2\",\"App-layers-displayed\":\"LayersList_App-layers-displayed__2te6S\",\"fadeIn\":\"LayersList_fadeIn__3kAMM\",\"Open\":\"LayersList_Open__T6MJE\",\"Close\":\"LayersList_Close__oPVyy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App-aside\":\"AsideComponent_App-aside__3rrry\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"DocumentName\":\"DocumentName_DocumentName__ISiLa\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App-header\":\"HeaderComponent_App-header__2sYI1\",\"App-header-documents-page\":\"HeaderComponent_App-header-documents-page__1I9Y7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"BackDrop\":\"Spinner_BackDrop__lblJJ\",\"Loader\":\"Spinner_Loader__gneD6\",\"load2\":\"Spinner_load2__SMn6D\"};","import * as actionTypes from '../actionTypes';\r\n\r\nconst initialState = {\r\n    token: null,\r\n    userId: null,\r\n    username: null,\r\n    error: null,\r\n    loading: false\r\n};\r\n\r\nconst auth = (state=initialState, action) => {\r\n    switch (action.type) {\r\n        case actionTypes.AUTHENTICATION_STARTED:\r\n            return {\r\n                ...state,\r\n                error: null,\r\n                loading: true\r\n            };\r\n        case actionTypes.AUTHENTICATION_SUCCEED:\r\n            return {\r\n                ...state,\r\n                error: null,\r\n                token: action.token,\r\n                userId: action.userId,\r\n                username: action.username,\r\n                loading: false\r\n            };\r\n        case actionTypes.AUTHENTICATION_FAILED:\r\n            return {\r\n                ...state,\r\n                error: action.error,\r\n                token: null,\r\n                userId: null,\r\n                username: null,\r\n                loading: false\r\n            };\r\n        case actionTypes.AUTHENTICATION_LOGOUT:\r\n            return {\r\n                ...state,\r\n                token: null,\r\n                userId: null,\r\n                username: null\r\n            };\r\n        case actionTypes.AUTHENTICATION_SET_USERNAME:\r\n            return {\r\n                ...state,\r\n                username: action.username\r\n            };\r\n        default:\r\n            return state\r\n    }\r\n};\r\n\r\nexport default auth;","/**\r\n * Created by alexanderbol on 13/04/2017.\r\n */\r\nexport const NEW_STAGE_CREATED = \"NEW_STAGE_CREATED\";\r\nexport const STAGE_RESIZED = \"STAGE_RESIZED\";\r\nexport const NEW_SHAPE_PASTED = \"NEW_SHAPE_PASTED\";\r\nexport const CLEAR_ALL = \"CLEAR_ALL\";\r\nexport const STAGE_UNMOUNTED = \"STAGE_UNMOUNTED\";\r\n\r\n/** Toolbar buttons **/\r\nexport const PAN_BY_DRAG_BUTTON_CLICKED = \"PAN_BY_DRAG_BUTTON_CLICKED\";\r\n// export const SAVE_DOCUMENT_BUTTON_CLICKED = \"SAVE_DOCUMENT_BUTTON_CLICKED\";\r\nexport const MANAGE_CLOUD_STORAGE_BUTTON_CLICKED = \"MANAGE_CLOUD_STORAGE_BUTTON_CLICKED\";\r\n\r\nexport const MEASURE_POINTS_BUTTON_PRESSED = \"MEASURE_POINTS_BUTTON_PRESSED\";\r\nexport const MEASURE_SHAPES_BUTTON_PRESSED = \"MEASURE_SHAPES_BUTTON_PRESSED\";\r\nexport const TOGGLE_ABOUT_POPUP_CLICKED = \"TOGGLE_ABOUT_POPUP_CLICKED\";\r\n// export const CLOSE_ABOUT_POPUP_BUTTON_PRESSED = \"CLOSE_ABOUT_POPUP_BUTTON_PRESSED\";\r\nexport const TOGGLE_UNITS_CLICKED = \"TOGGLE_UNITS_CLICKED\";\r\nexport const TOGGLE_WIDTH_MODE_CLICKED = \"TOGGLE_WIDTH_MODE_CLICKED\";\r\nexport const TOGGLE_DISPLAY_VERTICES_CLICKED = \"TOGGLE_DISPLAY_VERTICES_CLICKED\";\r\nexport const TOGGLE_DISPLAY_LABELS_CLICKED = \"TOGGLE_DISPLAY_LABELS_CLICKED\";\r\nexport const TOGGLE_SHOW_LAYER_LIST_CLICKED = \"TOGGLE_SHOW_LAYER_LIST_CLICKED\";\r\n\r\nexport const MOUSE_MOVED_ON_STAGE = \"MOUSE_MOVED_ON_STAGE\";\r\nexport const MOUSE_DOWN_ON_STAGE = \"MOUSE_DOWN_ON_STAGE\";\r\nexport const MOUSE_UP_ON_STAGE = \"MOUSE_UP_ON_STAGE\";\r\nexport const MOUSE_WHEEL_MOVE_ON_STAGE = \"MOUSE_WHEEL_MOVE_ON_STAGE\";\r\n\r\nexport const MOUSE_ROLL_OVER_SHAPE = \"MOUSE_ROLL_OVER_SHAPE\";\r\nexport const MOUSE_ROLL_OUT_SHAPE = \"MOUSE_ROLL_OUT_SHAPE\";\r\nexport const MOUSE_CLICKED_ON_SHAPE = \"MOUSE_CLICKED_ON_SHAPE\";\r\n\r\nexport const PINCH_DOWN_ON_STAGE = \"PINCH_DOWN_ON_STAGE\";\r\nexport const PINCH_MOVED_ON_STAGE = \"PINCH_MOVED_ON_STAGE\";\r\nexport const PINCH_UP_ON_STAGE = \"PINCH_UP_ON_STAGE\";\r\n\r\n// export const HOME_BUTTON_CLICKED = \"HOME_BUTTON_CLICKED\";\r\nexport const PAN_TO_COORDINATE = \"PAN_TO_COORDINATE\";\r\nexport const PAN_AND_ZOOM_TO_SHAPE = \"PAN_AND_ZOOM_TO_SHAPE\";\r\n\r\nexport const LAYER_LIST_PANEL_PRESSED = \"LAYER_LIST_PANEL_PRESSED\";\r\nexport const ADD_LAYER_BUTTON_PRESSED = \"ADD_LAYER_BUTTON_PRESSED\";\r\nexport const ADD_NEW_LAYER = \"ADD_NEW_LAYER\";\r\nexport const DELETE_LAYER_BUTTON_PRESSED = \"DELETE_LAYER_BUTTON_PRESSED\";\r\nexport const SORT_LAYERS_BUTTON_PRESSED = \"SORT_LAYERS_BUTTON_PRESSED\";\r\nexport const CLEAN_AND_UPDATE_LAYERS = \"CLEAN_AND_UPDATE_LAYERS\";\r\n\r\nexport const TOGGLE_DISPLAY_LAYER_PRESSED = \"TOGGLE_DISPLAY_LAYER_PRESSED\";\r\nexport const TOGGLE_AFFECTED_LAYER_PRESSED=\"TOGGLE_AFFECTED_LAYER_PRESSED\";\r\nexport const OPEN_LAYER_EDIT_FORM_PRESSED = \"OPEN_LAYER_EDIT_FORM_PRESSED\";\r\nexport const SUBMIT_LAYER_EDIT_FORM_PRESSED = \"SUBMIT_LAYER_EDIT_FORM_PRESSED\";\r\nexport const ESCAPE_LAYER_EDIT_FORM_PRESSED = \"ESCAPE_LAYER_EDIT_FORM_PRESSED\";\r\n\r\nexport const LAYERS_LIST_ARROW_DOWN_PRESSED = \"LAYERS_LIST_ARROW_DOWN_PRESSED\";\r\nexport const LAYERS_LIST_ARROW_UP_PRESSED = \"LAYERS_LIST_ARROW_UP_PRESSED\";\r\n\r\n// export const TOGGLE_WATCH_EXPAND_CLICKED = \"TOGGLE_WATCH_EXPAND_CLICKED\";\r\n\r\nexport const FILENAME_LIST_SELECTED = \"FILENAME_LIST_SELECTED\";\r\nexport const INPUT_FILE_LOADED = \"INPUT_FILE_LOADED\";\r\nexport const DATA_FROM_BUFFER_PASTED = \"DATA_FROM_BUFFER_PASTED\";\r\n\r\n/** AABB Distance Measurement Demo **/\r\nexport const AABB_DEMO_URI = \"AABB_DEMO_URI\";\r\nexport const AABB_DEMO_NEXT_DIST_STEP = \"AABB_DEMO_NEXT_DIST_STEP\";\r\nexport const AABB_TREE_NEXT_LEVEL = \"AABB_TREE_NEXT_LEVEL\";\r\n\r\n/** Collision demo **/\r\nexport const COLLISION_DEMO_URI = \"COLLISION_DEMO_URI\";\r\nexport const COLLISION_DEMO_BUTTON_PRESSED = \"COLLISION_DEMO_BUTTON_PRESSED\";\r\n\r\n/** Skeleton recognition demo **/\r\nexport const SKELETON_RECOGNITION_URI = \"SKELETON_RECOGNITION_URI\";\r\nexport const SKELETON_RECOGNITION_BUTTON_PRESSED=\"SKELETON_RECOGNITION_BUTTON_PRESSED\";\r\n\r\nexport const ASYNC_OPERATION_STARTED = \"ASYNC_OPERATION_STARTED\";\r\nexport const ASYNC_OPERATION_ENDED = \"ASYNC_OPERATION_ENDED\";\r\n\r\n/** Documents list **/\r\nexport const REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED = \"REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED\";\r\nexport const REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED = \"REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED\";\r\nexport const REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED = \"REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED\";\r\nexport const REQUEST_FETCH_DOCUMENTS_FROM_DATABASE_SUCCEED = \"REQUEST_FETCH_DOCUMENTS_FROM_DATABASE_SUCCEED\";\r\nexport const DELETE_DOCUMENT_FROM_DATABASE_SUCCEED = \"DELETE_DOCUMENT_FROM_DATABASE_SUCCEED\";\r\nexport const DOCUMENT_SELECTED_FROM_LIST = \"DOCUMENT_SELECTED_FROM_LIST\";\r\nexport const DOCUMENT_NAME_UPDATED = \"DOCUMENT_NAME_UPDATED\";\r\nexport const CLEAR_ALL_BUTTON_CLICKED = \"CLEAR_ALL_BUTTON_CLICKED\";\r\n\r\n/* Authentication */\r\nexport const AUTHENTICATION_STARTED = \"AUTHENTICATION_STARTED\";\r\nexport const AUTHENTICATION_SUCCEED = \"AUTHENTICATION_SUCCEED\";\r\nexport const AUTHENTICATION_FAILED = \"AUTHENTICATION_FAILED\";\r\nexport const AUTHENTICATION_LOGOUT = \"AUTHENTICATION_LOGOUT\";\r\nexport const AUTHENTICATION_SET_USERNAME = \"AUTENTICATION_SET_USERNAME\";\r\n\r\n","import {Utils, Arc, vector} from \"@flatten-js/core\";\r\n\r\nexport function arcSE(center, start, end, counterClockwise) {\r\n    let startAngle = vector(center,start).slope;\r\n    let endAngle = vector(center, end).slope;\r\n    if (Utils.EQ(startAngle, endAngle)) {\r\n        endAngle += 2*Math.PI;\r\n        counterClockwise = true;\r\n    }\r\n    let r = vector(center, start).length;\r\n\r\n    return new Arc(center, r, startAngle, endAngle, counterClockwise);\r\n}\r\n\r\nexport function arcStartSweep(center, start, sweep, counterClockwise) {\r\n    let startAngle = vector(center,start).slope;\r\n    let endAngle = startAngle + sweep;\r\n    if (Utils.EQ(startAngle, endAngle)) {\r\n        endAngle += 2*Math.PI;\r\n        counterClockwise = true;\r\n    }\r\n    let r = vector(center, start).length;\r\n\r\n    return new Arc(center, r, startAngle, endAngle, counterClockwise);\r\n}\r\n\r\nexport function arcEndSweep(center, end, sweep, counterClockwise) {\r\n    let endAngle = vector(center,end).slope;\r\n    let startAngle = endAngle - sweep;\r\n    if (Utils.EQ(startAngle, endAngle)) {\r\n        endAngle += 2*Math.PI;\r\n        counterClockwise = true;\r\n    }\r\n    let r = vector(center, end).length;\r\n\r\n    return new Arc(center, r, startAngle, endAngle, counterClockwise);\r\n}\r\n\r\n","\r\n/**\r\n * Created by Alex Bol on 12/02/2018.\r\n */\r\nimport {Segment, Arc, Polygon, Face} from \"@flatten-js/core\";\r\nimport {CW, CCW, INSIDE, OUTSIDE, ORIENTATION} from \"@flatten-js/core\";\r\nimport {vector} from \"@flatten-js/core\";\r\nimport {unify,subtract} from \"@flatten-js/boolean-op\";\r\nimport  {BOOLEAN_UNION} from \"@flatten-js/boolean-op\";\r\n\r\nimport {addToIntPoints, getSortedArray, splitByIntersections} from \"@flatten-js/boolean-op\";\r\nimport {removeNotRelevantChains, removeOldFaces, restoreFaces} from \"@flatten-js/boolean-op\";\r\n\r\nimport {arcSE, arcStartSweep, arcEndSweep} from \"./createArcs\";\r\n\r\n/**\r\n * Offset polygon by given value\r\n * @param {Polygon} polygon - input polygon\r\n * @param {number} value - offset value, may be positive or negative\r\n * @returns {Polygon} offsetPolygon\r\n */\r\n\r\n/**\r\n *\r\n * @param polygon\r\n * @param value\r\n *\r\n */\r\nexport function offset(polygon, value) {\r\n    let w = value;\r\n\r\n    let edges = [...polygon.edges];\r\n    let offsetPolygon = polygon.clone();\r\n    let offsetEdge;\r\n\r\n    if (w !== 0) {\r\n\r\n        for (let edge of edges) {\r\n            if (edge.isSegment()) {\r\n                offsetEdge = offsetSegment(edge.shape, w);\r\n            }\r\n            else {\r\n                offsetEdge = offsetArc(edge.shape, w);\r\n            }\r\n\r\n            if (w > 0) {\r\n                offsetPolygon = unify(offsetPolygon, offsetEdge);\r\n            }\r\n            else {\r\n                offsetPolygon = subtract(offsetPolygon, offsetEdge);\r\n            }\r\n        }\r\n    }\r\n\r\n    return offsetPolygon;\r\n}\r\n\r\nexport function offsetArc(arc, value) {\r\n\r\n    let w = Math.abs(value);\r\n\r\n    // Define outline polygon\r\n    let polygon = new Polygon();\r\n    let arc_cap1,arc_cap2;\r\n\r\n    let arc_outer = arc.clone();\r\n    arc_outer.r = arc.r + w;\r\n\r\n    arc_cap1 = arcStartSweep(arc.end, arc_outer.end, Math.PI, arc.counterClockwise);\r\n    arc_cap2 = arcEndSweep(arc.start, arc_outer.start, Math.PI, arc.counterClockwise);\r\n\r\n    let arc_inner = undefined;\r\n    if (arc.r > w) {\r\n        arc_inner = new Arc(arc.pc, arc.r - w, arc.endAngle, arc.startAngle,\r\n            arc.counterClockwise === CW ? CCW : CW);\r\n    }\r\n    else {\r\n        // arc_inner = new Arc(arc.pc, w - arc.r, arc.startAngle, arc.endAngle, arc.counterClockwise);\r\n        arc_inner = new Segment(arc_cap1.end, arc_cap2.start);\r\n    }\r\n\r\n    polygon.addFace([arc_outer, arc_cap1, arc_inner, arc_cap2]);\r\n    [...polygon.faces][0].setArcLength();\r\n\r\n    // Create intersection points\r\n    let ips = Face.getSelfIntersections([...polygon.faces][0], polygon.edges, false);\r\n\r\n    // TODO: getSelfIntersections returns points with correspondent edges - avoid duplication\r\n    ips = ips.slice(0,ips.length/2);    // for now slice array to avoid duplication in points\r\n\r\n    let int_points = [];\r\n    let edge_cap1;\r\n    let edge_cap2;\r\n\r\n    edge_cap1 = [...polygon.edges][1];\r\n    edge_cap2 = [...polygon.edges][3];\r\n\r\n    for (let pt of ips) {\r\n        addToIntPoints(edge_cap1, pt, int_points);\r\n        addToIntPoints(edge_cap2, pt, int_points);\r\n    }\r\n\r\n    // Sort intersection points and insert them as new vertices\r\n    let int_points_sorted = getSortedArray(int_points);\r\n    splitByIntersections(polygon, int_points_sorted);\r\n\r\n\r\n    // Set BV flags\r\n    let bv = OUTSIDE;\r\n    for (let int_point of int_points_sorted) {\r\n        int_point.edge_before.bv = bv;\r\n        int_point.edge_after.bv = (bv === OUTSIDE ? INSIDE : OUTSIDE);\r\n        bv = int_point.edge_after.bv;   // invert flag on each iteration\r\n    }\r\n\r\n    // Remove inner \"chains\"\r\n    let op = BOOLEAN_UNION;\r\n    removeNotRelevantChains(polygon, op, int_points_sorted, true);\r\n\r\n    // return int_points_sorted;\r\n    // Swap links\r\n    let num = int_points.length;\r\n    if (num > 0) {\r\n        let edge_before;\r\n        let edge_after;\r\n        // 0 => 3\r\n        edge_before = int_points_sorted[0].edge_before;\r\n        edge_after = int_points_sorted[num-1].edge_after;\r\n        edge_before.next = edge_after;\r\n        edge_after.prev = edge_before;\r\n\r\n        // Fill in missed links in intersection points\r\n        int_points_sorted[0].edge_after = int_points_sorted[num-1].edge_after;\r\n        int_points_sorted[num-1].edge_before = int_points_sorted[0].edge_before;\r\n\r\n        if (num === 4) {\r\n            // 2 => 1\r\n            edge_before = int_points_sorted[2].edge_before;\r\n            edge_after = int_points_sorted[1].edge_after;\r\n            edge_before.next = edge_after;\r\n            edge_after.prev = edge_before;\r\n\r\n            // Fill in missed links in intersection points\r\n            int_points_sorted[2].edge_after = int_points_sorted[1].edge_after;\r\n            int_points_sorted[1].edge_before = int_points_sorted[2].edge_before;\r\n        }\r\n\r\n        // remove old faces\r\n        removeOldFaces(polygon, int_points);\r\n        // restore faces\r\n        restoreFaces(polygon, int_points, int_points);\r\n    }\r\n\r\n    let face0 = [...polygon.faces][0];\r\n    if (face0.orientation() === ORIENTATION.CCW) {\r\n        polygon.reverse();\r\n    }\r\n    return polygon;\r\n}\r\n\r\nexport function offsetSegment(seg, value) {\r\n    let w = Math.abs(value);\r\n\r\n    let polygon = new Polygon();\r\n    let v_seg = vector(seg.end.x-seg.start.x, seg.end.y-seg.start.y);\r\n    let v_seg_unit = v_seg.normalize();\r\n    let v_left = v_seg_unit.rotate90CCW().multiply(w);\r\n    let v_right = v_seg_unit.rotate90CW().multiply(w);\r\n    let seg_left = seg.translate(v_left);\r\n    let seg_right = seg.translate(v_right).reverse();\r\n    let cap1 = arcSE(seg.end, seg_left.end, seg_right.start, CW);\r\n    let cap2 = arcSE(seg.start, seg_right.end, seg_left.start, CW);\r\n\r\n    polygon.addFace([seg_left, cap1, seg_right, cap2]);\r\n    return polygon;\r\n}\r\n","/**\r\n * Created by alexanderbol on 01/05/2017.\r\n */\r\n\r\nimport {Point, Segment, Arc, Circle, Box, Polygon, vector} from '@flatten-js/core';\r\nimport Flatten from '@flatten-js/core';\r\nimport {offsetSegment, offsetArc} from \"../models/polygonOffset\";\r\n\r\n/*\r\nlet debug_str = `+\t\t[0]\t{nrec=27 nalloc=27 h_ind_id=-1 ...} mat_cont_hdr_struc\tmat_cont_struc\r\n    +\t\t[1]\t{pmin=59146400,5973200 pmax=59606001,6438000} mat_cont_lim_struc\tmat_cont_struc\r\n+\t\t[2]\t{nedge=23 nalloc=25 ntop=2 ...} mat_cont_poly_struc\tmat_cont_struc\r\n+\t\t[3]\t{pmin=59146400,5973200 pmax=59606001,6438000} mat_cont_lim_struc\tmat_cont_struc\r\n+\t\t[4]\t{ps=59192738,6363124 pe=59216000,6372800 pc=59216000,6340000 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[5]\t{ps=59216000,6372800 pe=59267652,6372800} mat_seg_struc\tmat_cont_struc\r\n+\t\t[6]\t{ps=59267652,6372800 pe=59267652,6307200 pc=59360000,6340000 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[7]\t{ps=59267652,6307200 pe=59229586,6307200} mat_seg_struc\tmat_cont_struc\r\n+\t\t[8]\t{ps=59229586,6307200 pe=59212000,6289614} mat_seg_struc\tmat_cont_struc\r\n+\t\t[9]\t{ps=59212000,6289614 pe=59212000,6056386} mat_seg_struc\tmat_cont_struc\r\n+\t\t[10]\t{ps=59212000,6056386 pe=59229586,6038800} mat_seg_struc\tmat_cont_struc\r\n+\t\t[11]\t{ps=59229586,6038800 pe=59469614,6038800} mat_seg_struc\tmat_cont_struc\r\n+\t\t[12]\t{ps=59469614,6038800 pe=59487200,6056386} mat_seg_struc\tmat_cont_struc\r\n+\t\t[13]\t{ps=59487200,6056386 pe=59487200,6100500} mat_seg_struc\tmat_cont_struc\r\n+\t\t[14]\t{ps=59487200,6100500 pe=59434000,6180000 pc=59520000,6180000 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[15]\t{ps=59434000,6180000 pe=59552800,6100500 pc=59520000,6180000 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[16]\t{ps=59552800,6100500 pe=59552800,6042800} mat_seg_struc\tmat_cont_struc\r\n+\t\t[17]\t{ps=59552800,6042800 pe=59543124,6019538 pc=59520000,6042800 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[18]\t{ps=59543124,6019538 pe=59506462,5982876} mat_seg_struc\tmat_cont_struc\r\n+\t\t[19]\t{ps=59506462,5982876 pe=59483200,5973200 pc=59483200,6006000 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[20]\t{ps=59483200,5973200 pe=59216000,5973200} mat_seg_struc\tmat_cont_struc\r\n+\t\t[21]\t{ps=59216000,5973200 pe=59192738,5982876 pc=59216000,6006000 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[22]\t{ps=59192738,5982876 pe=59156076,6019538} mat_seg_struc\tmat_cont_struc\r\n+\t\t[23]\t{ps=59156076,6019538 pe=59146400,6042800 pc=59179200,6042800 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[24]\t{ps=59146400,6042800 pe=59146400,6303200} mat_seg_struc\tmat_cont_struc\r\n+\t\t[25]\t{ps=59146400,6303200 pe=59156076,6326462 pc=59179200,6303200 cw=1} mat_curve_struc\tmat_cont_struc\r\n+\t\t[26]\t{ps=59156076,6326462 pe=59192738,6363124} mat_seg_struc\tmat_cont_struc\r\n`;\r\n*/\r\n\r\n/*\r\n+\t\tcircle\t{pc=40445880,-10500080 r=41327880}\tmat_circle_struc\r\n+\t\tcircle\t{pc=38215880,-7700040 r=92456}\tmat_circle_struc\r\n+\t\trect\t{pll=38215880,-7700040 w=92456 h=50000}\tmat_rect_struc\r\n+\t\tshape1\t{type=512 s={...} }\t_mat_shape_struc\r\n+\t\tline\t{ps=-18423,529080 pe=1047776,480195 r=60000 cap=0}\tmat_line_struc\r\n+\t\tarc\t{ps=1001217,249728 pe=752127,51853 pc=853697,179712 cw=??? r=60000 cap=0}\tmat_arc_struc\r\n */\r\n\r\nexport class Parser {\r\n    parseToWatchArray(str) {\r\n        let arrayOfLines = str.match(/[^\\r\\n]+/g);\r\n        let watchArray = [];\r\n        for (let line of arrayOfLines) {\r\n            watchArray.push(line.substring(line.indexOf('{')));\r\n        }\r\n        return watchArray;\r\n    }\r\n\r\n    parseToSegment(line) {\r\n        let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n        let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n        let psArr = termArr[0].split('=')[1].split(',');\r\n        let ps = new Point(parseInt(psArr[0],10), parseInt(psArr[1],10));\r\n\r\n        let peArr = termArr[1].split('=')[1].split(',');\r\n        let pe = new Point(parseInt(peArr[0],10), parseInt(peArr[1],10));\r\n\r\n        return new Segment(ps, pe);\r\n    }\r\n\r\n    parseToArc(line) {\r\n        let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n        let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n        let psArr = termArr[0].split('=')[1].split(',');\r\n        let ps = new Point(parseInt(psArr[0],10), parseInt(psArr[1],10));\r\n\r\n        let peArr = termArr[1].split('=')[1].split(',');\r\n        let pe = new Point(parseInt(peArr[0],10), parseInt(peArr[1],10));\r\n\r\n        let pcArr = termArr[2].split('=')[1].split(',');\r\n        let pc = new Point(parseInt(pcArr[0],10), parseInt(pcArr[1],10));\r\n\r\n        let cwStr = termArr[3].split('=')[1];\r\n        let counterClockwise = cwStr === '0' ? true : false;\r\n\r\n        let startAngle = vector(pc,ps).slope;\r\n        let endAngle = vector(pc, pe).slope;\r\n\r\n        if (Flatten.Utils.EQ(startAngle, endAngle)) {\r\n            // endAngle += 2*Math.PI;\r\n            endAngle = counterClockwise ? endAngle + 2*Math.PI : endAngle - 2*Math.PI;\r\n        }\r\n        let r = vector(pc, ps).length;\r\n\r\n        return new Arc(pc, r, startAngle, endAngle, counterClockwise);\r\n    }\r\n\r\n    parseToCircle(line) {\r\n        let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n        let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n        let pcArr = termArr[0].split('=')[1].split(',');\r\n        let pc = new Point(parseInt(pcArr[0],10), parseInt(pcArr[1],10));\r\n        let r = parseInt(termArr[1].split('=')[1],10);\r\n        let circle = new Circle(pc, r);\r\n        let polygon = new Polygon();\r\n        polygon.addFace(circle);\r\n        return polygon;\r\n    }\r\n\r\n    parseToRectangle(line) {\r\n        let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n        let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n        let pllArr = termArr[0].split('=')[1].split(',');\r\n        let xmin = parseInt(pllArr[0],10);\r\n        let ymin = parseInt(pllArr[1],10);\r\n        let width = parseInt(termArr[1].split('=')[1],10);\r\n        let height = parseInt(termArr[2].split('=')[1],10);\r\n\r\n        let box = new Box(xmin, ymin, xmin + width, ymin + height);\r\n        let polygon = new Polygon();\r\n        polygon.addFace(box);\r\n        return polygon;\r\n    }\r\n\r\n    parseToODBLine(line) {\r\n        let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n        let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n        let psArr = termArr[0].split('=')[1].split(',');\r\n        let ps = new Point(parseInt(psArr[0],10), parseInt(psArr[1],10));\r\n\r\n        let peArr = termArr[1].split('=')[1].split(',');\r\n        let pe = new Point(parseInt(peArr[0],10), parseInt(peArr[1],10));\r\n\r\n        let w = parseInt(termArr[2].split('=')[1],10);\r\n\r\n        let segment = new Segment(ps, pe);\r\n        let polygon = w > 0 ? offsetSegment(segment, w) : new Polygon();\r\n\r\n        return polygon;\r\n    }\r\n\r\n    parseToODBArc(line) {\r\n        let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n        let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n        let psArr = termArr[0].split('=')[1].split(',');\r\n        let ps = new Point(parseInt(psArr[0],10), parseInt(psArr[1],10));\r\n\r\n        let peArr = termArr[1].split('=')[1].split(',');\r\n        let pe = new Point(parseInt(peArr[0],10), parseInt(peArr[1],10));\r\n\r\n        let pcArr = termArr[2].split('=')[1].split(',');\r\n        let pc = new Point(parseInt(pcArr[0],10), parseInt(pcArr[1],10));\r\n\r\n        let cwStr = termArr[3].split('=')[1];\r\n        let counterClockwise = cwStr === '0' ? true : false;\r\n\r\n        let startAngle = vector(pc,ps).slope;\r\n        let endAngle = vector(pc, pe).slope;\r\n\r\n        if (Flatten.Utils.EQ(startAngle, endAngle)) {\r\n            // endAngle += 2*Math.PI;\r\n            endAngle = counterClockwise ? endAngle + 2*Math.PI : endAngle - 2*Math.PI;\r\n        }\r\n        let r = vector(pc, ps).length;\r\n\r\n        let arc = new Arc(pc, r, startAngle, endAngle, counterClockwise);\r\n\r\n        let w = parseInt(termArr[4].split('=')[1],10);\r\n\r\n        let polygon = w > 0 ? offsetArc(arc, w) : new Polygon();\r\n\r\n        return polygon;\r\n    }\r\n\r\n    parseToPolygon(str) {\r\n        let polygon = new Polygon();\r\n        // let mulitystr = debug_str;\r\n        let arrayOfLines = str.match(/[^\\r\\n]+/g);\r\n\r\n        for (let i=0; i < arrayOfLines.length; i++) {\r\n            let line = arrayOfLines[i];\r\n            if (line.search('mat_cont_poly_struc') >= 0) {\r\n                let parenth = line.match(/\\{([^)]+)\\}/)[1];       // string inside {..}\r\n                let termArr = parenth.split(' ');                 // array of terms \"attr=value\"\r\n                let nedgesTerm = termArr[0];                      // \"nedge=nn\"\r\n                let nedgesStr = nedgesTerm.split('=')[1];\r\n                let nedges = parseInt(nedgesStr,10);\r\n\r\n                // Create new face from next #nedges of segments and arcs\r\n                let edges = [];\r\n                for (let j=i+2; j < i+2+nedges; j++) {\r\n                    line = arrayOfLines[j];\r\n                    // let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n                    // let termArr = parenth.split(' ');             // array of terms \"attr=value\"\r\n\r\n                    if (line.search('mat_seg_struc') >= 0) {\r\n                        let segment = this.parseToSegment(line);\r\n                        edges.push(segment);\r\n                    }\r\n                    else if (line.search('mat_curve_struc') >= 0) {\r\n                        let arc = this.parseToArc(line);\r\n                        edges.push(arc);\r\n                    }\r\n                }\r\n                polygon.addFace(edges);\r\n            }\r\n        }\r\n        return polygon;\r\n    }\r\n\r\n    parseToPoints(str) {\r\n        let points = [];\r\n        let arrayOfLines = str.match(/[^\\r\\n]+/g);\r\n        for (let line of arrayOfLines) {\r\n            if (line.search('point_struc') >= 0) {\r\n                let parenth = line.match(/\\{([^)]+)\\}/)[1];   // string inside {..}\r\n                let pointArr = parenth.split('=')[1].split(',');\r\n                let point = new Point(parseInt(pointArr[0],10), parseInt(pointArr[1],10));\r\n                point.label = line.split(/\\s+/)[1];\r\n                points.push(point);\r\n            }\r\n        }\r\n        return points;\r\n    }\r\n\r\n    parseToShapes(str) {\r\n        let shapes = [];\r\n        let shape;\r\n        let arrayOfLines = str.match(/[^\\r\\n]+/g);\r\n        for (let line of arrayOfLines) {\r\n            if (line.search('_seg_struc') >= 0) {\r\n                shape = this.parseToSegment(line);\r\n            }\r\n            else if (line.search('_curve_struc') >= 0) {\r\n                shape = this.parseToArc(line);\r\n            }\r\n            else if (line.search('_circle_struc') >= 0) {\r\n                shape = this.parseToCircle(line);\r\n            }\r\n            else if (line.search('_rect_struc') >= 0) {\r\n                shape = this.parseToRectangle(line);\r\n            }\r\n            else if (line.search('_line_struc') >= 0) {\r\n                shape = this.parseToODBLine(line);\r\n            }\r\n            else if (line.search('_arc_struc') >= 0) {\r\n                shape = this.parseToODBArc(line);\r\n            }\r\n            shapes.push(shape);\r\n        }\r\n        return shapes;\r\n    }\r\n\r\n    parse(str) {\r\n        /* try polygon */\r\n        let polygon = this.parseToPolygon(str);\r\n        if (polygon.edges.size > 0 && polygon.faces.size > 0) {\r\n            return [polygon];\r\n        }\r\n\r\n        /* try array of points */\r\n        let points = this.parseToPoints(str);\r\n        if (points.length > 0) {\r\n            return points;\r\n        }\r\n\r\n        /* try array of segments and arcs and other mat_shapes excluding polygon */\r\n        let shapes = this.parseToShapes(str);\r\n        if (shapes.length > 0) {\r\n            return shapes;\r\n        }\r\n    }\r\n}\r\n\r\n","import * as ActionTypes from \"../actionTypes\";\r\nimport {Parser} from \"../../dataParsers/parser\";\r\n\r\nconst unitsList = [\r\n    {\r\n        name: \"pixels\",\r\n        decimals: 0,\r\n        divisor: 1\r\n    },\r\n    {\r\n        name: \"inch\",\r\n        decimals: 7,\r\n        divisor: 10160000\r\n    },\r\n    {\r\n        name: \"mm\",\r\n        decimals: 6,\r\n        divisor: 400000\r\n    }];\r\n\r\nconst defaultAppState = {\r\n    title: \"Debug Viewer\",\r\n    version: process.env.REACT_APP_VERSION,\r\n    build: \"\",\r\n    units: \"pixels\",\r\n    decimals: 0,\r\n    divisor: 1,\r\n    // bg: \"#F1F1F1\",\r\n    parser: new Parser(),\r\n    widthOn: true,\r\n    displayVertices: false,\r\n    displayLabels: true,\r\n    measurePointsActive: false,\r\n    zoomFactor: undefined,\r\n    originX: undefined,\r\n    originY: undefined,\r\n    showAboutPopup: false,\r\n    importDataToNewLayer: true,       // if false, import data to affected layer\r\n    showSkeletonRecognitionButton: false,\r\n    applySkeletonRecognition: false,\r\n    stage: null,\r\n    showSpinner: false,\r\n    showLayerList: false,\r\n};\r\n\r\nconst app = (state = defaultAppState, action) => {\r\n    switch (action.type) {\r\n        case ActionTypes.NEW_STAGE_CREATED:\r\n            return Object.assign({}, state, {\r\n                stage: action.stage,\r\n                zoomFactor: action.stage.zoomFactor * action.stage.resolution,\r\n                originX: action.stage.origin.x,\r\n                originY: action.stage.origin.y,\r\n            });\r\n\r\n        case ActionTypes.STAGE_UNMOUNTED:\r\n            return Object.assign({}, state, {\r\n                stage: null,\r\n                zoomFactor: undefined,\r\n                originX: undefined,\r\n                originY: undefined\r\n            });\r\n\r\n        case ActionTypes.MOUSE_WHEEL_MOVE_ON_STAGE:\r\n        case ActionTypes.PAN_AND_ZOOM_TO_SHAPE:\r\n        case ActionTypes.PINCH_MOVED_ON_STAGE:\r\n            return Object.assign({}, state, {\r\n                zoomFactor: action.stage.zoomFactor * action.stage.resolution,\r\n                originX: action.stage.origin.x,\r\n                originY: action.stage.origin.y,\r\n            });\r\n        case ActionTypes.MOUSE_MOVED_ON_STAGE:\r\n            return Object.assign({}, state, {\r\n                originX: action.stage.origin.x,\r\n                originY: action.stage.origin.y\r\n            });\r\n        case ActionTypes.TOGGLE_UNITS_CLICKED:\r\n            let curUnitsId = unitsList.findIndex(units => state.units === units.name);\r\n            let newUnits = unitsList[(curUnitsId + 1) % 3];\r\n            return Object.assign({}, state, {\r\n                units: newUnits.name,\r\n                decimals: newUnits.decimals,\r\n                divisor: newUnits.divisor\r\n            });\r\n        case ActionTypes.TOGGLE_WIDTH_MODE_CLICKED:\r\n            return Object.assign({}, state, {\r\n                widthOn: !state.widthOn,\r\n                displayVertices: state.widthOn ? state.displayVertices : false\r\n            });\r\n        case ActionTypes.TOGGLE_DISPLAY_VERTICES_CLICKED:\r\n            if (state.displayVertices) {\r\n                return Object.assign({}, state, {\r\n                    displayVertices: false\r\n                });\r\n            }\r\n            else {\r\n                return Object.assign({}, state, {\r\n                    widthOn: false,\r\n                    displayVertices: true\r\n                });\r\n            }\r\n\r\n        case ActionTypes.TOGGLE_DISPLAY_LABELS_CLICKED:\r\n            return Object.assign({}, state, {\r\n                displayLabels: !state.displayLabels\r\n            });\r\n\r\n        case ActionTypes.TOGGLE_ABOUT_POPUP_CLICKED:\r\n            return Object.assign({}, state, {\r\n                showAboutPopup: !state.showAboutPopup\r\n            });\r\n\r\n        // case ActionTypes.CLOSE_ABOUT_POPUP_BUTTON_PRESSED:\r\n        //     return Object.assign({}, state, {\r\n        //         showAboutPopup: false\r\n        //     });\r\n\r\n        case ActionTypes.PAN_BY_DRAG_BUTTON_CLICKED:\r\n            return Object.assign({}, state, {\r\n                measurePointsActive: false\r\n            });\r\n\r\n        case ActionTypes.MEASURE_POINTS_BUTTON_PRESSED:\r\n            return Object.assign({}, state, {\r\n                measurePointsActive: true\r\n            });\r\n        case ActionTypes.MEASURE_SHAPES_BUTTON_PRESSED:\r\n            return Object.assign({}, state, {\r\n                measurePointsActive: false\r\n            });\r\n        case ActionTypes.SKELETON_RECOGNITION_URI:\r\n            return Object.assign({}, state, {\r\n                showSkeletonRecognitionButton: true\r\n            });\r\n        case ActionTypes.SKELETON_RECOGNITION_BUTTON_PRESSED:\r\n            return Object.assign({}, state, {\r\n                applySkeletonRecognition: true\r\n            });\r\n        case ActionTypes.ASYNC_OPERATION_STARTED:\r\n            return Object.assign({}, state, {\r\n                showSpinner: true\r\n            });\r\n        case ActionTypes.ASYNC_OPERATION_ENDED:\r\n            return Object.assign({}, state, {\r\n                showSpinner: false\r\n            });\r\n        case ActionTypes.AABB_TREE_NEXT_LEVEL:\r\n            return state;\r\n        case ActionTypes.TOGGLE_SHOW_LAYER_LIST_CLICKED:\r\n            return {\r\n                ...state,\r\n                showLayerList: !state.showLayerList\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default app;","\r\nlet defaultStyle = {\r\n    strokeStyle: 1,\r\n    stroke: \"#FF0303\",\r\n    fill: \"#FF0303\",\r\n    alpha: 1.0\r\n};\r\n\r\n/* Class Model represents data model that will be added to layer */\r\nclass Model {\r\n    constructor(geom = undefined, style = undefined, label = \"\") {\r\n        this.geom = geom;\r\n        this.style = style || defaultStyle;\r\n        this.label = label;\r\n    }\r\n\r\n    clone() {\r\n        let model = new Model(this.geom, this.style, this.label);\r\n        return Object.assign(model, this);\r\n    }\r\n\r\n    get box() {\r\n        return this.geom.box;\r\n    }\r\n/*\r\n    static transformPoint(pt, stage) {\r\n        return new Flatten.Point(stage.W2C_X(pt.x), stage.W2C_Y(pt.y));\r\n    }\r\n\r\n    static transformSegment(segment, stage) {\r\n        return new Flatten.Segment(\r\n            Model.transformPoint(segment.ps, stage),\r\n            Model.transformPoint(segment.pe, stage)\r\n        )\r\n    }\r\n\r\n    static transformArc(arc, stage) {\r\n        return new Flatten.Arc(\r\n            Model.transformPoint(arc.pc, stage),\r\n            stage.W2C_Scalar(arc.r),\r\n            arc.startAngle,\r\n            arc.endAngle,\r\n            arc.counterClockwise\r\n        )\r\n    }\r\n\r\n    static transformEdge(shape, stage) {\r\n        if (shape instanceof Flatten.Segment) {\r\n            return Model.transformSegment(shape, stage);\r\n        }\r\n        else if (shape instanceof Flatten.Arc) {\r\n            return Model.transformArc(shape, stage);\r\n        }\r\n    }\r\n\r\n    static transformFace(face, stage) {\r\n        // Get shapes of face as array\r\n        let shapes = [];\r\n        for (let edge of face) {\r\n            shapes.push(edge.shape);\r\n        }\r\n\r\n        // Transform array of edges\r\n        return shapes.map(shape => Model.transformEdge(shape, stage));\r\n    }\r\n\r\n    static transformPolygon(polygon, stage) {\r\n        let newPolygon = new Flatten.Polygon();\r\n        let shapes = [];\r\n        for (let face of polygon.faces) {\r\n            shapes = Model.transformFace(face, stage);\r\n            newPolygon.addFace(shapes);\r\n        }\r\n        return newPolygon;\r\n    }\r\n*/\r\n}\r\n\r\nexport default Model;","/**\r\n * Created by alexanderbol on 17/04/2017.\r\n */\r\n\r\nimport {Point, Box} from '@flatten-js/core';\r\n// import { Shape } from '../models/shape';\r\nimport Model from './model';\r\n\r\nclass Layer {\r\n    constructor(stage) {\r\n        // super();\r\n        // cannot define Layer as extension of PlanarSet due to bug in compiler ?\r\n        this.stage = stage;\r\n        this.shapes = [];         // new Flatten.PlanarSet();\r\n        this.name = \"\";\r\n        this.color = \"\";\r\n        this.title = \"\";\r\n        this.displayed = false;\r\n        this.edited = false;\r\n        this.affected = false;\r\n    }\r\n\r\n    clone() {\r\n        let layer = new Layer(this.stage);\r\n        return Object.assign(layer, this);\r\n    }\r\n\r\n    add(shape) {\r\n        if (shape instanceof Model) {\r\n            this.shapes.push(shape);       // add(shape)\r\n        }\r\n        else {\r\n            let geom = shape;\r\n            let newShape = new Model(geom, {}, shape.label) // , this.stage);\r\n            this.shapes.push(newShape);     // add(newShape);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    addShapesArray(shapes) {\r\n        for (let shape of shapes) {\r\n            this.add(shape);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get box() {\r\n        let box = new Box();\r\n        for (let shape of this.shapes) {\r\n            box = box.merge(shape.box);\r\n        }\r\n        return box;\r\n    }\r\n\r\n    get center() {\r\n        let box = this.box;\r\n        return new Point((box.xmin + box.xmax)/2, (box.ymin + box.ymax)/2);\r\n    }\r\n\r\n    toggleDisplayed(color) {\r\n        let displayed = !this.displayed;\r\n        return Object.assign(this.clone(),\r\n            {\r\n                displayed : displayed,\r\n                color: color\r\n            });\r\n    }\r\n\r\n    setAffected(affected) {\r\n        this.affected = affected;\r\n        return this;\r\n        // return Object.assign(this.clone(),\r\n        //     {\r\n        //         affected : affected\r\n        //     });\r\n    }\r\n\r\n    setEdited(edited) {\r\n        return Object.assign(this.clone(),\r\n            {\r\n                edited : edited\r\n            });\r\n    }\r\n\r\n    setNameAndTitle(name,title) {\r\n        return Object.assign(this.clone(),\r\n            {\r\n                name : name,\r\n                title: title,\r\n                edited: false\r\n            });\r\n    }\r\n\r\n    setAlpha() {\r\n        for(let shape of this.shapes) {\r\n            shape.alpha = this.displayed ? 1 : 0;\r\n        }\r\n        return this.shapes;\r\n    }\r\n\r\n    // toggleExpanded(shapeToggle) {\r\n    //     for(let shape of this.shapes) {\r\n    //         if (shape === shapeToggle) {\r\n    //             shape.expanded = !shape.expanded;\r\n    //         }\r\n    //     }\r\n    //     return this;\r\n    // }\r\n\r\n    toJSON() {\r\n        return {\r\n            name: this.name,\r\n            title: this.title,\r\n            shapes: JSON.stringify(this.shapes, null, ' ')\r\n        };\r\n    }\r\n}\r\n\r\nexport default Layer;","/**\r\n * Created by alexanderbol on 20/04/2017.\r\n */\r\n\r\nimport Layer from '../models/layer';\r\n\r\nconst colors = [\r\n    \"#FF0303\",\r\n    \"#4AA403\",\r\n    \"#540080\",\r\n    \"#FFFF40\",\r\n    \"#FF0080\",\r\n    \"#AED424\",\r\n    \"#545400\",\r\n    \"#FFA980\",\r\n    \"#A95480\",\r\n    \"#A9A9FF\",\r\n    \"#00FF00\",\r\n    \"#FFEE76\",\r\n    \"#A40576\",\r\n    \"#4385C8\",\r\n    \"#1CC826\",\r\n    \"#BDBD00\",\r\n    \"#48316E\",\r\n    \"#14616E\",\r\n    \"#8040BD\",\r\n    \"#DC7676\",\r\n    \"#924845\",\r\n    \"#A90000\",\r\n    \"#FFA900\"\r\n];\r\n\r\nclass Layers {\r\n\r\n    static newLayer(stage, layers) {\r\n        let layer = new Layer(stage);\r\n        layer.name = Layers.getNewName(layers);\r\n        if (layers.length === 0) { // first layer\r\n            // layer.color = Layers.getNextColor(layers);\r\n            layer.displayed = false;\r\n            layer.affected = false;\r\n        }\r\n        return layer;\r\n    }\r\n\r\n    static get defaultName() {\r\n        return \"layer\";\r\n    }\r\n\r\n    static getNewName(layers) {\r\n        let name = Layers.defaultName;\r\n        let inc = 1;\r\n        let comparator = (layer) => layer.name === name;\r\n        while (layers.find(comparator) ) {\r\n            name = Layers.defaultName + inc;\r\n            inc++;\r\n        }\r\n        return name;\r\n    }\r\n\r\n    static getAffected(layers) {\r\n        return layers.find((lay) => lay.affected);\r\n    }\r\n\r\n    static setAffected(layers, layer) {\r\n        let currentAffectedLayer = Layers.getAffected(layers);\r\n        if (currentAffectedLayer) {\r\n            currentAffectedLayer.affected = false;\r\n        }\r\n        layer.affected = true;\r\n    }\r\n\r\n    static getNextColor(layers) {\r\n        let color = \"\";\r\n        for (let col of colors) {\r\n            if (!layers.find((layer) =>\r\n                layer.displayed && layer.color === col)) {\r\n                color = col;\r\n                break;\r\n            }\r\n        }\r\n        return color;\r\n    }\r\n\r\n    static delete(layers, layer) {\r\n        let index = layers.findIndex((l) => l === layer);\r\n        let newLayers = layers.filter(l => l !== layer);\r\n        if (index > 0) {\r\n            newLayers[index-1].affected = true;\r\n            if (newLayers[index-1].color === \"\") {\r\n                newLayers[index - 1].color = Layers.getNextColor(newLayers);\r\n            }\r\n            newLayers[index-1].displayed = true;\r\n        }\r\n        return newLayers;\r\n        // another option to delete from array:\r\n        // const newLayers = [...layers]\r\n        // return newLayers.splice( index, 1);\r\n    }\r\n\r\n    static sort(layers) {\r\n        let newLayers = layers.slice();\r\n        newLayers.sort( function(l1, l2) {\r\n            let name1 = l1.name.toUpperCase();\r\n            let name2 = l2.name.toUpperCase();\r\n            if (name1 < name2) {\r\n                return -1;\r\n            }\r\n            if (name1 > name2) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        });\r\n        return newLayers;\r\n    }\r\n\r\n    static toJSON(layers) {\r\n        return layers.map( layer => layer.toJSON() );\r\n    }\r\n}\r\n\r\nexport default Layers;","import * as ActionTypes from \"../actionTypes\";\r\nimport Layers from \"../../models/layers\";\r\n\r\nconst layers = (state = [], action) => {\r\n    let affectedLayer = state.find(layer => layer.affected);\r\n    let affectedLayerId = state.findIndex(layer => layer.affected);\r\n    let newLayer;\r\n\r\n    switch (action.type) {\r\n        case ActionTypes.ADD_LAYER_BUTTON_PRESSED:\r\n            newLayer = Layers.newLayer(action.stage, state);\r\n            return [...state, newLayer];\r\n\r\n        case ActionTypes.ADD_NEW_LAYER:\r\n            return [...state, action.layer];\r\n\r\n        case ActionTypes.DELETE_LAYER_BUTTON_PRESSED:\r\n            if (affectedLayer) {\r\n                return Layers.delete(state, affectedLayer);\r\n            }\r\n            else {\r\n                return state;\r\n            }\r\n\r\n        case ActionTypes.CLEAR_ALL_BUTTON_CLICKED:\r\n            return [];\r\n\r\n        case ActionTypes.SORT_LAYERS_BUTTON_PRESSED:\r\n            return Layers.sort(state);\r\n\r\n        case ActionTypes.TOGGLE_DISPLAY_LAYER_PRESSED:\r\n            let color = \"\";\r\n            if (!action.layer.displayed) {\r\n                color = Layers.getNextColor(state);\r\n                if (color === \"\") return;  // no free colors\r\n            }\r\n            return state.map((layer) => {\r\n                if (layer !== action.layer) {\r\n                    // if action.layer will be undisplayed,\r\n                    // it cannot become affected, then\r\n                    // keep affected on this layer\r\n                    if (action.layer.displayed) {\r\n                        return layer;\r\n                    }\r\n                    else {\r\n                        return layer.setAffected(false);\r\n                    }\r\n                }\r\n                else {\r\n                    let newLayer = layer.toggleDisplayed(color);\r\n                    newLayer.affected = newLayer.displayed;\r\n                    return newLayer;\r\n                }\r\n                // return layer.toggleDisplayed(color);\r\n            });\r\n\r\n        case ActionTypes.TOGGLE_AFFECTED_LAYER_PRESSED:\r\n            return state.map((layer) => {\r\n                if (layer !== action.layer) {\r\n                    return layer.setAffected(false);\r\n                }\r\n                else {\r\n                    return layer.setAffected(!layer.affected);\r\n                }\r\n            });\r\n\r\n        // case ActionTypes.NEW_SHAPE_PASTED:\r\n        //     return state.map((layer) => {\r\n        //         if (layer.affected) {\r\n        //             return layer.addShapesArray(action.shapesArray);\r\n        //         }\r\n        //         else {\r\n        //             return layer;\r\n        //         }\r\n        //     });\r\n\r\n        case ActionTypes.OPEN_LAYER_EDIT_FORM_PRESSED:\r\n            return state.map((layer) => {\r\n                if (layer !== affectedLayer) {\r\n                    return layer;\r\n                }\r\n                else {\r\n                    return layer.setEdited(true);\r\n                }\r\n            });\r\n\r\n        case ActionTypes.SUBMIT_LAYER_EDIT_FORM_PRESSED:\r\n            return state.map((layer) => {\r\n                if (layer.edited) {\r\n                    return layer.setNameAndTitle(action.newLayer.name, action.newLayer.title);\r\n                }\r\n                else {\r\n                    return layer;\r\n                }\r\n            });\r\n\r\n        case ActionTypes.ESCAPE_LAYER_EDIT_FORM_PRESSED:\r\n            return state.map((layer) => {\r\n                if (layer.edited) {             // !== action.layer) {\r\n                    return layer.setEdited(false);\r\n                }\r\n                else {\r\n                    return layer;\r\n                }\r\n            });\r\n\r\n        case ActionTypes.LAYERS_LIST_ARROW_DOWN_PRESSED:\r\n            if (affectedLayerId === state.length - 1) {\r\n                return state;\r\n            }\r\n            else {\r\n\r\n                let nextLayer = state[affectedLayerId + 1];\r\n\r\n                return state.map(layer => {\r\n                    if (layer === affectedLayer) {\r\n                        let newCurLayer = layer.toggleDisplayed(\"\");\r\n                        newCurLayer.affected = false;\r\n                        return newCurLayer;\r\n                    }\r\n                    else if (layer === nextLayer) {\r\n                        let color = affectedLayer.color;\r\n                        let newNextLayer = layer.toggleDisplayed(color);\r\n                        newNextLayer.affected = true;\r\n                        return newNextLayer;\r\n                    }\r\n                    else {\r\n                        return layer;\r\n                    }\r\n                });\r\n            }\r\n\r\n        case ActionTypes.LAYERS_LIST_ARROW_UP_PRESSED:\r\n            if (affectedLayerId === 0) {\r\n                return state;\r\n            }\r\n            else {\r\n                let nextLayer = state[affectedLayerId - 1];\r\n\r\n                return state.map(layer => {\r\n                    if (layer === affectedLayer) {\r\n                        let newCurLayer = layer.toggleDisplayed(\"\");\r\n                        newCurLayer.affected = false;\r\n                        return newCurLayer;\r\n                    }\r\n                    else if (layer === nextLayer) {\r\n                        let newNextLayer = layer.toggleDisplayed(affectedLayer.color);\r\n                        newNextLayer.displayed = true;\r\n                        newNextLayer.affected = true;\r\n                        return newNextLayer;\r\n                    }\r\n                    else {\r\n                        return layer;\r\n                    }\r\n                });\r\n            }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default layers;","import * as ActionTypes from \"../actionTypes\";\r\n\r\nconst defaultMouseState = {\r\n    x: 0,\r\n    y: 0,\r\n    startX: undefined,\r\n    startY: undefined,\r\n    touchPoints: undefined\r\n};\r\n\r\nconst mouse = (state = defaultMouseState, action) => {\r\n    switch (action.type) {\r\n        case ActionTypes.MOUSE_MOVED_ON_STAGE:\r\n            return Object.assign({}, state, {\r\n                x: action.x,\r\n                y: action.y\r\n            });\r\n        case ActionTypes.MOUSE_DOWN_ON_STAGE:\r\n            return Object.assign({}, state, {\r\n                startX: action.x,\r\n                startY: action.y\r\n            });\r\n        case ActionTypes.MOUSE_UP_ON_STAGE:\r\n            return Object.assign({}, state, {\r\n                startX: undefined,\r\n                startY: undefined\r\n            });\r\n\r\n        case ActionTypes.PINCH_DOWN_ON_STAGE: {\r\n            return {\r\n                ...state,\r\n                touchPoints: [\r\n                    {x: action.x1, y: action.y1},\r\n                    {x: action.x2, y: action.y2}\r\n                ]\r\n            }\r\n        }\r\n        // case ActionTypes.PINCH_MOVED_ON_STAGE: {\r\n        //     return {\r\n        //         ...state,\r\n        //         touchPoints: [\r\n        //             {x: action.x1, y: action.y1},\r\n        //             {x: action.x2, y: action.y2}\r\n        //         ]\r\n        //     }\r\n        // }\r\n        case ActionTypes.PINCH_UP_ON_STAGE: {\r\n            return {\r\n                ...state,\r\n                touchPoints: undefined\r\n            }\r\n        }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default mouse;","import * as ActionTypes from \"../actionTypes\";\r\nimport Flatten from \"@flatten-js/core\";\r\n\r\nconst defaultMeasureShapesTool = {\r\n    measureShapesActive: false,\r\n    measureShapesFirstClick: true,\r\n    hoveredShape: null,\r\n    firstMeasuredShape: null,\r\n    secondMeasuredShape: null,\r\n    firstMeasuredLayer: null,\r\n    secondMeasuredLayer: null,\r\n    distance: undefined,\r\n    shortestSegment: null\r\n};\r\n\r\nconst is_mobile = window.mobilecheck();\r\n\r\nconst measureShapesTool = (state = defaultMeasureShapesTool, action) => {\r\n    switch (action.type) {\r\n        case ActionTypes.MEASURE_SHAPES_BUTTON_PRESSED:\r\n            return Object.assign({}, defaultMeasureShapesTool, {\r\n                measureShapesActive: true\r\n            });\r\n        case ActionTypes.PAN_BY_DRAG_BUTTON_CLICKED:\r\n            return Object.assign({}, defaultMeasureShapesTool);\r\n\r\n        case ActionTypes.MEASURE_POINTS_BUTTON_PRESSED:\r\n            return Object.assign({}, defaultMeasureShapesTool);\r\n\r\n        case ActionTypes.MOUSE_ROLL_OVER_SHAPE:\r\n            return Object.assign({}, state, {\r\n                hoveredShape: state.measureShapesActive ? action.shape : null\r\n            });\r\n        case ActionTypes.MOUSE_ROLL_OUT_SHAPE:\r\n            return Object.assign({}, state, {\r\n                hoveredShape: null\r\n            });\r\n        case ActionTypes.MOUSE_CLICKED_ON_SHAPE:\r\n            if (!state.measureShapesActive) {\r\n                return state;\r\n            }\r\n            // measureShapesActive\r\n\r\n            if (state.measureShapesFirstClick) {\r\n                return Object.assign({}, state, {\r\n                    firstMeasuredShape: action.shape,\r\n                    firstMeasuredLayer: action.layer,\r\n                    secondMeasuredShape: null,\r\n                    secondMeasuredLayer: null,\r\n                    measureShapesFirstClick: false,\r\n                    distance: undefined,\r\n                    shortestSegment: null\r\n                })\r\n            }\r\n            else {    // second click\r\n                if (action.shape === state.firstMeasuredShape) {\r\n                    return state;  // second click on the same shape\r\n                }\r\n\r\n                let shape1 = state.firstMeasuredShape.geom;\r\n                let shape2 = action.shape.geom;\r\n                let distance, shortestSegment;\r\n                // if (shape1 instanceof Flatten.Polygon && shape2 instanceof Flatten.Polygon) {\r\n                //     [distance, shortestSegment] = Flatten.Distance.polygon2polygon(shape1, shape2);\r\n                // }\r\n                // else {\r\n                [distance, shortestSegment] = Flatten.Distance.distance(shape1, shape2);\r\n                // }\r\n\r\n\r\n                return Object.assign({}, state, {\r\n                    secondMeasuredShape: action.shape,\r\n                    secondMeasuredLayer: action.layer,\r\n                    measureShapesFirstClick: true,\r\n                    distance: distance,\r\n                    shortestSegment: shortestSegment\r\n                });\r\n            }\r\n        case ActionTypes.MOUSE_DOWN_ON_STAGE:\r\n            if (state.hoveredShape || is_mobile) {\r\n                return state\r\n            }\r\n            else {\r\n                return Object.assign({}, state, {\r\n                    measureShapesFirstClick: true,\r\n                    firstMeasuredShape: null,\r\n                    firstMeasuredLayer: null,\r\n                    secondMeasuredShape: null,\r\n                    secondMeasuredLayer: null,\r\n                    distance: undefined,\r\n                    shortestSegment: null\r\n                });\r\n            }\r\n\r\n        case ActionTypes.DELETE_LAYER_BUTTON_PRESSED:\r\n            if (action.layer === state.firstMeasuredLayer ||\r\n                action.layer === state.secondMeasuredLayer) {\r\n                return Object.assign({}, defaultMeasureShapesTool);\r\n            }\r\n            else {\r\n                return state;\r\n            }\r\n\r\n        case ActionTypes.TOGGLE_DISPLAY_LAYER_PRESSED:\r\n            if (action.layer.displayed &&\r\n                (action.layer === state.firstMeasuredLayer ||\r\n                    action.layer === state.secondMeasuredLayer)) {\r\n                return Object.assign({}, defaultMeasureShapesTool);\r\n            }\r\n            else {\r\n                return state;\r\n            }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default measureShapesTool;","import * as ActionTypes from \"../actionTypes\";\r\n\r\nconst documentDefaultState = {\r\n    id: undefined,\r\n    name: \"\",\r\n    owner: \"Alex Bol\",\r\n    lastUpdated: undefined\r\n};\r\n\r\nconst cloudStorageDefaultState = {\r\n    document: documentDefaultState,\r\n    documentsList: {}\r\n};\r\n\r\nfunction isUpToDate(stateDocumentsList, actionDocumentsList) {\r\n    if (actionDocumentsList === null || actionDocumentsList === undefined)\r\n        return true;\r\n\r\n    if (Object.keys(stateDocumentsList).length !== Object.keys(actionDocumentsList).length)\r\n        return false;\r\n    for (let key in stateDocumentsList) {\r\n        if (!(actionDocumentsList.hasOwnProperty(key) && (stateDocumentsList[key].lastUpdated !== actionDocumentsList[key].lastUpdated))) {\r\n            return false\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nconst cloudStorage = (state = cloudStorageDefaultState, action) => {\r\n    switch (action.type) {\r\n        case ActionTypes.REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED:\r\n            return {\r\n                ...state,\r\n                document: {\r\n                    id: action.id,\r\n                    name: action.name,\r\n                    owner: action.owner,\r\n                    lastUpdated: action.lastUpdated\r\n                }\r\n            };\r\n\r\n        case ActionTypes.REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED:\r\n            return {\r\n                ...state,\r\n                document: {\r\n                    id: action.id,\r\n                    name: action.name,\r\n                    owner: action.owner,\r\n                    lastUpdated: action.lastUpdated\r\n                }\r\n            };\r\n\r\n        case ActionTypes.REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED:\r\n            return {\r\n                ...state,\r\n                document: {\r\n                    ...state.document,\r\n                    lastUpdated: action.lastUpdated\r\n                }\r\n            };\r\n\r\n        case ActionTypes.DOCUMENT_NAME_UPDATED:\r\n            return {\r\n                ...state,\r\n                document: {\r\n                    ...state.document,\r\n                    name: action.name\r\n                }\r\n            };\r\n\r\n        case ActionTypes.DELETE_DOCUMENT_FROM_DATABASE_SUCCEED:\r\n            let { [action.id]: document, ...newList } = state.documentsList;\r\n            return {\r\n                ...state,\r\n                document: state.document.id === action.id ? documentDefaultState : state.document,\r\n                documentsList: newList\r\n            };\r\n\r\n        case ActionTypes.DOCUMENT_SELECTED_FROM_LIST:\r\n            return {\r\n                ...state,\r\n                document: action.document\r\n            };\r\n\r\n        case ActionTypes.CLEAR_ALL_BUTTON_CLICKED:\r\n            return {\r\n                ...state,\r\n                document: documentDefaultState\r\n            };\r\n\r\n        case ActionTypes.REQUEST_FETCH_DOCUMENTS_FROM_DATABASE_SUCCEED:\r\n            return isUpToDate(state.documentsList, action.documentsList) ?\r\n                state :\r\n            {\r\n                ...state,\r\n                documentsList: action.documentsList\r\n            };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default cloudStorage","/**\r\n * Created by alexanderbol on 13/04/2017.\r\n */\r\n\r\nimport {combineReducers} from 'redux';\r\n\r\nimport auth from \"./reducers/auth\";\r\nimport app from \"./reducers/app\";\r\nimport layers from \"./reducers/layers\";\r\nimport mouse from \"./reducers/mouse\";\r\nimport measureShapesTool from \"./reducers/measureShapesTool\";\r\nimport cloudStorage from \"./reducers/cloudStorage\";\r\n\r\nconst reducer = combineReducers({\r\n    auth,\r\n    app,\r\n    layers,\r\n    cloudStorage,\r\n    measureShapesTool,\r\n    mouse\r\n});\r\n\r\nexport default reducer;\r\n","import axios from 'axios';\r\n\r\nconst instance = axios.create({\r\n    baseURL: \"https://debug-viewer.firebaseio.com/\"\r\n});\r\n\r\nexport default instance;\r\n","import * as ActionTypes from '../actionTypes';\r\n\r\nexport const resizeStage = () => {\r\n    return {\r\n        type: ActionTypes.STAGE_RESIZED\r\n    }\r\n};\r\n\r\nexport const destroyStage = () => {\r\n    return {\r\n        type: ActionTypes.STAGE_UNMOUNTED\r\n    }\r\n};\r\n\r\nexport const toggleUnits = () => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_UNITS_CLICKED\r\n    }\r\n};\r\n\r\nexport const toggleWidthMode = () => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_WIDTH_MODE_CLICKED\r\n    }\r\n};\r\n\r\nexport const toggleDisplayVertices = () => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_DISPLAY_VERTICES_CLICKED\r\n    }\r\n};\r\n\r\nexport const toggleDisplayLabels = () => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_DISPLAY_LABELS_CLICKED\r\n    }\r\n};\r\n\r\nexport const toggleAboutPopup = () => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_ABOUT_POPUP_CLICKED\r\n    }\r\n};\r\n\r\n// export const closeAboutPopup = () => {\r\n//     return {\r\n//         type: ActionTypes.CLOSE_ABOUT_POPUP_BUTTON_PRESSED\r\n//     }\r\n// };\r\n\r\nexport const toggleMeasureBetweenPoints = () => {\r\n    return {\r\n        type: ActionTypes.MEASURE_POINTS_BUTTON_PRESSED\r\n    }\r\n};\r\n\r\nexport const toggleMeasureBetweenShapes = () => {\r\n    return {\r\n        type: ActionTypes.MEASURE_SHAPES_BUTTON_PRESSED\r\n    }\r\n};\r\n\r\nexport const applySkeletonRecognition = () => {\r\n    return {\r\n        type: ActionTypes.SKELETON_RECOGNITION_BUTTON_PRESSED\r\n    }\r\n};\r\n\r\nexport const handleFileSelect = (files, stage, layers) => {\r\n    return {\r\n        type: ActionTypes.FILENAME_LIST_SELECTED,\r\n        files,\r\n        stage,\r\n        layers\r\n    }\r\n};\r\n\r\nexport const setHomeView = (stage, shape) => {\r\n    return {\r\n        type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n        stage,\r\n        shape\r\n    }\r\n};\r\n\r\nexport const togglePanByDrag = () => {\r\n    return {\r\n        type: ActionTypes.PAN_BY_DRAG_BUTTON_CLICKED\r\n    }\r\n};\r\n\r\nexport const handleMouseRollOverShape = (shape) => {\r\n    return {\r\n        type: ActionTypes.MOUSE_ROLL_OVER_SHAPE,\r\n        shape\r\n    }\r\n};\r\n\r\nexport const handleMouseRollOutShape = () => {\r\n    return {\r\n        type: ActionTypes.MOUSE_ROLL_OUT_SHAPE\r\n    }\r\n};\r\n\r\nexport const handleClickOnShape = (shape, layer) => {\r\n    return {\r\n        type: ActionTypes.MOUSE_CLICKED_ON_SHAPE,\r\n        shape,\r\n        layer\r\n    }\r\n};\r\n\r\nexport const asyncOperationStarted = () => {\r\n    return {\r\n        type: ActionTypes.ASYNC_OPERATION_STARTED\r\n    }\r\n};\r\n\r\nexport const asyncOperationEnded = () => {\r\n    return {\r\n        type: ActionTypes.ASYNC_OPERATION_ENDED\r\n    }\r\n};\r\n\r\nexport const openDocumentOnCloud = () => {\r\n    return {\r\n        type: ActionTypes.MANAGE_CLOUD_STORAGE_BUTTON_CLICKED\r\n    }\r\n};\r\n\r\nexport const toggleLayerList = () => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_SHOW_LAYER_LIST_CLICKED\r\n    }\r\n};\r\n\r\n\r\n","import * as ActionTypes from '../actionTypes';\r\n\r\nexport const addEmptyLayer = (stage) => {\r\n    return {\r\n        type: ActionTypes.ADD_LAYER_BUTTON_PRESSED,\r\n        stage: stage\r\n    }\r\n};\r\n\r\nexport const addNewLayer = (layer) => {\r\n    return {\r\n        type: ActionTypes.ADD_NEW_LAYER,\r\n        layer\r\n    }\r\n};\r\n\r\nexport const deleteAffectedLayer = () => {\r\n    return {\r\n        type: ActionTypes.DELETE_LAYER_BUTTON_PRESSED\r\n    };\r\n};\r\n\r\nexport const sortLayers = () => {\r\n    return {\r\n        type: ActionTypes.SORT_LAYERS_BUTTON_PRESSED\r\n    };\r\n};\r\n\r\nexport const toggleDisplayLayer = (layer) => {\r\n    return {\r\n        type: ActionTypes.TOGGLE_DISPLAY_LAYER_PRESSED,\r\n        layer\r\n    }\r\n};\r\n\r\nexport const toggleAffectedLayer = (event, layer) => {\r\n    event.stopPropagation();\r\n    return {\r\n        type: ActionTypes.TOGGLE_AFFECTED_LAYER_PRESSED,\r\n        layer: layer\r\n    };\r\n};\r\n\r\nexport const updateLayer = (newLayer) => {\r\n    return {\r\n        type: ActionTypes.SUBMIT_LAYER_EDIT_FORM_PRESSED,\r\n        newLayer: newLayer\r\n    };\r\n};\r\n\r\nexport const closeEditLayerForm = () => {\r\n    return {\r\n        type: ActionTypes.ESCAPE_LAYER_EDIT_FORM_PRESSED\r\n    };\r\n};\r\n\r\nexport const openAffectedLayerEditForm = () => {\r\n    return {\r\n        type: ActionTypes.OPEN_LAYER_EDIT_FORM_PRESSED,\r\n    }\r\n};\r\n\r\nexport const setAffectedNextLayer = () => {\r\n    return {\r\n        type: ActionTypes.LAYERS_LIST_ARROW_DOWN_PRESSED\r\n    }\r\n};\r\n\r\nexport const setAffectedPrevLayer = () => {\r\n    return {\r\n        type: ActionTypes.LAYERS_LIST_ARROW_UP_PRESSED\r\n    }\r\n};\r\n\r\nexport const deleteAllLayers = () => {\r\n    return {\r\n        type: ActionTypes.CLEAR_ALL_BUTTON_CLICKED,\r\n    }\r\n}\r\n\r\n\r\n\r\n","// import { Job } from '../models/job';\r\nimport Flatten from '@flatten-js/core';\r\n\r\nimport Model from '../models/model';\r\n\r\nFlatten.Image = class Image {\r\n    constructor() {\r\n        this.uri = \"\";\r\n        /**\r\n         * Center in world coordinates\r\n         * @type {Flatten.Point}\r\n         */\r\n        this.center = new Flatten.Point();\r\n        /**\r\n         * Width in world units (inch/mm)\r\n         */\r\n        this.width = 0;\r\n        /**\r\n         * Height in world units (inch/mm)\r\n         */\r\n        this.height = 0;\r\n    }\r\n    get box() {\r\n        return new Flatten.Box(\r\n            this.center.x - this.width/2,\r\n            this.center.y - this.height/2,\r\n            this.center.x + this.height/2,\r\n            this.center.y + this.height/2\r\n        );\r\n\r\n    }\r\n};\r\n\r\nexport function parseJSON(shapes) {\r\n    let models = [];\r\n    let geom;\r\n    let model;\r\n    for (let shape of JSON.parse(shapes)) {\r\n        if (shape.geom instanceof Array) {      // TODO: add \"name\" to polygon stringified\r\n            geom = new Flatten.Polygon();\r\n            for (let faceArray of shape.geom) {\r\n                geom.addFace(faceArray);\r\n            }\r\n        }\r\n        else if (shape.geom.uri) {\r\n            geom = new Flatten.Image();\r\n            geom.uri = shape.geom.uri;\r\n            geom.center = shape.geom.center;\r\n            geom.width = shape.geom.width;\r\n            geom.height = shape.geom.height;\r\n        }\r\n        else {\r\n            geom = Flatten[shape.geom.name](shape.geom);\r\n        }\r\n        model = new Model(geom, shape.style, shape.label);\r\n        models.push(model);\r\n    }\r\n\r\n    return models;\r\n}\r\n","import * as ActionTypes from \"../actionTypes\";\r\nimport axios from \"../../axios-database\";\r\nimport * as appActions from \"../actions/appActions\";\r\nimport * as layerActions from '../../store/actions/layersActions';\r\nimport Layer from \"../../models/layer\";\r\nimport {parseJSON} from \"../../dataParsers/parseJSON\";\r\nimport Layers from \"../../models/layers\";\r\n\r\nconst defaultName = \"document\";\r\n\r\nexport const getNewName = (documents) => {\r\n    let name = defaultName;\r\n    let inc = 1;\r\n    let comparator = (document) => document.name === name;\r\n    while (Object.values(documents).find(comparator)) {\r\n        name = defaultName + inc;\r\n        inc++;\r\n    }\r\n    return name;\r\n};\r\n\r\nexport const registerDocumentAddedToDatabase = (id, lastUpdated) => {\r\n    return {\r\n        type: ActionTypes.REQUEST_ADD_DOCUMENT_TO_DATABASE_SUCCEED,\r\n        id: id,\r\n        lastUpdated: lastUpdated\r\n    }\r\n};\r\n\r\nexport const updateDocumentTimeStamp = (lastUpdated) => {\r\n    return {\r\n        type: ActionTypes.REQUEST_UPDATE_DOCUMENT_IN_DATABASE_SUCCEED,\r\n        lastUpdated: lastUpdated\r\n    }\r\n};\r\n\r\nexport const updateDocumentName = (name) => {\r\n    return {\r\n        type: ActionTypes.DOCUMENT_NAME_UPDATED,\r\n        name\r\n    }\r\n};\r\n\r\nexport const clearCurrentDocument = () => {\r\n    return {\r\n        type: ActionTypes.CLEAR_ALL_BUTTON_CLICKED,\r\n    }\r\n};\r\n\r\nexport const updateCurrentDocument = (document) => {\r\n    return {\r\n        type: ActionTypes.DOCUMENT_SELECTED_FROM_LIST,\r\n        document\r\n    }\r\n};\r\n\r\nexport const requestFetchDocumentFromDatabaseSucceed = (id, name, owner, lastUpdated) => {\r\n    return {\r\n        type: ActionTypes.REQUEST_FETCH_DOCUMENT_FROM_DATABASE_SUCCEED,\r\n        id,\r\n        name,\r\n        owner,\r\n        lastUpdated\r\n    }\r\n};\r\n\r\nexport const deleteDocumentFromDatabaseSucceed = (id) => {\r\n    return {\r\n        type: ActionTypes.DELETE_DOCUMENT_FROM_DATABASE_SUCCEED,\r\n        id\r\n    }\r\n};\r\n\r\nexport const requestFetchDocumentsFromDatabaseSucceed = (documentsList) => {\r\n    return {\r\n        type: ActionTypes.REQUEST_FETCH_DOCUMENTS_FROM_DATABASE_SUCCEED,\r\n        documentsList\r\n    }\r\n};\r\n\r\nexport const fetchDocumentsFromDatabase = (token, userId) => {\r\n    return dispatch => {\r\n        dispatch(appActions.asyncOperationStarted());\r\n        const queryParams = '?auth=' + token + '&orderBy=\"userId\"&equalTo=\"' + userId + '\"';\r\n        const url = '/documents.json' + queryParams;\r\n        axios.get(url)\r\n            .then(response => {\r\n                dispatch(requestFetchDocumentsFromDatabaseSucceed(response.data));\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n            .catch(error => {\r\n                alert(error.message);\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n    }\r\n};\r\n\r\nexport const deleteDocumentFromDatabase = (id) => {\r\n    return dispatch => {\r\n        dispatch(appActions.asyncOperationStarted());\r\n        const url = '/documents/' + id + '.json';\r\n        axios.delete(url)\r\n            .then (response => {\r\n                // query geom by \"id\"\r\n                const queryParams = '?orderBy=\"id\"&equalTo=\"' + id + '\"';\r\n                const url = '/geom.json' + queryParams;\r\n                return axios.get(url)\r\n            })\r\n            .then (response => {\r\n                const geomId = Object.keys(response.data)[0];\r\n                return axios.delete(`/geom/${geomId}.json`)\r\n            })\r\n            .then(response => {\r\n                dispatch(deleteDocumentFromDatabaseSucceed(id));\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n            .catch(error => {\r\n                alert(error.message);\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n    }\r\n};\r\n\r\nexport const fetchDocumentFromDatabase = (stage, id) => {\r\n    return dispatch => {\r\n        dispatch(layerActions.deleteAllLayers());\r\n        dispatch(appActions.asyncOperationStarted());\r\n        let name = \"\";\r\n        let lastUpdated = undefined;\r\n        let owner = \"Alex Bol\";\r\n        let firstLayer = undefined;\r\n\r\n        const docUrl = '/documents/' + id + '.json';\r\n        const queryParams = '?orderBy=\"id\"&equalTo=\"' + id + '\"';\r\n        const geomUrl = '/geom.json' + queryParams;\r\n        Promise.all([axios.get(docUrl),axios.get(geomUrl)])\r\n            .then( responses => {\r\n                name = responses[0].data.name;\r\n                lastUpdated = responses[0].data.lastUpdated;\r\n\r\n                for (let layerData of Object.values(responses[1].data)[0].layers) {\r\n                    let layer = new Layer();\r\n                    layer.shapes = parseJSON(layerData.shapes);\r\n                    layer.name = layerData.name;\r\n\r\n                    if (!firstLayer) firstLayer = layer;\r\n                    dispatch(layerActions.addNewLayer(layer));\r\n                    dispatch(layerActions.toggleDisplayLayer(layer));\r\n                }\r\n                dispatch(requestFetchDocumentFromDatabaseSucceed(id, name, owner, lastUpdated));\r\n                dispatch(appActions.setHomeView(stage, firstLayer));\r\n                // dispatch(layerActions.toggleDisplayLayer(firstLayer));\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n            .catch(error => {\r\n                alert(error.message);\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n    }\r\n};\r\n\r\nexport const addDocumentToDatabase = (payload, layers, history) => {\r\n    return dispatch => {\r\n        let id = undefined;\r\n        dispatch(appActions.asyncOperationStarted());\r\n        axios.post('/documents.json', payload)\r\n            .then(response => {\r\n                id = response.data.name;\r\n                let layersJSON = Layers.toJSON(layers);\r\n                let geomPayload = {\r\n                    id: id,\r\n                    layers: layersJSON\r\n                };\r\n                return axios.post('/geom.json', geomPayload)\r\n            })\r\n            .then(response => {\r\n                dispatch(registerDocumentAddedToDatabase(id, Date.now()));\r\n                dispatch(appActions.asyncOperationEnded());\r\n\r\n                // update url\r\n                history.push('/documents/' + id);\r\n            })\r\n            .catch(error => {\r\n                alert(error.message);\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n    }\r\n};\r\n\r\nexport const updateDocumentInDatabase = (id, payload, layers) => {\r\n    return dispatch => {\r\n        dispatch(appActions.asyncOperationStarted());\r\n        // update documents header\r\n        axios.put(`/documents/${id}.json`, payload)\r\n            .then(response => {\r\n                dispatch(updateDocumentTimeStamp(Date.now()));\r\n                // dispatch(appActions.asyncOperationEnded());\r\n\r\n                // query geom by \"id\"\r\n                const queryParams = '?orderBy=\"id\"&equalTo=\"' + id + '\"';\r\n                const url = '/geom.json' + queryParams;\r\n                return axios.get(url)\r\n            })\r\n            .then( response => {\r\n                let layersJSON = Layers.toJSON(layers);\r\n                let geomPayload = {\r\n                    id: id,\r\n                    layers: layersJSON\r\n                };\r\n                let geomId = Object.keys(response.data)[0];  // response.data.name;\r\n                return axios.put(`/geom/${geomId}.json`, geomPayload)\r\n            })\r\n            .then( reponse => {\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n            .catch(error => {\r\n                alert(error.message);\r\n                dispatch(appActions.asyncOperationEnded());\r\n            })\r\n    }\r\n};\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport FontAwesome from \"react-fontawesome\";\r\nimport classes from \"./Button.module.css\";\r\n\r\nconst button = (props) => {\r\n    let iconStyle;\r\n    switch (props.type) {\r\n        case \"trigger\":\r\n            iconStyle = classes.IconTrigger;\r\n            break;\r\n        case \"mode\":\r\n            iconStyle = props.active ? classes.IconModeActive : classes.IconModeNotActive;\r\n            break;\r\n        default:\r\n            iconStyle = classes.IconTrigger;\r\n            break;\r\n    }\r\n    // eslint-disable-next-line\r\n    let buttonStyle = props.mobileOnly ? classes[\"Button\",\"DrawerButton\"] : classes[\"Button\"];\r\n    return (\r\n        <button title={props.title} onClick={props.onClick} className={buttonStyle}>\r\n            <FontAwesome\r\n                name={props.iconName}\r\n                size='2x'\r\n                className={iconStyle}\r\n            />\r\n        </button>\r\n    );\r\n};\r\n\r\nexport default button;","import React from 'react';\r\nimport FontAwesome from \"react-fontawesome\";\r\nimport classes from \"./ButtonSeparator.module.css\";\r\n\r\nconst buttonSeparator = () => {\r\n    return (\r\n        <div className={classes.ButtonSeparator}>\r\n            <FontAwesome\r\n                name='ellipsis-v'\r\n                size='2x'\r\n                className={classes.IconSeparator}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default buttonSeparator;","/**\r\n * Created by alexanderbol on 17/04/2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport Button from '../../../components/UI/Button/Button';\r\nimport Separator from '../../../components/UI/ButtonSeparator/ButtonSeparator';\r\n\r\nimport classes from './ToolbarComponent.module.css';\r\nimport '@fortawesome/fontawesome-free/css/all.css';\r\n\r\nclass ToolbarComponent extends Component {\r\n    openJobButtonClicked = () => this.refs.browseFiles.click();\r\n\r\n    render() {\r\n        return (\r\n            <div className={classes[\"App-toolbar\"]}>\r\n                <Button type=\"trigger\" mobileOnly title=\"Show layers list\" iconName='list' onClick={this.props.onLayerListButtonClicked} />\r\n\r\n                {/*<h4>Toolbar</h4>*/}\r\n                <Button type=\"trigger\" title=\"Open files\" iconName='folder-open'\r\n                        onClick={this.openJobButtonClicked}\r\n                />\r\n\r\n                <input style={{fontSize: 16, marginTop: 5, marginBottom: 5, display: \"none\"}}\r\n                       type=\"file\" id=\"browseFiles\" ref=\"browseFiles\" name=\"files[]\" multiple\r\n                       onChange={this.props.onFileSelected}\r\n                />\r\n\r\n                {/*<Button type=\"trigger\" title=\"Save document on cloud\" iconName='save'*/}\r\n                        {/*onClick={this.props.onSaveDocumentButtonClicked}*/}\r\n                {/*/>*/}\r\n\r\n                <Button type=\"trigger\" title=\"Clean current document\" iconName='broom'\r\n                        onClick={this.props.onClearAllButtonClicked}\r\n                />\r\n\r\n                <Separator/>\r\n\r\n                <Button type=\"trigger\" title=\"Zoom and pan to home view\" iconName='home'\r\n                        onClick={this.props.onHomeButtonPressed}\r\n                />\r\n\r\n                <Separator/>\r\n\r\n                <Button type=\"mode\" title=\"Pan by drag\" iconName='hand-paper'\r\n                        active={!this.props.measurePointsActive}\r\n                        onClick={this.props.onPanByDragPressed}\r\n                />\r\n\r\n                <Button type=\"mode\" title=\"Measure distance\" iconName='hand-lizard'\r\n                        active={this.props.measurePointsActive}\r\n                        onClick={this.props.onMeasurePointsButtonPressed}\r\n                />\r\n\r\n                <Separator/>\r\n\r\n                <Button type=\"trigger\" title=\"Measure distance between shapes\" iconName='ruler'\r\n                        onClick={this.props.onMeasureBetweenShapesButtonPressed}\r\n                />\r\n\r\n                <Button type=\"trigger\" title=\"Display solid or wire\" iconName='fill-drip'\r\n                        onClick={this.props.onToggleWidthModePressed}\r\n                />\r\n\r\n                <Button type=\"trigger\" title=\"Display vertices on/off\" iconName='draw-polygon'\r\n                        onClick={this.props.onToggleVerticesPressed}\r\n                />\r\n\r\n                <Button type=\"trigger\" title=\"Display labels on/off\" iconName='tag'\r\n                        onClick={this.props.onToggleLabelsPressed}\r\n                />\r\n\r\n                {this.props.showSkeletonRecognitionButton ? (\r\n                    <Button type=\"trigger\" title=\"Skeleton Recognition Demo\" iconName='tree'\r\n                            onClick={this.props.onSkeletonRecognitionButtonPressed}\r\n                    />\r\n                ) : null}\r\n\r\n                <Separator/>\r\n\r\n                <button className={classes[\"App-toolbar-units\"]}\r\n                        onClick={this.props.onUnitClicked}\r\n                >\r\n                    {this.props.units}\r\n                </button>\r\n\r\n                <Separator/>\r\n\r\n                <Button type=\"trigger\" title=\"About\" iconName='info'\r\n                        onClick={this.props.onShowAboutPopupPressed}\r\n                />\r\n\r\n                <Separator/>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default ToolbarComponent;","/**\r\n * Created by alexanderbol on 21/04/2017.\r\n */\r\nimport {Box} from '@flatten-js/core';\r\nimport { Stage as CreatejsStage, Touch } from \"@createjs/easeljs\";\r\n\r\nclass Stage extends CreatejsStage {\r\n    constructor(canvas) {\r\n        super(canvas);\r\n\r\n        Touch.enable(this);\r\n        this.mouseMoveOutside = false;   // true;\r\n        // this.enableDOMEvents(false);\r\n        this.enableMouseOver(20);\r\n\r\n        if (this.canvas.clientWidth > 0 && this.canvas.clientHeight > 0) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n            // this.updateViewport(this.canvas.width, this.canvas.height);\r\n        }\r\n        this.origin = {x: this.canvas.width / 2, y: this.canvas.height / 2};\r\n        this.resolution = 0.00001;          // MM 2 Pixels when zoomFactor = 1;\r\n        this.zoomFactor = 1.0;\r\n\r\n        this.oldOrigin = {x: undefined, y: undefined};   // used by pan\r\n        // used by zoom by pinch\r\n        this.oldZoomFactor = undefined;\r\n        this.pinchAnchorX = undefined;\r\n        this.pinchAnchorY = undefined;\r\n        this.pinchStarted = false;\r\n    }\r\n\r\n    get box() {\r\n        let minX = this.C2W_X(0);\r\n        let minY = this.C2W_Y(this.canvas.height);\r\n        let maxX = this.C2W_X(this.canvas.width);\r\n        let maxY = this.C2W_Y(0);\r\n\r\n        return ( new Box(minX, minY, maxX, maxY) );\r\n    }\r\n\r\n    clone() {\r\n        let stage = new Stage(this.canvas);\r\n        return Object.assign(stage, this);\r\n    }\r\n\r\n    add(shape) {\r\n        this.addChild(shape);\r\n        return this;\r\n    }\r\n\r\n    scalingFactor() {\r\n        return this.resolution * this.zoomFactor;\r\n    }\r\n\r\n    C2W_Scalar(scalar) {\r\n        return (scalar / this.scalingFactor());\r\n    }\r\n\r\n    W2C_Scalar(scalar) {\r\n        return (this.scalingFactor() * scalar);\r\n    }\r\n\r\n    C2W_X(canvasX) {\r\n        return ((canvasX - this.origin.x) / this.scalingFactor());\r\n    }\r\n\r\n    C2W_Y(canvasY) {\r\n        return ((this.origin.y - canvasY) / this.scalingFactor());\r\n    }\r\n\r\n    W2C_X(worldX) {\r\n        return (this.scalingFactor() * worldX + this.origin.x);\r\n    }\r\n\r\n    W2C_Y(worldY) {\r\n        return (this.origin.y - this.scalingFactor() * worldY);\r\n    }\r\n\r\n    W2C(point) {\r\n        return {x: this.W2C_X(point.x), y: this.W2C_Y(point.y)}\r\n    }\r\n\r\n    panTo(newOrigin) {\r\n        this.origin = {x: newOrigin.x, y: newOrigin.y}\r\n    }\r\n\r\n    panBy(deltaX, deltaY) {\r\n        this.origin = {\r\n            x: this.origin.x + deltaX,\r\n            y: this.origin.y + deltaY\r\n        }\r\n    }\r\n\r\n    // zoom by 10% each time\r\n    zoomIn(ratio) {\r\n        let curRatio = ratio || 1.1;\r\n        this.zoomFactor = Math.min(10000000, curRatio * this.zoomFactor);\r\n    }\r\n\r\n    zoomOut(ratio) {\r\n        let curRatio = ratio || 1.1;\r\n        this.zoomFactor = Math.max(0.001, this.zoomFactor / curRatio);\r\n    }\r\n\r\n    // ZoomIn/Out + \"Focus follows mouse\"\r\n    zoom(focusX, focusY, bIn, ratio) {\r\n        let worldX = this.C2W_X(focusX);    // world coordinate of mouse focus before zoom\r\n        let worldY = this.C2W_Y(focusY);\r\n\r\n        bIn ? this.zoomIn(ratio) : this.zoomOut(ratio);\r\n\r\n        let newFocusX = this.W2C_X(worldX); // canvas coordinate after zoom\r\n        let newFocusY = this.W2C_Y(worldY);\r\n\r\n        this.panBy(focusX - newFocusX, focusY - newFocusY);\r\n\r\n        return [newFocusX, newFocusY];\r\n    }\r\n\r\n    zoomByMouse(focusX, focusY, bIn, ratio) {\r\n        this.zoom(focusX, focusY, bIn, ratio);\r\n    }\r\n\r\n    zoomToLimits(width, height) {\r\n        // prevent zero division in case of single point box\r\n        if (width === 0) width = 400000;\r\n        if (height === 0) height = 400000;\r\n        let resolution = Math.min(this.canvas.width / (1.1*width), this.canvas.height / (1.1*height));\r\n        let zoomFactor = resolution / this.resolution;\r\n        let ratio = zoomFactor / this.zoomFactor;\r\n        let bIn = true; //ratio > 1;\r\n\r\n        let focusX = this.canvas.width/2;\r\n        let focusY = this.canvas.height/2;\r\n        this.zoom(focusX, focusY, bIn, ratio);\r\n    }\r\n\r\n    resize() {\r\n        // this.origin.x = this.canvas.width / 2;\r\n        // this.origin.y = this.canvas.height / 2;\r\n        if (this.canvas.clientWidth > 0 && this.canvas.clientHeight > 0) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n        }\r\n    }\r\n\r\n    // drawSomething() {\r\n    //     let shape = new Shape();\r\n    //     shape.graphics.beginFill('red').drawRect(0, 0, 20, 20);\r\n    //     this.addChild(shape);\r\n    //     this.update();\r\n    // }\r\n\r\n    panByMouseStart() {\r\n        this.oldOrigin.x = this.origin.x;\r\n        this.oldOrigin.y = this.origin.y;\r\n        this.zoomByPinchStop();\r\n    }\r\n\r\n    panByMouseMove(dx, dy) {\r\n        if (this.pinchStarted) return;\r\n        if (dx !== undefined && dy !== undefined &&\r\n            this.oldOrigin.x !== undefined && this.oldOrigin.y !== undefined) {\r\n            this.origin = {\r\n                    x: this.oldOrigin.x + dx,\r\n                    y: this.oldOrigin.y + dy\r\n                };\r\n        }\r\n    }\r\n\r\n    panByMouseStop() {\r\n        this.oldOrigin.x = undefined;\r\n        this.oldOrigin.y = undefined;\r\n    }\r\n\r\n    panToCoordinate(x, y) {\r\n        let canvasX = this.W2C_X(x);\r\n        let canvasY = this.W2C_Y(y);\r\n\r\n        let dx = this.canvas.width / 2 - canvasX;\r\n        let dy = this.canvas.height / 2 - canvasY;\r\n        this.panBy(dx, dy);\r\n    }\r\n\r\n    zoomByPinchStart(canvasX, canvasY) {\r\n        this.oldZoomFactor = this.zoomFactor;\r\n        this.pinchAnchorX = this.C2W_X(canvasX);\r\n        this.pinchAnchorY = this.C2W_Y(canvasY);\r\n        this.pinchStarted = true;\r\n        this.panByMouseStop();\r\n    }\r\n\r\n    zoomByPinchMove(canvasX, canvasY, ratio) {\r\n        this.zoomFactor = ratio * this.oldZoomFactor;\r\n        this.origin = {\r\n            x: canvasX - this.scalingFactor() * this.pinchAnchorX,\r\n            y: canvasY + this.scalingFactor() * this.pinchAnchorY\r\n        }\r\n    }\r\n\r\n    zoomByPinchStop() {\r\n        this.oldZoomFactor = undefined;\r\n        this.pinchAnchorX = undefined;\r\n        this.pinchAnchorY = undefined;\r\n        this.pinchStarted = false;\r\n    }\r\n\r\n    clear() {\r\n        this.canvas.getContext('2d').clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n}\r\n\r\nexport default Stage;\r\n","import * as ActionTypes from '../actionTypes';\r\n\r\nexport const registerStage = (stage) => {\r\n    return {\r\n        type: ActionTypes.NEW_STAGE_CREATED,\r\n        stage: stage\r\n    }\r\n};\r\n\r\nexport const handleMouseDown = (stage, x, y) => {\r\n    return {\r\n        type: ActionTypes.MOUSE_DOWN_ON_STAGE,\r\n        stage: stage,\r\n        x: x,\r\n        y: y\r\n    }\r\n};\r\n\r\nexport const handleMouseUp = (stage, x, y) => {\r\n    return {\r\n        type: ActionTypes.MOUSE_UP_ON_STAGE,\r\n        stage: stage,\r\n        x: x,\r\n        y: y\r\n    }\r\n};\r\n\r\nexport const handleMouseMove = (stage, x, y, dx, dy) => {\r\n    return {\r\n        type: ActionTypes.MOUSE_MOVED_ON_STAGE,\r\n        stage: stage,\r\n        x: x,\r\n        y: y,\r\n        dx: dx,\r\n        dy: dy\r\n    }\r\n};\r\n\r\nexport const handleMouseWheelMove = (stage, x, y, delta) => {\r\n    return {\r\n        type: ActionTypes.MOUSE_WHEEL_MOVE_ON_STAGE,\r\n        stage: stage,\r\n        x: x,\r\n        y: y,\r\n        delta: delta\r\n    }\r\n};\r\n\r\nexport const handlePinchDown = (stage, touchPoints) => {\r\n    return {\r\n        type: ActionTypes.PINCH_DOWN_ON_STAGE,\r\n        stage: stage,\r\n        x1: touchPoints[0].x,\r\n        y1: touchPoints[0].y,\r\n        x2: touchPoints[1].x,\r\n        y2: touchPoints[1].y\r\n    }\r\n};\r\n\r\nexport const handlePinchMove = (stage, touchPoints) => {\r\n    return {\r\n        type: ActionTypes.PINCH_MOVED_ON_STAGE,\r\n        stage: stage,\r\n        x1: touchPoints[0].x,\r\n        y1: touchPoints[0].y,\r\n        x2: touchPoints[1].x,\r\n        y2: touchPoints[1].y\r\n    }\r\n};\r\n\r\nexport const handlePinchUp = (stage) => {\r\n    return {\r\n        type: ActionTypes.PINCH_UP_ON_STAGE,\r\n        stage\r\n    }\r\n};\r\n\r\n","/**\r\n * Created by alexanderbol on 21/04/2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport styles from \"./CanvasComponent.module.css\";\r\nimport Stage from '../../../models/stage';\r\nimport { connect } from \"react-redux\";\r\n// import * as ActionTypes from \"../../../store/actionTypes\";\r\nimport * as actions from '../../../store/actions/stageActions';\r\n\r\nclass CanvasComponent extends Component {\r\n    canvasElement = React.createRef();\r\n\r\n    handleMouseMove = (event) => {\r\n        this.props.stage.canvas.focus();\r\n        if (!event.nativeEvent.touches || event.nativeEvent.touches.length === 1) {\r\n            this.props.handleMouseMove(\r\n                this.props.stage,\r\n                event.stageX,\r\n                event.stageY,\r\n                this.props.mouse.startX ? event.stageX - this.props.mouse.startX : undefined,\r\n                this.props.mouse.startY ? event.stageY - this.props.mouse.startY : undefined\r\n            );\r\n        }\r\n        else if (event.nativeEvent.touches && event.nativeEvent.touches.length === 2) {\r\n            let touchPoints = [\r\n                {\r\n                    x: event.nativeEvent.touches[0].clientX - event.nativeEvent.target.offsetLeft,\r\n                    y: event.nativeEvent.touches[0].clientY - event.nativeEvent.target.offsetTop\r\n                },\r\n                {\r\n                    x: event.nativeEvent.touches[1].clientX - event.nativeEvent.target.offsetLeft,\r\n                    y: event.nativeEvent.touches[1].clientY - event.nativeEvent.target.offsetTop\r\n                },\r\n            ];\r\n            this.props.handlePinchMove(this.props.stage, touchPoints);\r\n        }\r\n\r\n        // if (this.props.stage.pinchStarted) {\r\n        //     this.props.handleSecondTouchMove(this.props.stage, event.stageX, event.stageY);\r\n        // }\r\n        // else {\r\n        //     this.props.handleMouseMove(\r\n        //         this.props.stage,\r\n        //         event.stageX,\r\n        //         event.stageY,\r\n        //         this.props.mouse.startX ? event.stageX - this.props.mouse.startX : undefined,\r\n        //         this.props.mouse.startY ? event.stageY - this.props.mouse.startY : undefined\r\n        //     );\r\n        // }\r\n    };\r\n\r\n    handleMouseDown = (event) => {\r\n        // if (event.pointerID === -1 || event.pointerID === 0) {\r\n        if (!event.nativeEvent.touches || event.nativeEvent.touches.length === 1) {\r\n            this.props.handleMouseDown(this.props.stage, event.stageX, event.stageY);\r\n        }\r\n        else if (event.nativeEvent.touches && event.nativeEvent.touches.length === 2) {\r\n            let touchPoints = [\r\n                {\r\n                    x: event.nativeEvent.touches[0].clientX - event.nativeEvent.target.offsetLeft,\r\n                    y: event.nativeEvent.touches[0].clientY - event.nativeEvent.target.offsetTop\r\n                },\r\n                {\r\n                    x: event.nativeEvent.touches[1].clientX - event.nativeEvent.target.offsetLeft,\r\n                    y: event.nativeEvent.touches[1].clientY - event.nativeEvent.target.offsetTop\r\n                },\r\n            ];\r\n            this.props.handlePinchDown(this.props.stage, touchPoints);\r\n        }\r\n    };\r\n\r\n    handleMouseUp = (event) => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        if (!event.nativeEvent.touches || event.nativeEvent.touches.length === 1) {\r\n            this.props.handleMouseUp(this.props.stage);\r\n        }\r\n        else if (event.nativeEvent.touches && event.nativeEvent.touches.length === 2) {\r\n            this.props.handlePinchUp(this.props.stage);\r\n        }\r\n    };\r\n\r\n    handleMouseLeave = (event) => {   // nothing works except click\r\n        this.props.stage.canvas.blur();\r\n        document.body.focus();\r\n    };\r\n\r\n    handleMouseWheel = (event) => {\r\n        /*event.preventDefault();*/\r\n\r\n        let delta = event.detail || event.wheelDelta;\r\n        if (delta !== 0) {\r\n            this.props.handleMouseWheelMove(this.props.stage, event.offsetX, event.offsetY, delta);\r\n        }\r\n    };\r\n\r\n    handleMouseWheelFox = (event) => {\r\n        /*event.preventDefault();*/\r\n        if (event.detail !== 0) {\r\n            this.props.handleMouseWheelMove(this.props.stage, event.layerX, event.layerY, -event.detail);\r\n        }\r\n    };\r\n\r\n    componentDidMount() {\r\n        let stage = new Stage(this.canvasElement.current);\r\n\r\n        // stage.setClearColor(\"#FFFFFF\");\r\n        // stage.update();\r\n\r\n        stage.on(\"stagemousedown\", this.handleMouseDown);\r\n        stage.on(\"stagemousemove\", this.handleMouseMove);\r\n        // stage.on(\"click\", this.handleMouseDown);\r\n        stage.on(\"stagemouseup\", this.handleMouseUp);\r\n        stage.on(\"mouseleave\", this.handleMouseLeave);\r\n        stage.canvas.addEventListener(\"mousewheel\", this.handleMouseWheel, {passive: true});\r\n        stage.canvas.addEventListener(\"DOMMouseScroll\", this.handleMouseWheelFox, {passive: true});\r\n\r\n        this.props.registerStage(stage);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <canvas\r\n                tabIndex=\"1\"\r\n                ref={this.canvasElement}\r\n                id=\"mainCanvas\"\r\n                className={styles[\"App-canvas\"]}\r\n                width=\"100\"\r\n                height=\"100\"\r\n            >\r\n            </canvas>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        stage: state.app.stage,\r\n        mouse: state.mouse\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        registerStage: (stage) => dispatch(actions.registerStage(stage)),\r\n        handleMouseDown: (stage, x, y) => dispatch(actions.handleMouseDown(stage, x, y)),\r\n        handleMouseUp: (stage, x, y) => dispatch(actions.handleMouseUp(stage, x, y)),\r\n        handleMouseMove: (stage, x, y, dx, dy) => dispatch(actions.handleMouseMove(stage, x, y, dx, dy)),\r\n        handleMouseWheelMove: (stage, x, y, delta) => dispatch(actions.handleMouseWheelMove(stage, x, y, delta)),\r\n        handlePinchDown: (stage, touchPoints) => dispatch(actions.handlePinchDown(stage, touchPoints)),\r\n        handlePinchMove: (stage, touchPoints) => dispatch(actions.handlePinchMove(stage, touchPoints)),\r\n        handlePinchUp: (stage) => dispatch(actions.handlePinchUp(stage))\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CanvasComponent);\r\n","/**\r\n * Created by alexanderbol on 17/06/2017.\r\n */\r\nimport React from 'react';\r\nimport styles from './StatusComponent.module.css';\r\n\r\nconst StatusComponent = () => {\r\n    return (\r\n        <div className={styles[\"App-status-bar\"]}>\r\n            <div>\r\n                <h5>\r\n                    &nbsp;\r\n                </h5>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default StatusComponent;","import React, {Component} from 'react';\r\n// import Utils from \"../utils\";\r\n\r\nclass StageComponent extends Component {\r\n    // shouldComponentUpdate useless because always returns \"true\",\r\n    // Don't know why, maybe because of children?\r\n    // ----------------------------------------------------------\r\n    // shouldComponentUpdate(nextProps, nextState) {\r\n    //     if (Utils.is_equal(this.props, nextProps)) {\r\n    //         return false;\r\n    //     }\r\n    //     return true;\r\n    // }\r\n\r\n    componentDidUpdate() {\r\n        if (this.props.stage.canvas && this.props.stage.canvas.getContext('2d')) {\r\n\r\n            let origin = this.props.stage.origin;\r\n            let zoomFactor = this.props.stage.zoomFactor*this.props.stage.resolution;\r\n            this.props.stage.setTransform(origin.x, origin.y, zoomFactor, -zoomFactor);\r\n\r\n            this.props.stage.update();\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.onStageUnmounted();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <React.Fragment>\r\n                {this.props.children}\r\n            </React.Fragment>\r\n        )\r\n    }\r\n}\r\n\r\nexport default StageComponent;","import {Point, Segment, Circle, Arc, Polygon, Box} from '@flatten-js/core';\r\nimport {Graphics} from '@createjs/easeljs';\r\n\r\n/* Provide conversion methods from FlattenJS objects to CreateJS Graphics */\r\nexport function graphics(shape, style = undefined) {\r\n    if (shape instanceof Point) {\r\n        return graphics_point(shape, style);\r\n    }\r\n    if (shape instanceof Segment) {\r\n        return graphics_segment(shape, style);\r\n    }\r\n    if (shape instanceof Arc) {\r\n        return graphics_arc(shape, style);\r\n    }\r\n    if (shape instanceof Circle) {\r\n        return graphics_circle(shape, style);\r\n    }\r\n    if (shape instanceof Box) {\r\n        return graphics_box(shape, style);\r\n    }\r\n    if (shape instanceof Polygon) {\r\n        return graphics_polygon(shape, style);\r\n    }\r\n    return null;\r\n}\r\n\r\n// Point.prototype.graphics = function(style) {\r\nfunction graphics_point(point, style) {\r\n    let radius = (style && style.radius) ? style.radius : 3;\r\n    let fill = style && style.fill ? style.fill : \"#FF0303\";\r\n    let graphics = new Graphics();\r\n    graphics.fill = graphics.beginFill(fill).command;\r\n    graphics.circle = graphics.drawCircle(point.x, point.y, radius).command;\r\n    return graphics;\r\n};\r\n\r\n// Segment.prototype.graphics = function(style) {\r\nfunction graphics_segment(segment, style) {\r\n    let graphics = new Graphics();\r\n    let strokeStyle = style && style.strokeStyle !== undefined ? style.strokeStyle : 2;\r\n    let ignoreScale = style && style.ignoreScale !== undefined ? style.ignoreScale : true;\r\n    let stroke = style && style.stroke ? style.stroke : \"black\";\r\n    return graphics\r\n        .setStrokeStyle(strokeStyle,1,0,10,ignoreScale)\r\n        .beginStroke(stroke)\r\n        .moveTo(segment.ps.x, segment.ps.y)\r\n        .lineTo(segment.pe.x, segment.pe.y)\r\n        .endStroke();\r\n};\r\n\r\n// Arc.prototype.graphics = function(style) {\r\nfunction graphics_arc(arc, style) {\r\n    // let startAngle = 2 * Math.PI - this.startAngle;\r\n    // let endAngle =  2 * Math.PI - this.endAngle;\r\n    let graphics = new Graphics();\r\n    let strokeStyle = style && style.strokeStyle ? style.strokeStyle : 2;\r\n    let ignoreScale = style && style.ignoreScale !== undefined ? style.ignoreScale : true;\r\n    let stroke = style && style.stroke ? style.stroke : \"black\";\r\n    return graphics\r\n        .setStrokeStyle(strokeStyle,1,0,10,ignoreScale)\r\n        .beginStroke(stroke)\r\n        .arc(arc.pc.x, arc.pc.y, arc.r, arc.startAngle, arc.endAngle, !arc.counterClockwise)\r\n        .endStroke();\r\n};\r\n\r\n// Circle.prototype.graphics = function(style) {\r\nfunction graphics_circle(circle, style) {\r\n    let graphics = new Graphics();\r\n    let strokeStyle = style && style.strokeStyle ? style.strokeStyle : 1;\r\n    // let stroke = style && style.stroke ? style.stroke : \"black\";\r\n    let stroke = style && style.stroke ? style.stroke : \"#FF0303\";\r\n    let fill = style && style.fill ? style.fill : \"#FF0303\";\r\n    graphics.setStrokeStyle(strokeStyle,0,0,10,true);\r\n    graphics.stroke = graphics.beginStroke(stroke).command;\r\n    graphics.fill = graphics.beginFill(fill).command;\r\n\r\n    // graphics.setStrokeStyle(2).beginStroke(\"black\").beginFill(\"red\").drawCircle(pcx, pcy, r);\r\n    return graphics\r\n        .setStrokeStyle(strokeStyle,0,0,10,true)\r\n        .beginStroke(stroke)\r\n        .drawCircle(circle.pc.x, circle.pc.y, circle.r)\r\n        .endStroke();\r\n};\r\n\r\n// Box.prototype.graphics = function(style) {\r\nfunction graphics_box(box, style) {\r\n    let graphics = new Graphics();\r\n    let strokeStyle = style && style.strokeStyle ? style.strokeStyle : 1;\r\n    let stroke = style && style.stroke ? style.stroke : \"black\";\r\n    // graphics.setStrokeStyle(2).beginStroke(\"black\").beginFill(\"red\").drawCircle(pcx, pcy, r);\r\n    return graphics\r\n        .setStrokeStyle(strokeStyle,0,0,10,true)\r\n        .beginStroke(stroke)\r\n        .drawRect(box.xmin, box.ymin, box.xmax-box.xmin, box.ymax-box.ymin);\r\n};\r\n\r\nfunction setGraphicsEdgeSegment(graphics, segment) {\r\n    graphics.lineTo(segment.pe.x, segment.pe.y);\r\n}\r\n\r\nfunction setGraphicsEdgeArc(graphics, arc) {\r\n    // let startAngle = 2 * Math.PI - arc.startAngle;\r\n    // let endAngle = 2 * Math.PI - arc.endAngle;\r\n    graphics.arc(arc.pc.x, arc.pc.y, arc.r, arc.startAngle, arc.endAngle, !arc.counterClockwise);\r\n}\r\n\r\nfunction setGraphicsEdge(graphics, edge) {\r\n    if (edge.shape instanceof Segment) {\r\n        setGraphicsEdgeSegment(graphics, edge.shape);\r\n    }\r\n    else if (edge.shape instanceof Arc) {\r\n        setGraphicsEdgeArc(graphics, edge.shape);\r\n    }\r\n}\r\n\r\nfunction setGraphicsFace(graphics, face) {\r\n    let ps = face.first.start;\r\n    graphics.moveTo(ps.x, ps.y);\r\n\r\n    for (let edge of face) {\r\n        setGraphicsEdge(graphics, edge);\r\n    }\r\n}\r\n\r\n// Polygon.prototype.graphics = function(style) {\r\nfunction graphics_polygon(polygon, style) {\r\n    let graphics = new Graphics();\r\n    let strokeStyle = style && style.strokeStyle ? style.strokeStyle : 1;\r\n    let stroke = style && style.stroke ? style.stroke : \"#FF0303\";\r\n    let fill = style && style.fill ? style.fill : \"#FF0303\";\r\n    graphics.setStrokeStyle(strokeStyle,0,0,10,true);\r\n    graphics.stroke = graphics.beginStroke(stroke).command;\r\n    graphics.fill = graphics.beginFill(fill).command;\r\n\r\n    for (let face of polygon.faces) {\r\n        setGraphicsFace(graphics, face);\r\n    }\r\n\r\n    graphics.endStroke();\r\n    return graphics;\r\n};\r\n\r\n","const Utils = {\r\n    is_equal: (obj1, obj2) => {\r\n        let equal = true;\r\n        for (let key of Object.keys(obj2)) {\r\n            if (obj2[key] !== obj1[key]) {\r\n                equal = false;\r\n                break;\r\n            }\r\n        }\r\n        return equal;\r\n    }\r\n};\r\n\r\nexport default Utils;","/**\r\n * Created by alexanderbol on 19/06/2017.\r\n */\r\n\r\nimport {Component} from 'react';\r\nimport {Shape} from '@createjs/easeljs';\r\nimport {graphics} from '../../../../models/graphics';\r\nimport Utils from '../../../../models/utils';\r\n\r\nexport class ShapeComponent extends Component {\r\n    constructor(params) {\r\n        super();\r\n\r\n        this.shape = new Shape();\r\n        params.stage.addChild(this.shape);\r\n\r\n        this.vertexShapes = [];\r\n\r\n        if (params.model.geom.vertices) {\r\n            for (let vertex of params.model.geom.vertices) {\r\n                let vertexShape = new Shape();\r\n                vertexShape.geom = vertex;   // augment Shape with geom struct\r\n                vertexShape.mouseEnabled = false;\r\n                params.stage.addChild(vertexShape);\r\n                this.vertexShapes.push(vertexShape);\r\n            }\r\n        }\r\n    }\r\n\r\n    handleMouseOver = (event) => {\r\n        this.props.onMouseOver(this.props.model);\r\n    };\r\n\r\n    handleMouseOut = (event) => {\r\n        this.props.onMouseOut();\r\n    };\r\n\r\n    handleClick = (event) => {\r\n        this.props.onClick(this.props.model, this.props.layer);\r\n    };\r\n\r\n    redrawVertices(stroke, fill, alpha) {\r\n        let stage = this.props.stage;\r\n\r\n        for (let vertexShape of this.vertexShapes) {\r\n            let vertex = vertexShape.geom;\r\n            if (vertexShape.graphics.isEmpty()) {\r\n                vertexShape.graphics = graphics(vertex,   // vertex.graphics({\r\n                    {\r\n                        stroke: stroke,     // this.props.color,\r\n                        fill: fill,\r\n                        radius: 3. / (stage.zoomFactor * stage.resolution)\r\n                    });\r\n            }\r\n            else {\r\n                vertexShape.graphics.circle.radius = 3. / (stage.zoomFactor * stage.resolution);\r\n                vertexShape.graphics.fill.style = fill;\r\n            }\r\n            vertexShape.alpha = alpha;\r\n        }\r\n    }\r\n\r\n    redraw() {\r\n        // Draw shape\r\n        let stage = this.props.stage;\r\n        let color = (this.props.hovered || this.props.selected) ? \"black\" : this.props.color;\r\n        let alpha = (this.props.hovered || this.props.selected) ? 1.0 : 0.6;\r\n        let widthOn = this.props.widthOn;\r\n\r\n        let strokeStyle = this.props.model.geom.aperture ? this.props.model.geom.aperture : undefined;\r\n        let fill = (widthOn && !this.props.displayVertices) ? this.props.color : \"white\";\r\n\r\n        if (this.shape.graphics.isEmpty()) {\r\n            this.shape.graphics = graphics(this.props.model.geom,{\r\n                strokeStyle: strokeStyle,\r\n                ignoreScale: true,\r\n                stroke: color,\r\n                fill: fill,\r\n                radius: 3. / (stage.zoomFactor * stage.resolution)\r\n            });\r\n\r\n            // this.skeletonShape = new Shape();\r\n            // this.skeletonShape.graphics = this.props.model.geom.graphics({\r\n            //     strokeStyle: 1,\r\n            //     ignoreScale: true,\r\n            //     stroke: color,\r\n            //     fill: fill,\r\n            //     radius: 3. / (stage.zoomFactor * stage.resolution)\r\n            // });\r\n            // this.skeletonShape.alpha = 1;\r\n            // this.props.stage.addChild(this.skeletonShape);\r\n        }\r\n        else {\r\n            if (this.shape.graphics.stroke) this.shape.graphics.stroke.style = color;\r\n            if (this.shape.graphics.fill) this.shape.graphics.fill.style = fill;\r\n            if (this.shape.graphics.circle) this.shape.graphics.circle.radius =\r\n                3. / (stage.zoomFactor * stage.resolution);\r\n        }\r\n        this.shape.alpha = this.props.displayed ? alpha : 0.0;\r\n\r\n        // let box = this.props.model.geom.box;\r\n        // this.shape.cache(box.xmin, box.ymin, box.xmax - box.xmin, box.ymax - box.ymin);\r\n\r\n        // Draw vertices\r\n        alpha = this.props.displayed && this.props.displayVertices ? 1.0 : 0.0;\r\n        this.redrawVertices(color, color, alpha);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.shape.on(\"mouseover\", this.handleMouseOver);\r\n        this.shape.on(\"mouseout\", this.handleMouseOut);\r\n        this.shape.on(\"click\", this.handleClick);\r\n\r\n        // this.shape.mouseEnabled = false;\r\n\r\n        this.redraw();\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if (Utils.is_equal(this.props, nextProps)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.redraw();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.shape.off(\"mouseover\", this.handleMouseOver);\r\n        this.shape.off(\"mouseout\", this.handleMouseOut);\r\n        this.shape.off(\"click\", this.handleClick);\r\n        this.props.stage.removeChild(this.shape);\r\n        this.shape.graphics.clear();\r\n        for (let vertexShape of this.vertexShapes) {\r\n            this.props.stage.removeChild(vertexShape);\r\n        }\r\n        this.vertexShapes = [];\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n","import * as firebase from 'firebase';\r\n\r\nconst config = {\r\n    apiKey: \"AIzaSyDMUAcjgolAlapdpFmPEz8SaId1DZw7MpQ\",\r\n    authDomain: \"debug-viewer.firebaseapp.com\",\r\n    databaseURL: \"https://debug-viewer.firebaseio.com\",\r\n    projectId: \"debug-viewer\",\r\n    storageBucket: \"debug-viewer.appspot.com\",\r\n    messagingSenderId: \"736075300479\"\r\n};\r\nfirebase.initializeApp(config);\r\nconst storage = firebase.storage();\r\n\r\nexport default storage;\r\n","/**\r\n * Created by alexanderbol on 19/06/2017.\r\n */\r\n\r\nimport {Component} from 'react';\r\nimport {Bitmap} from '@createjs/easeljs';\r\nimport '../../../../models/graphics';\r\nimport Utils from '../../../../models/utils';\r\nimport storage from '../../../../firebase-storage';\r\n\r\nexport class ImageComponent extends Component {\r\n    handleMouseOver = (event) => {\r\n        this.props.onMouseOver(this.props.model);\r\n    };\r\n\r\n    handleMouseOut = (event) => {\r\n        this.props.onMouseOut();\r\n    };\r\n\r\n    handleClick = (event) => {\r\n        this.props.onClick(this.props.model, this.props.layer);\r\n    };\r\n\r\n    redraw() {\r\n        if (!this.bitmap) return;\r\n        // Draw shape\r\n        let alpha = 0.5; // (this.props.hovered || this.props.selected) ? 1.0 : 0.6;\r\n        this.bitmap.alpha = this.props.displayed ? alpha : 0.0;\r\n\r\n        let width = this.props.model.geom.width;\r\n        let ratio = this.bitmap.image.naturalWidth/this.bitmap.image.naturalHeight;\r\n        this.props.model.geom.height = this.props.model.geom.width / ratio;\r\n        let scaleX = width/this.bitmap.image.naturalWidth; // 1. / (stage.zoomFactor * stage.resolution);\r\n        let scaleY = width/(this.bitmap.image.naturalHeight*ratio);\r\n        let tx = this.props.model.geom.center.x; // stage.canvas.offsetLeft / (stage.zoomFactor * stage.resolution) + point.x + dx;\r\n        let ty = this.props.model.geom.center.y; // -stage.canvas.offsetTop / (stage.zoomFactor * stage.resolution) + point.y + dy;\r\n\r\n        this.bitmap.setTransform(tx, ty, scaleX, -scaleY);\r\n\r\n        this.bitmap.regX = this.bitmap.image.naturalWidth/2;\r\n        this.bitmap.regY = this.bitmap.image.naturalHeight/2;\r\n\r\n        // let box = this.state.polygon.geom.box;\r\n        // this.shape.cache(box.xmin, box.ymin, box.xmax - box.xmin, box.ymax - box.ymin);\r\n    }\r\n\r\n    loadImage() {\r\n        const img = new Image();\r\n\r\n        img.onload = () => {\r\n            // img.crossOrigin=\"Anonymous\";\r\n            this.bitmap = new Bitmap(img);\r\n            this.props.stage.addChild(this.bitmap);\r\n\r\n            // this.bitmap.on(\"mouseover\", this.handleMouseOver);\r\n            // this.bitmap.on(\"mouseout\", this.handleMouseOut);\r\n            // this.bitmap.on(\"click\", this.handleClick);\r\n\r\n            // this.shape.mouseEnabled = false;\r\n            this.redraw();\r\n\r\n            this.props.onImageLoaded(this.props.model, this.props.layer, img);\r\n        };\r\n        img.setAttribute('crossOrigin', 'anonymous'); // works for me\r\n\r\n        // Create a reference from a Google Cloud Storage URI\r\n        const ref = storage.refFromURL(this.props.model.geom.uri);\r\n\r\n        ref.getDownloadURL()\r\n            .then( url => {\r\n\r\n                img.src = url;\r\n            })\r\n            .catch( error => console.log(error))\r\n\r\n        // img.src = this.props.model.geom.uri;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.loadImage()\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        if (Utils.is_equal(this.props, nextProps)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.redraw();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        // this.bitmap.off(\"mouseover\", this.handleMouseOver);\r\n        // this.bitmap.off(\"mouseout\", this.handleMouseOut);\r\n        // this.bitmap.off(\"click\", this.handleClick);\r\n\r\n        this.props.stage.removeChild(this.bitmap);\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n","import React, {Component} from 'react';\r\nimport {ShapeComponent} from './graphics/shapeComponent';\r\nimport {ImageComponent} from \"./graphics/imageComponent\";\r\n\r\nexport class LayerComponent extends Component {\r\n    render() {\r\n        return (\r\n            this.props.layer.shapes.map((shape, index) => {\r\n                return shape.geom.uri ? (\r\n                    <ImageComponent\r\n                        key={index}\r\n                        stage={this.props.stage}\r\n                        layer={this.props.layer}\r\n                        model={shape}\r\n                        displayed={this.props.layer.displayed}\r\n                        hovered={shape === this.props.hoveredShape}\r\n                        selected={\r\n                            shape === this.props.firstMeasuredShape ||\r\n                            shape === this.props.secondMeasuredShape\r\n                        }\r\n                        color={this.props.layer.color}\r\n                        widthOn={this.props.widthOn}\r\n                        displayLabels={this.props.displayLabels}\r\n                        zoomFactor={this.props.zoomFactor}\r\n                        onMouseOver={this.props.onMouseOver}\r\n                        onMouseOut={this.props.onMouseOut}\r\n                        onClick={this.props.onClick}\r\n                        onImageLoaded={this.props.onImageLoaded}\r\n                    />\r\n                    ) : (\r\n                    <ShapeComponent\r\n                        key={index}\r\n                        stage={this.props.stage}\r\n                        layer={this.props.layer}\r\n                        model={shape}\r\n                        displayed={this.props.layer.displayed}\r\n                        hovered={shape === this.props.hoveredShape}\r\n                        selected={\r\n                            shape === this.props.firstMeasuredShape ||\r\n                            shape === this.props.secondMeasuredShape\r\n                        }\r\n                        color={this.props.layer.color}\r\n                        widthOn={this.props.widthOn}\r\n                        displayVertices={this.props.displayVertices}\r\n                        zoomFactor={this.props.zoomFactor}\r\n                        onMouseOver={this.props.onMouseOver}\r\n                        onMouseOut={this.props.onMouseOut}\r\n                        onClick={this.props.onClick}\r\n                    /> )\r\n                }\r\n            )\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\nimport classes from '../LabelsLayerComponent/labelsLayer.module.css';\r\n\r\nconst labelComponent = ( {stage, shape} ) => {\r\n    let center = shape.geom.center || shape.geom;  // Point has no method center\r\n    let left = stage.canvas.offsetLeft + stage.W2C_X(center.x) + 6;\r\n    let top = stage.canvas.offsetTop + stage.W2C_Y(center.y) - 4;\r\n    let inside = left > stage.canvas.offsetLeft && left < stage.canvas.offsetLeft + stage.canvas.width &&\r\n        top > stage.canvas.offsetTop && top < stage.canvas.offsetTop + stage.canvas.height;\r\n\r\n    return inside ? (\r\n        <div style={{position:\"absolute\", left:left+\"px\", top: top+\"px\"}} className={classes.LabelComponent}>\r\n            <h5>{shape.label}</h5>\r\n        </div>\r\n    ) : null;\r\n};\r\n\r\nexport default labelComponent;","import React from 'react';\r\nimport LabelComponent from '../domelements/labelComponent';\r\n\r\nconst labelsLayerComponent = ({stage, layer, displayLabels}) => {\r\n    return (layer.displayed && displayLabels) ? (\r\n        layer.shapes.map((shape, index) => {\r\n                return (shape.label && shape.label.trim() !== \"\") ? (\r\n                    <LabelComponent\r\n                        key={index}\r\n                        stage={stage}\r\n                        shape={shape}\r\n                    />) : null;\r\n            }\r\n        )\r\n    ) : null;\r\n};\r\n\r\nexport default labelsLayerComponent;","import React, {Component} from 'react';\r\nimport {LayerComponent} from \"./layerComponent\";\r\nimport LabelsLayerComponent from \"./LabelsLayerComponent/labelsLayerComponent\";\r\nimport Layers from \"../../../models/layers\";\r\n\r\nclass LayersComponent extends Component {\r\n    componentDidMount() {\r\n        if (this.props.layers.length > 0 && this.props.stage) {\r\n            let affectedLayer = Layers.getAffected(this.props.layers);\r\n            if (affectedLayer) {\r\n                this.props.setHomeView(this.props.stage, affectedLayer);\r\n            }\r\n        }\r\n    }\r\n    render() {\r\n        return this.props.layers.map((layer) =>\r\n            <React.Fragment key={layer.name}>\r\n                <LayerComponent\r\n                    stage={this.props.stage}\r\n                    layer={layer}\r\n                    color={layer.color}\r\n                    displayed={layer.displayed}\r\n                    displayVertices={this.props.displayVertices}\r\n                    displayLabels={this.props.displayLabels}\r\n                    widthOn={this.props.widthOn}\r\n                    hoveredShape={this.props.hoveredShape}\r\n                    firstMeasuredShape={this.props.firstMeasuredShape}\r\n                    secondMeasuredShape={this.props.secondMeasuredShape}\r\n                    zoomFactor={this.props.zoomFactor}\r\n                    onMouseOver={this.props.onMouseOver}\r\n                    onMouseOut={this.props.onMouseOut}\r\n                    onClick={this.props.onClick}\r\n                    onImageLoaded={this.props.onImageLoaded}\r\n                />\r\n                <LabelsLayerComponent\r\n                    stage={this.props.stage}\r\n                    layer={layer}\r\n                    displayed={layer.displayed}\r\n                    displayLabels={this.props.displayLabels}\r\n\r\n                />\r\n            </React.Fragment>\r\n        )\r\n    }\r\n}\r\n\r\nexport default LayersComponent;\r\n","/**\r\n * Created by alexanderbol on 21/04/2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Stage from \"../models/stage\";\r\nimport * as actions from '../store/actions/stageActions';\r\n\r\nclass MeasurePointsTool extends Component {\r\n    measureCanvas = React.createRef();\r\n    measureStage = null;\r\n\r\n    state = {\r\n        startX: undefined,\r\n        startY: undefined,\r\n        endX: undefined,\r\n        endY: undefined,\r\n        measureStarted: false\r\n    };\r\n\r\n    handleMouseDown = (event) => {\r\n        event.preventDefault();\r\n\r\n        this.measureStage.clear();\r\n\r\n        if (this.state.measureStarted) {   // second click - clear measurement\r\n            this.setState({\r\n                startX: undefined,\r\n                startY: undefined,\r\n                endX: undefined,\r\n                endY: undefined,\r\n                measureStarted: false\r\n            });\r\n            this.measureStage.canvas.style.cursor = \"auto\";\r\n        }\r\n        else {                       // first click - start measurment\r\n            this.setState({\r\n                startX: this.measureStage.C2W_X(event.stageX),\r\n                startY: this.measureStage.C2W_Y(event.stageY),\r\n                measureStarted: true\r\n            });\r\n            this.measureStage.canvas.style.cursor = \"crosshair\";\r\n        }\r\n    };\r\n\r\n    handleMouseMove = (event) => {\r\n        if (this.state.measureStarted) {\r\n            this.setState({\r\n                endX: this.measureStage.C2W_X(event.stageX),\r\n                endY: this.measureStage.C2W_Y(event.stageY)\r\n            })\r\n        }\r\n    };\r\n\r\n    handleMouseUp = (event) => {\r\n    }\r\n\r\n    handleMouseWheel = (event) => {\r\n        event.preventDefault();\r\n\r\n        let delta = event.detail || event.wheelDelta;\r\n        if (delta !== 0) {\r\n            // this.props.onMouseWheelMove(event.offsetX, event.offsetY, delta);\r\n            this.props.handleMouseWheelMove(this.props.stage, event.offsetX, event.offsetY, delta);\r\n\r\n            this.draw();\r\n        }\r\n    };\r\n\r\n    handleMouseWheelFox = (event) => {\r\n        event.preventDefault();\r\n\r\n        if (event.detail !== 0) {\r\n            // this.props.onMousewheelMove(event.layerX, event.layerY, -event.detail);\r\n            this.props.handleMouseWheelMove(this.props.stage, event.layerX, event.layerY, -event.detail);\r\n\r\n            this.draw();\r\n        }\r\n    };\r\n\r\n    draw() {\r\n        // let canvas = this.measureCanvas.current;\r\n        let stage = this.measureStage; // this.props.stage;\r\n        let canvas = stage.canvas;\r\n        let context = canvas.getContext('2d');\r\n\r\n        this.measureStage.origin = this.props.stage.origin;\r\n        this.measureStage.resolution = this.props.stage.resolution;\r\n        this.measureStage.zoomFactor = this.props.stage.zoomFactor;\r\n\r\n        this.measureStage.clear();\r\n\r\n        // Draw rectangle\r\n        let pllX = Math.min(stage.W2C_X(this.state.startX), stage.W2C_X(this.state.endX));\r\n        let pllY = Math.min(stage.W2C_Y(this.state.startY), stage.W2C_Y(this.state.endY));\r\n        let width = Math.abs(stage.W2C_Scalar(this.state.startX - this.state.endX));\r\n        let height = Math.abs(stage.W2C_Scalar(this.state.startY - this.state.endY));\r\n\r\n        context.beginPath();\r\n        context.rect(pllX, pllY, width, height);\r\n\r\n        // Draw segment\r\n        context.moveTo(stage.W2C_X(this.state.startX), stage.W2C_Y(this.state.startY));\r\n        context.lineTo(stage.W2C_X(this.state.endX), stage.W2C_Y(this.state.endY));\r\n\r\n        context.lineWidth = 1;\r\n        context.strokeStyle = 'black';\r\n        context.stroke();\r\n\r\n        // Draw text\r\n        let textX, textY, textHeight, textWidth;\r\n        let backX, backY;                      // background rectangle\r\n        let text = this.measurement();\r\n\r\n        context.font = \"12pt Arial\";\r\n\r\n        textHeight = 12;\r\n        /* font size*/\r\n        textWidth = context.measureText(text).width;\r\n\r\n        // Rectangle to the right of current point, text aligned left\r\n        if (Math.abs(stage.W2C_X(this.state.endX) - pllX) <= 2) {\r\n            context.textAlign = \"left\";\r\n            textX = pllX + 3;\r\n            backX = pllX;\r\n        }\r\n        // Rectangle to the left of current point, text aligned right\r\n        else {\r\n            context.textAlign = \"right\";\r\n            textX = pllX + width - 3;\r\n            backX = textX - textWidth - 3;\r\n        }\r\n\r\n        if (Math.abs(stage.W2C_Y(this.state.endY) - pllY) <= 2) {\r\n            textY = pllY - 3;\r\n        }\r\n        else {\r\n            textY = pllY + height + textHeight + 3;\r\n        }\r\n        backY = textY - textHeight - 3;\r\n\r\n        context.fillStyle = 'white';\r\n        context.globalAlpha = 0.4;\r\n        context.fillRect(backX, backY, textWidth + 6, textHeight + 6);\r\n\r\n        context.fillStyle = \"black\";\r\n        context.globalAlpha = 1;\r\n        context.fillText(this.measurement(), textX, textY);\r\n    }\r\n\r\n    measurement() {\r\n        let dx = this.state.endX - this.state.startX;\r\n        let dy = this.state.endY - this.state.startY;\r\n        let dist = Math.sqrt(dx * dx + dy * dy);\r\n        let message = \"DX=\" + this.format(dx) + \",DY=\" + this.format(dy) + \",D=\" + this.format(dist);\r\n        return message;\r\n    }\r\n\r\n    format(num) {\r\n        return (num / this.props.divisor).toFixed(this.props.decimals);\r\n    }\r\n\r\n    componentDidMount() {\r\n        // let canvas = this.measureCanvas.current;\r\n        this.measureStage = new Stage(this.measureCanvas.current);\r\n        this.measureStage.origin = this.props.stage.origin;\r\n        this.measureStage.resolution = this.props.stage.resolution;\r\n        this.measureStage.zoomFactor = this.props.stage.zoomFactor;\r\n\r\n        this.measureStage.on(\"stagemousedown\", this.handleMouseDown);\r\n        this.measureStage.on(\"stagemousemove\", this.handleMouseMove);\r\n        this.measureStage.on(\"stagemouseup\", this.handleMouseUp);\r\n\r\n        this.measureStage.canvas.addEventListener(\"mousewheel\", this.handleMouseWheel);\r\n        this.measureStage.canvas.addEventListener(\"DOMMouseScroll\", this.handleMouseWheelFox);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (this.state.measureStarted) {\r\n            this.draw();\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.measureStage.clear();\r\n        this.measureStage.removeAllChildren();\r\n        this.measureStage.removeAllEventListeners();\r\n    }\r\n\r\n    render() {\r\n        let mainCanvas = this.props.stage.canvas;\r\n        let width = mainCanvas.width;\r\n        let height = mainCanvas.height;\r\n        let top = mainCanvas.offsetTop;\r\n        let left = mainCanvas.offsetLeft;\r\n        return (\r\n            <canvas tabIndex=\"1\" ref={this.measureCanvas}\r\n                    width={width}\r\n                    height={height}\r\n                    style={{position: 'absolute', top: top, left: left}}\r\n            >\r\n            </canvas>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = ({app}) => {\r\n    return {\r\n        stage: app.stage,\r\n        divisor: app.divisor,\r\n        decimals: app.decimals\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        handleMouseWheelMove: (stage, x, y, delta) => dispatch(actions.handleMouseWheelMove(stage, x, y, delta))\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MeasurePointsTool);\r\n","/**\r\n * Created by alexanderbol on 21/04/2017.\r\n */\r\n\r\nimport {Component} from 'react';\r\nimport {Shape, Text} from '@createjs/easeljs';\r\nimport {graphics} from '../models/graphics';\r\n\r\nclass MeasureShapesTool extends Component {\r\n    constructor(params) {\r\n        super();\r\n        this.segment = new Shape();\r\n        params.stage.addChild(this.segment);\r\n\r\n        this.labelShape = new Text();\r\n        this.labelShape.x = 0;\r\n        this.labelShape.y = 0;\r\n        params.stage.addChild(this.labelShape);\r\n\r\n        // var html = document.createElement('div');\r\n        // html.innerText = \"\"; // params.model.label;\r\n        // html.style.position = \"absolute\";\r\n        // html.style.top = 0;\r\n        // html.style.left = 0;\r\n        //\r\n        // document.body.appendChild(html);\r\n        // this.labelShape = new createjs.DOMElement(html);\r\n        // params.stage.addChild(this.labelShape);\r\n    }\r\n\r\n    // redrawLabel() {\r\n    //     if (!this.labelShape) return;\r\n    //\r\n    //     let stage = this.props.stage;\r\n    //\r\n    //     this.labelShape.htmlElement.style.display = \"block\";\r\n    //\r\n    //     let box = this.props.shortestSegment.box;\r\n    //     let point = {x: (box.xmin + box.xmax) / 2, y: (box.ymin + box.ymax) / 2};\r\n    //     let dx = 6. / (stage.zoomFactor * stage.resolution);\r\n    //     let dy = 4. / (stage.zoomFactor * stage.resolution);\r\n    //\r\n    //     this.labelShape.htmlElement.style.font = \"16px Arial\";\r\n    //     this.labelShape.htmlElement.innerText = this.props.shortestSegment.length;\r\n    //\r\n    //     let unscale = 1. / (stage.zoomFactor * stage.resolution);\r\n    //     let tx = stage.canvas.offsetLeft / (stage.zoomFactor * stage.resolution) + point.x + dx;\r\n    //     let ty = -stage.canvas.offsetTop / (stage.zoomFactor * stage.resolution) + point.y + dy;\r\n    //     this.labelShape.setTransform(tx, ty, unscale, -unscale);\r\n    // }\r\n\r\n    format(num) {\r\n        return (num/this.props.divisor).toFixed(this.props.decimals);\r\n    }\r\n\r\n    redrawLabel() {\r\n        if (!this.labelShape) return;\r\n\r\n        let stage = this.props.stage;\r\n\r\n        let box = this.props.shortestSegment.box;\r\n        let point = {x: (box.xmin + box.xmax) / 2, y: (box.ymin + box.ymax) / 2};\r\n        let dx = 6. / (stage.zoomFactor * stage.resolution);\r\n        let dy = 4. / (stage.zoomFactor * stage.resolution);\r\n\r\n        if (box.ymin === box.ymax) {\r\n            dx = 0;\r\n            dy = -dy;\r\n        }\r\n\r\n        // this.labelShape.htmlElement.style.display = \"block\";\r\n        // this.labelShape.htmlElement.style.font = \"16px Arial\";\r\n        // this.labelShape.htmlElement.innerText = this.props.shortestSegment.length;\r\n\r\n        this.labelShape.text = this.format(this.props.shortestSegment.length);\r\n\r\n        let fontSize = 14.; // / (stage.zoomFactor * stage.resolution);\r\n        this.labelShape.font = `${fontSize}px Arial`;\r\n\r\n        let unscale = 1. / (stage.zoomFactor * stage.resolution);\r\n        // let tx = stage.canvas.offsetLeft / (stage.zoomFactor * stage.resolution) + point.x + dx;\r\n        // let ty = -stage.canvas.offsetTop / (stage.zoomFactor * stage.resolution) + point.y + dy;\r\n        let tx = point.x + dx;\r\n        let ty = point.y + dy;\r\n        this.labelShape.setTransform(tx, ty, unscale, -unscale);\r\n    }\r\n\r\n    draw() {\r\n        if (this.props.shortestSegment) {\r\n            this.segment.graphics = graphics(this.props.shortestSegment);\r\n            this.redrawLabel();\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.draw();\r\n    }\r\n    componentDidUpdate() {\r\n        this.segment.graphics.clear();\r\n        if (this.props.firstMeasuredShape && this.props.secondMeasuredShape &&\r\n            this.props.firstMeasuredLayer.displayed &&\r\n            this.props.secondMeasuredLayer.displayed) {\r\n\r\n            this.draw();\r\n            this.redrawLabel();\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.stage.removeChild(this.segment);\r\n        this.segment.graphics.clear();\r\n        this.props.stage.removeChild(this.labelShape);\r\n        this.labelShape.text = \"\";\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default MeasureShapesTool;","/**\r\n * Created by alexanderbol on 21/04/2017.\r\n */\r\nimport React from 'react';\r\nconst DisplayCoordsTool = ({stage, coordX, coordY, divisor, decimals}) => {\r\n    const format = (num) => {\r\n        return (num/divisor).toFixed(decimals);\r\n    };\r\n\r\n    let mainCanvas = stage.canvas;\r\n    let top = mainCanvas.offsetTop + 10;\r\n    let left = mainCanvas.offsetLeft + 10;\r\n    let x = stage.C2W_X(coordX);\r\n    let y = stage.C2W_Y(coordY);\r\n    return (\r\n        <div style={{position: 'absolute', top: top, left: left}}>\r\n            <h5 style={{margin: 0, padding: 3}}>\r\n                X: {format(x)} Y: {format(y)}\r\n            </h5>\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default DisplayCoordsTool;\r\n","import {Component} from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nconst modalRoot = document.getElementById('modal-root');\r\n\r\n// A Modal component that is an abstraction around the portal API.\r\nclass Modal extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        // Create a div that we'll render the modal into. Because each\r\n        // Modal component has its own element, we can render multiple\r\n        // modal components into the modal container.\r\n        this.el = document.createElement('div');\r\n    }\r\n\r\n    componentDidMount() {\r\n        // Append the element into the DOM on mount. We'll render\r\n        // into the modal container element (see the HTML tab).\r\n        modalRoot.appendChild(this.el);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        // Remove the element from the DOM when we unmount\r\n        modalRoot.removeChild(this.el);\r\n    }\r\n\r\n    render() {\r\n        // Use a portal to render the children into the element\r\n        return ReactDOM.createPortal(\r\n            // Any valid React child: JSX, strings, arrays, etc.\r\n            this.props.children,\r\n            // A DOM element\r\n            this.el,\r\n        );\r\n    }\r\n}\r\n\r\nexport default Modal;","import React, {Component} from 'react';\r\nimport Modal from '../Modal';\r\nimport classes from './ModalPopup.module.css';\r\n\r\nclass ModalPopup extends Component {\r\n    offsetX;\r\n    offsetY;\r\n    dragX;\r\n    dragY;\r\n\r\n    onBackDropClicked = (ev) => {\r\n        if (ev.target.id === \"backDrop\") {\r\n            this.props.closePopup();\r\n        }\r\n    };\r\n\r\n    handleKeyDown = (ev) => {\r\n        if (ev.code === \"Escape\") {\r\n            this.props.closePopup();\r\n        }\r\n    };\r\n\r\n    elementDrag = (ev) => {\r\n        ev = ev || window.event;\r\n        // calculate the new cursor position:\r\n        this.offsetX = this.dragX - ev.clientX;\r\n        this.offsetY = this.dragY - ev.clientY;\r\n        this.dragX = ev.clientX;\r\n        this.dragY = ev.clientY;\r\n        // set the element's new position:\r\n        let element = ev.target;\r\n        element.style.top = (element.offsetTop - this.offsetY) + \"px\";\r\n        element.style.left = (element.offsetLeft - this.offsetX) + \"px\";\r\n    };\r\n\r\n    closeDragElement = (ev) => {\r\n        /* stop moving when mouse button is released:*/\r\n        ev.target.onmouseup = null;\r\n        ev.target.onmousemove = null;\r\n    };\r\n\r\n    dragMouseDown = (ev) => {\r\n        ev = ev || window.event;\r\n        // get the mouse cursor position at startup:\r\n        this.dragX = ev.clientX;\r\n        this.dragY = ev.clientY;\r\n        ev.target.onmouseup = this.closeDragElement;\r\n        // call a function whenever the cursor moves:\r\n        ev.target.onmousemove = this.elementDrag;\r\n    };\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleKeyDown);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleKeyDown);\r\n    }\r\n\r\n    render() {\r\n        return this.props.showPopup ? (\r\n            <Modal>\r\n                <div\r\n                    id=\"backDrop\"\r\n                    className={classes.BackDrop}\r\n                    onClick={this.onBackDropClicked}\r\n                >\r\n                    <div className={classes.ModalPopup}\r\n                         onMouseDown={this.dragMouseDown}\r\n                    >\r\n                        {this.props.children}\r\n                    </div>\r\n                </div>\r\n            </Modal>\r\n        ) : null;\r\n    }\r\n}\r\n\r\nexport default ModalPopup;","/**\r\n * Created by alexanderbol on 13/04/2017.\r\n */\r\n\r\nimport React from 'react';\r\nimport classes from './AboutPopup.module.css';\r\nimport ModalPopup from \"../UI/ModalPopup/ModalPopup\";\r\n\r\nconst AboutPopup = (props) => {\r\n    return (\r\n        <ModalPopup\r\n            showPopup={props.showAboutPopup}\r\n            closePopup={props.toggleAboutPopup}\r\n        >\r\n            <div className={classes.AboutPopup}>\r\n                <h2>{props.title} v{props.version}</h2>\r\n\r\n                <label>{`Build date: `}</label>\r\n                <span>April 2019</span>\r\n                <br/>\r\n\r\n                <label>{`Github depository: `}</label>\r\n                <a href=\"https://github.com/alexbol99/debug-viewer1\" >\r\n                    https://github.com/alexbol99/debug-viewer1\r\n                </a>\r\n                <br/>\r\n\r\n                <label>{`3d party graphics library: `}</label>\r\n                <a href=\"https://github.com/CreateJS/EaselJS/tree/2.0\" >\r\n                    https://github.com/CreateJS/EaselJS/tree/2.0\r\n                </a>\r\n                <br/>\r\n\r\n            </div>\r\n        </ModalPopup>\r\n\r\n    )\r\n};\r\n\r\nexport default AboutPopup;","import /*React,*/ {Component} from 'react';\r\nimport { connect } from 'react-redux';\r\nimport * as cloudActions from '../../store/actions/cloudStorageActions';\r\n\r\nclass CloudDocument extends Component {\r\n    state={\r\n        done:false\r\n    };\r\n\r\n    componentDidUpdate() {\r\n        if (this.props.stage && !this.state.done) {\r\n            this.props.fetchDocumentFromDatabase(this.props.stage, this.props.match.params.id);\r\n            this.setState({done:true});\r\n        }\r\n    }\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nconst mapStateToProps = ({app}) => {\r\n    return {\r\n        stage: app.stage,\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        fetchDocumentFromDatabase: (stage, id) => dispatch(cloudActions.fetchDocumentFromDatabase(stage, id)),\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CloudDocument);\r\n","/**\r\n * Created by alexanderbol on 17/04/2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport {Route} from 'react-router-dom';\r\nimport { connect } from \"react-redux\";\r\n\r\nimport ToolbarComponent from '../../components/MainComponent/ToolbarComponent/ToolbarComponent';\r\nimport CanvasComponent from '../../components/MainComponent/CanvasComponent/CanvasComponent';\r\nimport StatusComponent from '../../components/Layout/StatusComponent/StatusComponent';\r\n\r\nimport StageComponent from \"../../components/MainComponent/GraphicsComponent/stageComponent\";\r\nimport LayersComponent from '../../components/MainComponent/GraphicsComponent/layersComponent';\r\n\r\nimport * as actions from '../../store/actions/appActions';\r\nimport * as layerActions from \"../../store/actions/layersActions\";\r\nimport * as cloudActions from '../../store/actions/cloudStorageActions';\r\n\r\nimport Layers from '../../models/layers';\r\nimport MeasurePointsTool from '../../tools/measurePointsTool';\r\nimport MeasureShapesTool from \"../../tools/measureShapesTool\";\r\nimport DisplayCoordsTool from \"../../tools/displayCoordsTool\";\r\n\r\nimport AboutPopup from \"../../components/AboutPopup/AboutPopup\";\r\nimport CloudDocument from '../../components/Constructions/CloudDocument';\r\n\r\nimport styles from './MainComponent.module.css';\r\n\r\nclass MainComponent extends Component {\r\n    handleFileSelect = (event) => {\r\n        if (!(File && FileReader && FileList)) return;\r\n        let files = event.target.files; // FileList object\r\n        this.props.handleFileSelect(files, this.props.stage, this.props.layers);\r\n    };\r\n\r\n    setHomeView = () => {\r\n        let layer = Layers.getAffected(this.props.layers);\r\n        if (!layer) return;\r\n        this.props.setHomeView(this.props.stage, layer);\r\n        this.forceUpdate();       // ??? unclear why on Home button click not updated\r\n    };\r\n\r\n    onSaveDocumentButtonClicked = () => {\r\n        if (this.props.layers.length === 0) return;   // nothing to save\r\n        // this.props.stage.img.crossOrigin=\"anonymous\";\r\n        let dataURL = null;\r\n        try {\r\n            dataURL = this.props.stage.toDataURL();\r\n        }\r\n        catch(e) {\r\n            console.log(e)\r\n        }\r\n        let payload = {\r\n            name: this.props.document.name === \"\" ?\r\n                cloudActions.getNewName(this.props.documentsList) : this.props.document.name,\r\n            dataURL: dataURL,\r\n            lastUpdated: new Date().toLocaleDateString() + \" \" + new Date().toLocaleTimeString(),\r\n            // token: this.props.token,\r\n            userId: this.props.userId\r\n        };\r\n\r\n        if (this.props.document.id) {\r\n            this.props.updateDocumentInDatabase(this.props.document.id, payload, this.props.layers);\r\n        }\r\n        else {\r\n            this.props.addDocumentToDatabase(payload, this.props.layers, this.props.history);\r\n        }\r\n    };\r\n\r\n    clearCurrentDocument = () => {\r\n        this.props.clearCurrentDocument();\r\n        this.props.clearAllLayers();\r\n        this.props.history.push(\"/\");\r\n    };\r\n\r\n    handleKeyDown = (e) => {\r\n        // let ctrl = e.ctrlKey;\r\n        if (e.target.id !== \"mainCanvas\")\r\n            return;\r\n        switch (e.code) {\r\n            case \"KeyH\":\r\n                this.setHomeView();\r\n                break;\r\n\r\n            case \"KeyW\":\r\n                this.props.toggleWidthMode();     // toggle width On/Off in graphics model\r\n                break;\r\n\r\n            case \"KeyE\":\r\n                this.props.toggleDisplayVertices();  // toggle vertices On/Off\r\n                break;\r\n\r\n            case \"ArrowRight\":\r\n                break;\r\n\r\n            case \"ArrowLeft\":\r\n                break;\r\n            case \"ArrowUp\":\r\n                break;\r\n            case \"ArrowDown\":\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    onImageLoaded = (model, layer, image) => {\r\n        this.props.setHomeView(this.props.stage, layer);\r\n        this.forceUpdate();       // ??? unclear why on Home button click not updated\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.onresize = this.props.resizeStage;\r\n        // Keyboard event\r\n        // var _keydown = _.throttle(this.keydown, 100);\r\n        document.addEventListener('keydown', this.handleKeyDown);\r\n        // var _keyup = _.throttle(this.keyup, 500);\r\n        document.addEventListener('keyup', this.handleKeyUp);\r\n\r\n        // if (this.props.document.id === undefined) {\r\n        //     this.props.history.push(\"/\");\r\n        // }\r\n        // if (this.props.document.id !== undefined) {\r\n        //     this.props.history.push(\"/documents/\" + this.props.document.id)\r\n        // }\r\n    }\r\n\r\n    render() {\r\n        let displayCoordsTool = this.props.stage ? (\r\n            <DisplayCoordsTool\r\n                key=\"displayCoordinatedTool\"\r\n                stage={this.props.stage}\r\n                units={this.props.units}\r\n                divisor={this.props.divisor}\r\n                decimals={this.props.decimals}\r\n                coordX={this.props.mouse.x}\r\n                coordY={this.props.mouse.y}\r\n            />\r\n        ) : null;\r\n\r\n        let measurePointsTool = this.props.measurePointsActive ? <MeasurePointsTool /> : null;\r\n\r\n        let measuredLayersDisplayed = this.props.measureShapesTool.firstMeasuredShape &&\r\n            this.props.measureShapesTool.secondMeasuredShape &&\r\n            this.props.measureShapesTool.firstMeasuredLayer.displayed &&\r\n            this.props.measureShapesTool.secondMeasuredLayer.displayed;\r\n\r\n        let measureShapesTool = this.props.measureShapesTool.distance &&\r\n        this.props.measureShapesTool.shortestSegment && measuredLayersDisplayed ? (\r\n            <MeasureShapesTool\r\n                key=\"MeasureShapesTool\"\r\n                stage={this.props.stage}\r\n                firstMeasuredShape={this.props.measureShapesTool.firstMeasuredShape}\r\n                secondMeasuredShape={this.props.measureShapesTool.secondMeasuredShape}\r\n                firstMeasuredLayer={this.props.measureShapesTool.firstMeasuredLayer}\r\n                secondMeasuredLayer={this.props.measureShapesTool.secondMeasuredLayer}\r\n                distance={this.props.measureShapesTool.distance}\r\n                shortestSegment={this.props.measureShapesTool.shortestSegment}\r\n                divisor={this.props.divisor}\r\n                decimals={this.props.decimals}\r\n            />\r\n        ) : null;\r\n\r\n        return (\r\n            <main className={styles[\"Main-content\"]}>\r\n                <ToolbarComponent\r\n                    measurePointsActive={this.props.measurePointsActive}\r\n                    units={this.props.units}\r\n                    showSkeletonRecognitionButton={this.props.showSkeletonRecognitionButton}\r\n                    onFileSelected={this.handleFileSelect}\r\n                    onHomeButtonPressed={this.setHomeView}\r\n                    onPanByDragPressed={this.props.togglePanByDrag}\r\n                    onMeasurePointsButtonPressed={this.props.toggleMeasureBetweenPoints}\r\n                    onMeasureBetweenShapesButtonPressed={this.props.toggleMeasureBetweenShapes}\r\n                    onToggleWidthModePressed={this.props.toggleWidthMode}\r\n                    onToggleVerticesPressed={this.props.toggleDisplayVertices}\r\n                    onToggleLabelsPressed={this.props.toggleDisplayLabels}\r\n                    onShowAboutPopupPressed={this.props.toggleAboutPopup}\r\n                    onSkeletonRecognitionButtonPressed={this.props.applySkeletonRecognition}\r\n                    onUnitClicked={this.props.toggleUnits}\r\n                    onSaveDocumentButtonClicked={this.onSaveDocumentButtonClicked}\r\n                    onClearAllButtonClicked={this.clearCurrentDocument}\r\n                    onLayerListButtonClicked={this.props.toggleLayerList}\r\n                />\r\n\r\n                <CanvasComponent />\r\n\r\n                { this.props.stage ? (\r\n                <StageComponent\r\n                    stage={this.props.stage}\r\n                    onStageUnmounted={this.props.destroyStage}\r\n                >\r\n                    <LayersComponent\r\n                        stage={this.props.stage}\r\n                        layers={this.props.layers}\r\n                        displayVertices={this.props.displayVertices}\r\n                        displayLabels={this.props.displayLabels}\r\n                        widthOn={this.props.widthOn}\r\n                        zoomFactor={this.props.zoomFactor}\r\n                        hoveredShape={this.props.measureShapesTool.hoveredShape}\r\n                        firstMeasuredShape={this.props.measureShapesTool.firstMeasuredShape}\r\n                        secondMeasuredShape={this.props.measureShapesTool.secondMeasuredShape}\r\n                        onMouseOver={this.props.handleMouseRollOverShape}\r\n                        onMouseOut={this.props.handleMouseRollOutShape}\r\n                        onClick={this.props.handleClickOnShape}\r\n                        setHomeView={this.props.setHomeView}\r\n                        onImageLoaded={this.onImageLoaded}\r\n                    />\r\n                    {displayCoordsTool}\r\n                    {measurePointsTool}\r\n                    {measureShapesTool}\r\n                </StageComponent> ) : null }\r\n\r\n                <StatusComponent />\r\n\r\n                <AboutPopup\r\n                    showAboutPopup={this.props.showAboutPopup}\r\n                    toggleAboutPopup={this.props.toggleAboutPopup}\r\n                    title={this.props.title}\r\n                    version={this.props.version}\r\n                    build={this.props.build}\r\n                />\r\n\r\n                <Route path=\"/documents/:id\" component={CloudDocument}/>\r\n\r\n            </main>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n    return {\r\n        stage: state.app.stage,\r\n        title: state.app.title,\r\n        version: state.app.version,\r\n        build: state.app.build,\r\n        displayVertices: state.app.displayVertices,\r\n        displayLabels: state.app.displayLabels,\r\n        widthOn: state.app.widthOn,\r\n        zoomFactor: state.app.zoomFactor,\r\n        units: state.app.units,\r\n        showSkeletonRecognitionButton: state.app.showSkeletonRecognitionButton,\r\n        divisor: state.app.divisor,\r\n        decimals: state.app.decimals,\r\n        measurePointsActive: state.app.measurePointsActive,\r\n        showAboutPopup: state.app.showAboutPopup,\r\n        layers: state.layers,\r\n        mouse: state.mouse,\r\n        measureShapesTool: state.measureShapesTool,\r\n\r\n        document: state.cloudStorage.document,\r\n        documentsList: state.cloudStorage.documentsList,\r\n        // onManageCloudStorageButtonClicked: ownProps.onManageCloudStorageButtonClicked\r\n        token: state.auth.token,\r\n        userId: state.auth.userId\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        resizeStage: () => dispatch(actions.resizeStage()),\r\n        destroyStage: () => dispatch(actions.destroyStage()),\r\n        handleFileSelect: (files, stage, layers) => dispatch(actions.handleFileSelect(files, stage, layers)),\r\n        setHomeView: (stage, shape) => dispatch(actions.setHomeView(stage, shape)),\r\n        toggleUnits: () => dispatch(actions.toggleUnits()),\r\n        toggleWidthMode: () => dispatch(actions.toggleWidthMode()),\r\n        toggleDisplayVertices: () => dispatch(actions.toggleDisplayVertices()),\r\n        toggleDisplayLabels: () => dispatch(actions.toggleDisplayLabels()),\r\n        toggleAboutPopup: () => dispatch(actions.toggleAboutPopup()),\r\n        toggleMeasureBetweenPoints: () => dispatch(actions.toggleMeasureBetweenPoints()),\r\n        toggleMeasureBetweenShapes: () => dispatch(actions.toggleMeasureBetweenShapes()),\r\n        togglePanByDrag: () => dispatch(actions.togglePanByDrag()),\r\n        toggleLayerList: () => dispatch(actions.toggleLayerList()),\r\n        applySkeletonRecognition: () => dispatch(actions.applySkeletonRecognition()),\r\n        handleMouseRollOverShape: (shape) => dispatch(actions.handleMouseRollOverShape(shape)),\r\n        handleMouseRollOutShape: () => dispatch(actions.handleMouseRollOutShape()),\r\n        handleClickOnShape: (shape, layer) => dispatch(actions.handleClickOnShape(shape, layer)),\r\n\r\n        clearAllLayers: () => dispatch(layerActions.deleteAllLayers()),\r\n\r\n        addDocumentToDatabase: (payload, layers, history) => dispatch(cloudActions.addDocumentToDatabase(payload, layers, history)),\r\n        updateDocumentInDatabase: (id, payload, layers) => dispatch(cloudActions.updateDocumentInDatabase(id, payload, layers)),\r\n        clearCurrentDocument: () => dispatch(cloudActions.clearCurrentDocument())\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MainComponent);\r\n","/**\r\n * Created by alexanderbol on 17/04/2017.\r\n */\r\nimport React from 'react';\r\nimport FontAwesome from 'react-fontawesome';\r\n\r\nimport styles from './LayerListToolbar.module.css';\r\nimport '@fortawesome/fontawesome-free/css/all.css';\r\n\r\nconst LayerListToolbar = (props) => {\r\n    return (\r\n        <div className={styles[\"Layer-list-toolbar\"]}>\r\n            <button title=\"Add layer\" onClick={props.onAddLayerButtonClicked}>\r\n                <FontAwesome\r\n                    name='plus'\r\n                    size='2x'\r\n                    style={{color: \"grey\"}}\r\n                />\r\n            </button>\r\n            <button title=\"Edit selected layer's name and info\" onClick={props.onEditLayerButtonClicked}>\r\n                <FontAwesome\r\n                    name='pencil-alt'\r\n                    size='2x'\r\n                    style={{color: \"grey\"}}\r\n                />\r\n            </button>\r\n            <button title=\"Delete selected layer\" onClick={props.onDeleteLayerButtonClicked}>\r\n                <FontAwesome\r\n                    name='times'\r\n                    size='2x'\r\n                    style={{color: \"grey\"}}\r\n                />\r\n            </button>\r\n            <button title=\"Sort layer list\" onClick={props.onSortLayersButtonClicked}>\r\n                <FontAwesome\r\n                    name='sort-alpha-down'\r\n                    size='2x'\r\n                    style={{color: \"grey\"}}\r\n                />\r\n            </button>\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default LayerListToolbar;","/**\r\n * Created by alexanderbol on 13/04/2017.\r\n */\r\n\r\nimport React from 'react';\r\nimport styles from './LayerEditForm.module.css';\r\n\r\nconst LayerEditForm = (props) => {\r\n    let onSubmitLayerEditForm = (ev) => {\r\n        ev.stopPropagation();\r\n        ev.preventDefault();\r\n        let form = ev.target.parentElement;\r\n        let newLayer = Object.assign({}, props.layer, {\r\n            name: form.layerName.value,\r\n            title: form.layerTitle.value\r\n        });\r\n        props.onSubmitLayerEditForm(newLayer);\r\n        return false;\r\n    };\r\n\r\n    let setFocus = (ev) => {\r\n        ev.stopPropagation();\r\n        ev.target.focus();\r\n    };\r\n\r\n    let onCancelLayerEditForm = () => {\r\n        props.onEscapeLayerEditForm();\r\n    };\r\n\r\n    return (\r\n        <form className={styles[\"Layer-edit-form\"]}\r\n              id=\"layerEditForm\"\r\n              onSubmit={onSubmitLayerEditForm}\r\n        >\r\n            <label>Layer name:</label><br/>\r\n            <input type=\"text\" id=\"layer-name\" name=\"layerName\" size=\"80\" defaultValue={props.layer.name}\r\n                   onClick={setFocus}/><br/>\r\n            <label>Layer info:</label><br/>\r\n            <textarea id=\"layer-title\" name=\"layerTitle\" cols=\"78\" rows=\"3\" defaultValue={props.layer.title}\r\n                      onClick={setFocus}></textarea><br/>\r\n            <button onClick={onCancelLayerEditForm}>Cancel</button>\r\n            <button onClick={onSubmitLayerEditForm}>OK</button>\r\n        </form>\r\n    )\r\n};\r\n\r\nexport default LayerEditForm;","/**\r\n * Created by alexanderbol on 17/04/2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport ModalPopup from \"../../UI/ModalPopup/ModalPopup\";\r\nimport LayerEditForm from \"../LayerEditForm/LayerEditForm\";\r\nimport styles from './LayerListElement.module.css';\r\n\r\nclass LayerListElement extends Component {\r\n    componentDidUpdate() {\r\n        if (document.activeElement.nodeName === \"CANVAS\")\r\n            return;\r\n        let elem = this.refs.layerName;\r\n        if (this.props.layer.affected) {\r\n            elem.focus();\r\n        }\r\n    }\r\n\r\n    rgba(hex, opacity) {\r\n        let r, g, b, percent;\r\n        if (hex) {\r\n            hex = hex.replace('#', '');\r\n            r = parseInt(hex.substring(0, 2), 16);\r\n            g = parseInt(hex.substring(2, 4), 16);\r\n            b = parseInt(hex.substring(4, 6), 16);\r\n            percent = opacity;\r\n        }\r\n        else {\r\n            r = 147;\r\n            g = 128;\r\n            b = 108;\r\n            percent = 0;\r\n        }\r\n        let result = `rgba(${r},${g},${b},${percent / 100})`;\r\n\r\n        return result;\r\n    }\r\n\r\n    render() {\r\n        // let style = this.props.layer.displayed ?\r\n        //     styleSheet.displayed : styleSheet.undisplayed;\r\n\r\n        let displayed = this.props.layer.displayed ? \"Layer-displayed\" : \"Layer-undisplayed\";\r\n        let color = displayed ? this.rgba(this.props.layer.color, 100) : this.rgba();\r\n        let bgcolor = displayed ? this.rgba(this.props.layer.color, 30) : this.rgba();\r\n        let alpha = this.props.layer.affected ? 1 : 0;\r\n        let layerNameOpacity = this.props.layer.shapes.length === 0 ? 0.6 : 1.0;\r\n        return [\r\n            <li key={1}\r\n                className={styles.Layer}\r\n                onClick={this.props.onLayerClicked}\r\n                onDoubleClick={this.props.onLayerDoubleClicked}>\r\n\r\n                <div className={styles.LayerSelectionBox}\r\n                     onClick={this.props.onAffectedBoxClicked}\r\n                >\r\n                    <h4 className={styles.LayerSelectionMark}\r\n                        style={{opacity: alpha, color: color}}>\r\n                        \r\n                    </h4>\r\n                </div>\r\n\r\n                <div className={styles.LayerNameBox}\r\n                     style={{backgroundColor: bgcolor, opacity: layerNameOpacity}}>\r\n                    <h4 ref=\"layerName\"\r\n                        title={this.props.layer.name}\r\n                        tabIndex='1'\r\n                    >\r\n                        {this.props.layer.name}\r\n                    </h4>\r\n                </div>\r\n\r\n            </li>,\r\n\r\n            <ModalPopup\r\n                key={2}\r\n                showPopup={this.props.layer.edited}\r\n                closePopup={this.props.onEscapeLayerEditForm}\r\n            >\r\n                <LayerEditForm\r\n                    layer={this.props.layer}\r\n                    onSubmitLayerEditForm={this.props.onSubmitLayerEditForm}\r\n                    onEscapeLayerEditForm={this.props.onEscapeLayerEditForm}\r\n                />\r\n            </ModalPopup>\r\n        ]\r\n    }\r\n}\r\n\r\nexport default LayerListElement;\r\n","/**\r\n * Created by alexanderbol on 17/04/2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport LayerListToolbar from \"../../components/LayersList/LayerListToolbar/LayerListToolbar\";\r\nimport LayerListElement from '../../components/LayersList/LayerListElement/LayerListElement';\r\nimport * as actions from '../../store/actions/layersActions';\r\nimport { connect } from 'react-redux';\r\nimport styles from './LayersList.module.css';\r\n\r\nclass LayersList extends Component {\r\n    height = 0;\r\n\r\n    handleKeyDown = (e) => {\r\n        // e.stopPropagation();\r\n        // e.preventDefault();\r\n\r\n        if (e.target.parentElement.parentElement &&\r\n            e.target.parentElement.parentElement.parentElement &&\r\n            e.target.parentElement.parentElement.parentElement.id &&\r\n            e.target.parentElement.parentElement.parentElement.id === \"layersList\") {\r\n\r\n\r\n            switch (e.code) {\r\n                case \"ArrowRight\":\r\n                case \"ArrowDown\":\r\n                    this.props.setAffectedNextLayer();\r\n                    break;\r\n                case \"ArrowLeft\":\r\n                case \"ArrowUp\":\r\n                    this.props.setAffectedPrevLayer();\r\n                    break;\r\n                /* tab does not work properly\r\n            case \"Tab\":\r\n                if (e.shiftKey) {\r\n                    this.dispatch({\r\n                        type: ActionTypes.LAYERS_LIST_ARROW_UP_PRESSED\r\n                    });\r\n                }\r\n                else {\r\n                    this.dispatch({\r\n                        type: ActionTypes.LAYERS_LIST_ARROW_DOWN_PRESSED\r\n                    });\r\n                }\r\n                break;\r\n                */\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    onLayerListClicked = () => {\r\n        this.forceUpdate();\r\n    };\r\n\r\n    componentDidMount() {\r\n        // Keyboard event\r\n        // var _keydown = _.throttle(this.keydown, 100);\r\n        document.addEventListener('keydown', this.handleKeyDown);\r\n        // var _keyup = _.throttle(this.keyup, 500);\r\n        // document.addEventListener('keyup', this.handleKeyUp);\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        this.height = this.refs.layersComponent.clientHeight;\r\n    }\r\n\r\n    render() {\r\n        const style = this.props.showLayerList ? styles[\"App-layers-displayed\"] : styles[\"App-layers\"];\r\n        return (\r\n            <div className={style}\r\n                 ref=\"layersComponent\"\r\n                 onClick={this.onLayerListClicked}\r\n            >\r\n                {/*<h5>Layers</h5>*/}\r\n                <LayerListToolbar\r\n                    onAddLayerButtonClicked={() => this.props.onAddLayerButtonClicked(this.props.stage)}\r\n                    onEditLayerButtonClicked={this.props.onEditLayerButtonClicked}\r\n                    onDeleteLayerButtonClicked={this.props.onDeleteLayerButtonClicked}\r\n                    onSortLayersButtonClicked={this.props.onSortLayersButtonClicked}\r\n                />\r\n                <ul id=\"layersList\"\r\n                    style={{maxHeight:0.82*(this.height-40)}}>\r\n                { this.props.layers.map((layer) =>\r\n                    <LayerListElement\r\n                        key={layer.name}\r\n                        layer={layer}\r\n                        onLayerClicked={() => this.props.onLayerClicked(layer)}\r\n                        onAffectedBoxClicked={(event) => this.props.onAffectedBoxClicked(event, layer)}\r\n                        onSubmitLayerEditForm={this.props.onSubmitLayerEditForm}\r\n                        onEscapeLayerEditForm={this.props.onEscapeLayerEditForm}\r\n                    />)\r\n                }\r\n                </ul>\r\n                {/*{addLayer}*/}\r\n            </div>\r\n        )\r\n\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        layers: state.layers,\r\n        stage: state.app.stage,\r\n        showLayerList: state.app.showLayerList         // on mobile device\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        onAddLayerButtonClicked: (stage) => dispatch(actions.addEmptyLayer(stage)),\r\n        onEditLayerButtonClicked: () => dispatch(actions.openAffectedLayerEditForm()),\r\n        onDeleteLayerButtonClicked: () => dispatch(actions.deleteAffectedLayer()),\r\n        onSortLayersButtonClicked: () => dispatch(actions.sortLayers()),\r\n        onLayerClicked: (layer) => dispatch(actions.toggleDisplayLayer(layer)),\r\n        onAffectedBoxClicked: (event, layer) => dispatch(actions.toggleAffectedLayer(event, layer)),\r\n        onSubmitLayerEditForm: (newLayer) => dispatch(actions.updateLayer(newLayer)),\r\n        onEscapeLayerEditForm: () => dispatch(actions.closeEditLayerForm()),\r\n        setAffectedNextLayer: () => dispatch(actions.setAffectedNextLayer()),\r\n        setAffectedPrevLayer: () => dispatch(actions.setAffectedPrevLayer())\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LayersList);\r\n\r\n// export default LayersList;","/**\r\n * Created by alexanderbol on 06/05/2017.\r\n */\r\n\r\nimport React from 'react';\r\nimport styles from './AsideComponent.module.css';\r\n\r\nconst AsideComponent = () => {\r\n    return (\r\n        <aside className={styles[\"App-aside\"]}>\r\n            <h5>&nbsp;</h5>\r\n        </aside>\r\n    )\r\n};\r\n\r\nexport default AsideComponent;\r\n","import React, {Component} from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport Button from '../../../components/UI/Button/Button';\r\nimport classes from './DocumentName.module.css';\r\n\r\nclass DocumentName extends Component {\r\n    state = {\r\n        name: \"\"\r\n    };\r\n\r\n    handleChange = (ev) => {\r\n        let name = ev.target.value;\r\n        this.setState({name: name});\r\n        this.props.updateDocumentName(name);\r\n    };\r\n\r\n    shareDocument = () => {\r\n        if (window.navigator.share) {\r\n            window.navigator.share({\r\n                title: 'Share document',\r\n                text: `${this.props.username} shared a document with you.\r\nClick on the link below to open it:`,\r\n                url: window.location.href,\r\n            }).then( (resp) => {\r\n                    console.log(\"shared\")\r\n                })\r\n                .catch( (error) => {})\r\n        }\r\n    };\r\n\r\n    static getDerivedStateFromProps(nextProps, prevState){\r\n        return {\r\n            name : nextProps.name\r\n        };\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={classes.DocumentName}>\r\n                <input type=\"text\" placeholder=\"Document Name\"  value={this.state.name} onChange={this.handleChange} />\r\n                {window.navigator.share ?\r\n                    <Button type=\"trigger\" mobileOnly title=\"Share document\" iconName='share-alt' onClick={this.shareDocument}/> :\r\n                    null\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(DocumentName);","import React from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport * as ActionTypes from \"./store/actionTypes\";\r\nimport * as cloudActions from \"./store/actions/cloudStorageActions\";\r\nimport MainComponent from \"./containers/MainComponent/MainComponent\";\r\nimport LayersList from \"./containers/LayerList/LayersList\";\r\nimport AsideComponent from \"./components/Layout/AsideComponent/AsideComponent\";\r\nimport DocumentName from \"./components/MainComponent/DocumentName/DocumentName\";\r\n\r\nconst appBody = (props) => {\r\n    return (\r\n        <React.Fragment>\r\n            {/*<DocumentName name={props.document.name}*/}\r\n                          {/*username={props.username}*/}\r\n                          {/*updateDocumentName={props.updateDocumentName} />*/}\r\n            <div className=\"App-body\" onPaste={props.pasteDataFromBuffer}>\r\n                <MainComponent history={props.history}\r\n                               onManageCloudStorageButtonClicked={props.onManageCloudStorageButtonClicked}\r\n                />\r\n                <LayersList/>\r\n                <AsideComponent/>\r\n            </div>\r\n        </React.Fragment>\r\n    );\r\n};\r\n\r\nconst mapStateToProps = ({cloudStorage, auth}) => {\r\n    return {\r\n        document: cloudStorage.document,\r\n        username: auth.username\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        pasteDataFromBuffer: (event) => dispatch({\r\n            type: ActionTypes.DATA_FROM_BUFFER_PASTED,\r\n            data: event.clipboardData\r\n        }),\r\n        updateDocumentName: (name) => dispatch(cloudActions.updateDocumentName(name))\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(appBody);\r\n","/**\r\n * Created by alexanderbol on 13/04/2017.\r\n */\r\nimport React from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport classes from './HeaderComponent.module.css';\r\n// import Logo from './Logo/Logo';\r\n// import Navigation from './Navigation/Navigation';\r\n\r\nconst HeaderComponent = (props) => {\r\n    const style = props.location.pathname === \"/documents\" ?\r\n        classes[\"App-header-documents-page\"] :\r\n        classes[\"App-header\"];\r\n    return (\r\n        <header className={style}>\r\n            <h2>Debug Viewer</h2>\r\n        </header>\r\n    )\r\n};\r\n\r\nexport default withRouter(HeaderComponent);\r\n\r\n/*\r\n<header className={style}>\r\n    <Logo />\r\n    <Navigation isAuthenticated={props.isAuthenticated} />\r\n    {props.isAuthenticated ? <span>Hello {props.username}</span> : null}\r\n    {props.location.pathname === \"/documents\" ? <hr/> : null}\r\n</header>\r\n*/","import {Box} from '@flatten-js/core';\r\n\r\nexport class Job {\r\n    constructor() {\r\n        this.filename = \"\";\r\n        this.title = \"\";\r\n        this.profiles = [];   // array of FlattenJS Polygons\r\n        this.materials = [];  // array of FlattenJS Polygons\r\n        this.shapes = [];     // array of other FlattenJS shapes\r\n    }\r\n\r\n    get box() {\r\n        let b = new Box();\r\n        for (let shape of this.profiles) {\r\n            b.merge(shape.box);\r\n        }\r\n        for (let shape of this.materials) {\r\n            b.merge(shape.box);\r\n        }\r\n        for (let shape of this.shapes) {\r\n            b.merge(shape.box);\r\n        }\r\n        return b;\r\n    }\r\n}","import { Job } from '../models/job';\r\nimport {Point, Segment, Arc, Polygon, Utils, vector} from '@flatten-js/core';\r\nimport Flatten from '@flatten-js/core';\r\n\r\nconst inch2pixels = 10160000;\r\nconst mils2pixels = 10160;\r\nfunction InchToPixels(str) {\r\n    return Math.round(Number(str)*inch2pixels,0);\r\n}\r\nfunction MilsToPixels(str) {\r\n    return Math.round(Number(str)*mils2pixels,0);\r\n}\r\n\r\nfunction parsePolygon(lines, start) {\r\n    let shapes = [];\r\n    let i = start;\r\n    let line = lines[i];\r\n    let terms = line.split(' ');\r\n    let ps = new Point( InchToPixels(terms[1]), InchToPixels(terms[2]) );\r\n    let pe;\r\n    let pc;\r\n    let end_of_face = false;\r\n    while(true) {\r\n        line = lines[i];\r\n        terms = line.split(' ');\r\n        switch (terms[0]) {\r\n            case 'OS':\r\n                pe = new Point( InchToPixels(terms[1]), InchToPixels(terms[2]) );\r\n                shapes.push( new Segment(ps, pe));\r\n\r\n                ps = pe.clone();\r\n                break;\r\n            case 'OC':\r\n                pe = new Point( InchToPixels(terms[1]), InchToPixels(terms[2]) );\r\n                pc = new Point( InchToPixels(terms[3]), InchToPixels(terms[4]) );\r\n\r\n                let cwStr = terms[5];\r\n                let counterClockwise = cwStr === 'Y' ? Flatten.CW : Flatten.CCW; /* sic ! */\r\n\r\n                let startAngle = vector(pc,ps).slope;\r\n                let endAngle = vector(pc, pe).slope;\r\n                if (Utils.EQ(startAngle, endAngle)) {\r\n                    endAngle += 2*Math.PI;\r\n                    counterClockwise = true;\r\n                }\r\n                let r = vector(pc, ps).length;\r\n\r\n                shapes.push(new Arc(pc, r, startAngle, endAngle, counterClockwise));\r\n\r\n                ps = pe.clone();\r\n                break;\r\n            case 'OE':\r\n                end_of_face = true;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (end_of_face) {\r\n            break;\r\n        }\r\n\r\n        i++;\r\n    }\r\n    return shapes;\r\n}\r\n\r\nfunction parseLine(str, apertures) {\r\n    let terms = str.split(' ');\r\n    let ps = new Point( InchToPixels(terms[1]), InchToPixels(terms[2]) );\r\n    let pe = new Point( InchToPixels(terms[3]), InchToPixels(terms[4]) );\r\n    let segment = new Segment(ps, pe);\r\n    let ap_key = Number(terms[5]);\r\n    let ap_value = apertures[ap_key];\r\n    segment.aperture = ap_value;     // augmentation\r\n    return segment;\r\n}\r\n\r\nfunction parseArc(str, apertures) {\r\n    let terms = str.split(' ');\r\n    let ps = new Point( InchToPixels(terms[1]), InchToPixels(terms[2]) );\r\n    let pe = new Point( InchToPixels(terms[3]), InchToPixels(terms[4]) );\r\n    let pc = new Point( InchToPixels(terms[5]), InchToPixels(terms[6]) );\r\n\r\n    let cwStr = terms[10];\r\n    let counterClockwise = cwStr === 'Y' ? Flatten.CW : Flatten.CCW; /* sic ! */\r\n\r\n    let startAngle = vector(pc,ps).slope;\r\n    let endAngle = vector(pc, pe).slope;\r\n    if (Flatten.Utils.EQ(startAngle, endAngle)) {\r\n        endAngle += 2*Math.PI;\r\n        counterClockwise = true;\r\n    }\r\n    let r = vector(pc, ps).length;\r\n\r\n    let arc = new Arc(pc, r, startAngle, endAngle, counterClockwise);\r\n\r\n    let ap_key = Number(terms[7]);\r\n    let ap_value = apertures[ap_key];\r\n    arc.aperture = ap_value;     // augmentation\r\n\r\n    return arc;\r\n}\r\n\r\nexport function parseODB(filename, str) {\r\n    let job = new Job();\r\n    job.filename = filename;\r\n\r\n    let arrayOfLines = str.match(/[^\\r\\n]+/g);\r\n    let polygon;\r\n\r\n    let apertures = [];\r\n\r\n    for (let i=0; i < arrayOfLines.length; i++) {\r\n        let line = arrayOfLines[i];\r\n        let terms = line.split(' ');\r\n\r\n        if (terms[0].substr(0,1) === '$') {\r\n            let ap_key = Number(terms[0].substr(1));\r\n            let ap_value = MilsToPixels(terms[1].substr(1));\r\n            apertures[ap_key] = ap_value;\r\n            continue;\r\n        }\r\n\r\n        switch (terms[0]) {\r\n            case 'S':                  // surface started\r\n                polygon = new Polygon();\r\n                let termArr = line.split(' ');\r\n                let polarity = termArr[1];      // consider later\r\n                polygon.polarity = polarity;\r\n                break;\r\n            case 'OB':                  // polygon started\r\n                let start = i;\r\n                let shapes = parsePolygon(arrayOfLines, start);\r\n                polygon.addFace(shapes);\r\n                i = start + shapes.length + 1;\r\n                break;\r\n            case 'SE':     // surface ended\r\n                job.shapes.push(polygon);\r\n                break;\r\n            case 'L':                  // line\r\n                let odbLine = parseLine(line, apertures);\r\n                job.shapes.push(odbLine);\r\n                break;\r\n            case 'A':                  // Arc\r\n                let odbArc = parseArc(line, apertures);\r\n                job.shapes.push(odbArc);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    return job;\r\n}","import /*React,*/ {Component} from 'react';\r\nimport axios from \"axios\";\r\n\r\nimport Layers from \"../../models/layers\";\r\nimport {parseODB} from \"../../dataParsers/parserODB\";\r\nimport Model from \"../../models/model\";\r\nimport * as ActionTypes from \"../../store/actionTypes\";\r\nimport * as actions from '../../store/actions/appActions';\r\nimport { connect } from 'react-redux';\r\n\r\nclass Demo extends Component {\r\n    state={\r\n        done:false\r\n    };\r\n    componentDidUpdate() {\r\n        if (this.props.stage && !this.state.done) {\r\n            let stage = this.props.stage;\r\n            let layers = this.props.layers;\r\n\r\n            let layer = Layers.newLayer(stage, layers);\r\n            layer.color = Layers.getNextColor(layers);\r\n            layer.name = \"features\";\r\n            layer.title = \"features\";\r\n            layer.affected = true;\r\n            layer.displayed = true;\r\n\r\n            axios(\"https://gist.githubusercontent.com/alexbol99/825fdf2dd508467cc852eb22aa36183d/raw/d10e853338afd8294eeb3ffdebe3bc380477a978/features\")\r\n                .then( (resp) => {\r\n                    let job = parseODB(\"features\", resp.data);\r\n\r\n                    for (let shape of job.shapes) {\r\n                        let model = new Model(shape, undefined, shape.label);\r\n                        layer.add(model);\r\n                    }\r\n\r\n                    this.props.panAndZoomToShape(stage, layer);\r\n                    this.props.addNewLayer(layer);\r\n                    this.props.asyncOperationEnded();\r\n                });\r\n            this.setState({done:true});\r\n            this.props.asyncOperationStarted();\r\n        }\r\n    }\r\n    componentDidMount() {\r\n\r\n    }\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        layers: state.layers,\r\n        stage: state.app.stage\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        panAndZoomToShape: (stage, layer) => dispatch({\r\n            type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n            stage: stage,\r\n            shape: layer\r\n        }),\r\n        addNewLayer: (layer) => dispatch({\r\n            type: ActionTypes.ADD_NEW_LAYER,\r\n            layer: layer\r\n        }),\r\n        asyncOperationStarted: () => dispatch(actions.asyncOperationStarted()),\r\n        asyncOperationEnded: () => dispatch(actions.asyncOperationEnded())\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Demo);\r\n","import /*React,*/ {Component} from 'react';\r\nimport * as ActionTypes from \"../../store/actionTypes\";\r\nimport { connect } from 'react-redux';\r\n\r\nclass SkeletonRecognition extends Component {\r\n    componentDidMount() {\r\n        this.props.applySkeletonRecognition();\r\n    }\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        layers: state.layers,\r\n        stage: state.app.stage\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        applySkeletonRecognition: () => dispatch({type: ActionTypes.SKELETON_RECOGNITION_URI})\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SkeletonRecognition);\r\n","import Flatten from \"@flatten-js/core\";\r\nimport {Vector, Segment, Arc, Line, Box, Polygon} from \"@flatten-js/core\";\r\n// let Flatten = require('flatten-js');\r\n\r\n// let {Vector, Segment, Arc, Line, Box, Polygon} = Flatten;\r\n\r\nclass CollisionDistance {\r\n    static apply(polygon1, polygon2) {\r\n        let collision_distance = Number.POSITIVE_INFINITY;\r\n        for (let edge of [...polygon2.edges]) {\r\n            let distance = CollisionDistance.edge2polygon(edge, polygon1);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        return collision_distance;\r\n    }\r\n\r\n    static edge2polygon(edge2, polygon1) {\r\n        let shapeBox = edge2.shape.box;\r\n        let box = new Box(\r\n            Number.NEGATIVE_INFINITY,\r\n            shapeBox.ymin,\r\n            Number.POSITIVE_INFINITY,\r\n            shapeBox.ymax\r\n        );\r\n        let collision_distance = Number.POSITIVE_INFINITY;\r\n        let resp_edges =  polygon1.edges.search(box);\r\n        for (let edge1 of resp_edges) {\r\n            let distance;\r\n            if (edge1.shape instanceof Segment && edge2.shape instanceof Segment) {\r\n                distance = CollisionDistance.segment2segment(edge1.shape, edge2.shape);\r\n            }\r\n            else if (edge1.shape instanceof Arc && edge2.shape instanceof Segment) {\r\n                distance = CollisionDistance.segment2arc(edge2.shape, edge1.shape);\r\n            }\r\n            else if (edge1.shape instanceof Segment && edge2.shape instanceof Arc) {\r\n                distance = CollisionDistance.segment2arc(edge1.shape, edge2.shape);\r\n            }\r\n            else if (edge1.shape instanceof Arc && edge2.shape instanceof Arc) {\r\n                distance = CollisionDistance.arc2arc(edge1.shape, edge2.shape);\r\n            }\r\n\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        return collision_distance;\r\n    }\r\n\r\n    static point2shape(point, shape) {\r\n        let line = new Line(point, new Vector(0,1));\r\n        let intersections = line.intersect(shape);          // segment or arc\r\n        let collision_distance = Number.POSITIVE_INFINITY;\r\n        for (let ip of intersections) {\r\n            // eslint-disable-next-line\r\n            let [distance, shortest_segment] = point.distanceTo(ip);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        return collision_distance;\r\n    }\r\n\r\n    static segment2segment(segment1, segment2) {\r\n        let collision_distance = Number.POSITIVE_INFINITY;\r\n        for (let point of segment1.vertices) {\r\n            let distance = CollisionDistance.point2shape(point, segment2);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        for (let point of segment2.vertices) {\r\n            let distance = CollisionDistance.point2shape(point, segment1);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        return collision_distance;\r\n    }\r\n\r\n    static segment2arc(segment, arc) {\r\n        let collision_distance = Number.POSITIVE_INFINITY;\r\n        let v_s = new Vector(segment.start, segment.end);\r\n        v_s = v_s.normalize();\r\n\r\n        let v_n = [v_s.rotate90CCW().multiply(arc.r), v_s.rotate90CW().multiply(arc.r)];\r\n        let distance;\r\n\r\n        // Distance between tangent point and segment\r\n        for (let v of v_n) {\r\n            let tangent_point = arc.center.translate(v);  // tangent point in direction of the normal vector\r\n            if (tangent_point.on(arc)) {\r\n                distance = CollisionDistance.point2shape(tangent_point, segment);\r\n                if (distance < collision_distance) {\r\n                    collision_distance = distance;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let point of arc.vertices) {\r\n            let distance = CollisionDistance.point2shape(point, segment);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        for (let point of segment.vertices) {\r\n            let distance = CollisionDistance.point2shape(point, arc);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        return collision_distance;\r\n    }\r\n\r\n    static arc2arc(arc1, arc2) {\r\n        let collision_distance = Number.POSITIVE_INFINITY;\r\n        let distance;\r\n\r\n        // test translation of arc2.center to arc1 enlarged by r2\r\n        let arc_enlarged = arc1.clone();\r\n        arc_enlarged.r += arc2.r;\r\n        distance = CollisionDistance.point2shape(arc2.center, arc_enlarged);\r\n        if (distance < collision_distance) {\r\n            // additional check that transformed arc actually touching\r\n            // eslint-disable-next-line\r\n            let [dist_tmp, shortest_segment_tmp] =\r\n                arc1.distanceTo( CollisionDistance.translateArc(arc2, new Vector(-distance,0)));\r\n            if (Flatten.Utils.EQ_0(dist_tmp)) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n\r\n        // test translation of arc2.center to arc1 reduced by r2\r\n        if (Flatten.Utils.GE(arc1.r, arc2.r)) {\r\n            let arc_reduced = arc1.clone();\r\n            arc_reduced.r -= arc2.r;\r\n            distance = CollisionDistance.point2shape(arc2.center, arc_reduced);\r\n            if (distance < collision_distance) {\r\n                // additional check that transformed arc actually touching\r\n                // eslint-disable-next-line\r\n                let [dist_tmp, shortest_segment_tmp] =\r\n                    arc1.distanceTo( CollisionDistance.translateArc(arc2, new Vector(-distance,0)));\r\n                if (Flatten.Utils.EQ_0(dist_tmp)) {\r\n                    collision_distance = distance;\r\n                }\r\n            }\r\n        }\r\n\r\n        // test translation of arc1.center to arc2 reduced by r1\r\n        if (Flatten.Utils.LT(arc1.r, arc2.r)) {\r\n            let arc_reduced = arc2.clone();\r\n            arc_reduced.r -= arc1.r;\r\n            distance = CollisionDistance.point2shape(arc1.center, arc_reduced);\r\n            if (distance < collision_distance) {\r\n                // additional check that transformed arc actually touching\r\n                // eslint-disable-next-line\r\n                let [dist_tmp, shortest_segment_tmp] =\r\n                    arc1.distanceTo( CollisionDistance.translateArc(arc2, new Vector(-distance,0)));\r\n                if (Flatten.Utils.EQ_0(dist_tmp)) {\r\n                    collision_distance = distance;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let point of arc1.vertices) {\r\n            let distance = CollisionDistance.point2shape(point, arc2);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        for (let point of arc2.vertices) {\r\n            let distance = CollisionDistance.point2shape(point, arc1);\r\n            if (distance < collision_distance) {\r\n                collision_distance = distance;\r\n            }\r\n        }\r\n        return collision_distance;\r\n    }\r\n\r\n    static translateArc(arc, vec) {\r\n        let arc_tmp = arc.clone();\r\n        arc_tmp.pc = arc_tmp.pc.translate(vec);\r\n        return arc_tmp;\r\n    }\r\n\r\n    static translate(polygon, vec) {\r\n        let newPolygon = new Polygon();\r\n        for (let face of polygon.faces) {\r\n            let shapes = [];\r\n            for (let edge of face) {\r\n                if (edge.shape instanceof Segment) {\r\n                    shapes.push(\r\n                        new Segment(edge.shape.ps.translate(vec), edge.shape.pe.translate(vec))\r\n                    )\r\n                }\r\n                else if (edge.shape instanceof  Arc) {\r\n                    let arc_trans = edge.shape.clone();\r\n                    arc_trans.pc = edge.shape.pc.translate(vec);\r\n                    shapes.push(arc_trans);\r\n                }\r\n            }\r\n            newPolygon.addFace(shapes);\r\n        }\r\n        return newPolygon;\r\n    }\r\n\r\n};\r\n\r\nCollisionDistance.Flatten = Flatten;\r\n\r\nexport default CollisionDistance;\r\n","import /*React,*/ {Component} from 'react';\r\nimport Flatten from '@flatten-js/core';\r\nimport CollisionDistance from \"../../models/collisionDistance\";\r\nimport axios from \"axios\";\r\nimport Layers from \"../../models/layers\";\r\n// import {Model} from \"../../models/model\";\r\nimport * as ActionTypes from \"../../store/actionTypes\";\r\nimport { connect } from \"react-redux\";\r\nimport * as actions from \"../../store/actions/appActions\";\r\n\r\nlet {vector} = Flatten;\r\n\r\nclass CollisionDemo extends Component {\r\n    state={\r\n        done:false,\r\n        data:[]\r\n    };\r\n    componentDidUpdate() {\r\n        if (this.props.stage && !this.state.done) {\r\n            let stage = this.props.stage;\r\n            let layers = this.props.layers;\r\n\r\n            let layer = Layers.newLayer(stage, layers);\r\n            layer.color = Layers.getNextColor(layers);\r\n            layer.name = \"collision_demo\";\r\n            layer.title = \"collision_demo\";\r\n            layer.affected = true;\r\n            layer.displayed = true;\r\n\r\n            axios(\"https://gist.githubusercontent.com/alexbol99/81893d40ec5eaa00d0336c35e069dd73/raw/b9328a4c6d7d6a44f375c68b4ec207690f40fd19/Block_53388_2parts_Cont.txt\")\r\n                .then( (resp) => {\r\n                    let parser = this.props.parser;\r\n                    let polygon1 = parser.parseToPolygon(resp.data);\r\n                    layer.add(polygon1);\r\n\r\n                    let vec = vector( 2*(polygon1.box.xmax - polygon1.box.xmin), 0 );\r\n                    let polygon2 = polygon1.translate(vec);\r\n                    layer.add(polygon2);\r\n\r\n                    let collision = CollisionDistance.apply(polygon2, polygon1);\r\n                    let polygon3 = polygon2.translate(vector(-collision, 0));\r\n                    layer.add(polygon3);\r\n\r\n                    // layers.push(layer);\r\n\r\n                    this.props.panAndZoomToShape(stage, layer);\r\n                    this.props.addNewLayer(layer);\r\n                    this.props.applyCollisionDemo();\r\n                    this.props.asyncOperationEnded();\r\n                });\r\n            this.setState({done:true});\r\n            this.props.asyncOperationStarted();\r\n        }\r\n    }\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        layers: state.layers,\r\n        stage: state.app.stage,\r\n        parser: state.app.parser\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        panAndZoomToShape: (stage, layer) => dispatch({\r\n            type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n            stage: stage,\r\n            shape: layer\r\n        }),\r\n        addNewLayer: (layer) => dispatch({\r\n            type: ActionTypes.ADD_NEW_LAYER,\r\n            layer: layer\r\n        }),\r\n        applyCollisionDemo: () => dispatch({\r\n            type: ActionTypes.COLLISION_DEMO_URI\r\n        }),\r\n        asyncOperationStarted: () => dispatch(actions.asyncOperationStarted()),\r\n        asyncOperationEnded: () => dispatch(actions.asyncOperationEnded())\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CollisionDemo);\r\n","import React from 'react';\r\nimport Modal from '../Modal';\r\nimport classes from './Spinner.module.css';\r\n\r\nconst spinner = () => {\r\n    return (\r\n        <Modal>\r\n            <div className={classes.BackDrop} >\r\n                <div className={classes.Loader}>Loading ...</div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default spinner;","import * as actionTypes from '../actionTypes';\r\nimport axios from 'axios';\r\n\r\nconst apiKey = \"AIzaSyDMUAcjgolAlapdpFmPEz8SaId1DZw7MpQ\";\r\n\r\nexport const authStart = () => {\r\n    return {\r\n        type: actionTypes.AUTHENTICATION_STARTED\r\n    }\r\n};\r\n\r\nexport const authSucceed = (token, userId, username=null) => {\r\n    return {\r\n        type: actionTypes.AUTHENTICATION_SUCCEED,\r\n        token,\r\n        userId,\r\n        username\r\n    }\r\n};\r\n\r\nexport const authFailed = (error) => {\r\n    return {\r\n        type: actionTypes.AUTHENTICATION_FAILED,\r\n        error\r\n    }\r\n};\r\n\r\nexport const authSetUsername = (username) => {\r\n    return {\r\n        type: actionTypes.AUTHENTICATION_SET_USERNAME,\r\n        username\r\n    }\r\n};\r\n\r\nexport const logout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('expirationDate');\r\n    localStorage.removeItem('userId');\r\n    return {\r\n        type: actionTypes.AUTHENTICATION_LOGOUT\r\n    }\r\n};\r\n\r\nexport const checkAuthTimeout = (expirationTime) => {\r\n    return dispatch => {\r\n        setTimeout(() => {\r\n            const email = localStorage.getItem('email');\r\n            const password = localStorage.getItem('password');\r\n            if (email && password) {\r\n                dispatch(logIn(email, password))\r\n            }\r\n            else {\r\n                dispatch(logout())\r\n            }\r\n        }, expirationTime * 1000)\r\n    }\r\n};\r\n\r\nexport const logIn = (email, password) => {\r\n    return dispatch => {\r\n        dispatch(authStart());\r\n        const authData = {\r\n            email,\r\n            password,\r\n            returnSecureToken: true\r\n        };\r\n        localStorage.setItem('email', email);\r\n        localStorage.setItem('password', password);\r\n        const url = \"https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=\" + apiKey;\r\n        axios.post(url, authData)\r\n            .then(response => {\r\n                const expirationDate = new Date(new Date().getTime() + response.data.expiresIn * 1000);\r\n                localStorage.setItem('token', response.data.idToken);\r\n                localStorage.setItem('expirationDate', expirationDate);\r\n                localStorage.setItem('userId', response.data.localId);\r\n\r\n                dispatch(authSucceed(response.data.idToken, response.data.localId));\r\n                dispatch(checkAuthTimeout(response.data.expiresIn));\r\n                const queryParams = '?auth=' + response.data.idToken + '&orderBy=\"userId\"&equalTo=\"' + response.data.localId + '\"';\r\n                return axios.get(\"https://debug-viewer.firebaseio.com/users.json\" + queryParams);\r\n            })\r\n            .then(response => {\r\n                if (Object.values(response.data.length > 0)) {\r\n                    const username = Object.values(response.data)[0].username;\r\n                    localStorage.setItem('username', username);\r\n                    dispatch(authSetUsername(Object.values(response.data)[0].username))\r\n                }\r\n            })\r\n            .catch(error => {\r\n                dispatch(authFailed(error.response.data.error))\r\n            })\r\n    }\r\n};\r\n\r\nexport const signUp = (username, email, password) => {\r\n    return dispatch => {\r\n        dispatch(authStart());\r\n        const authData = {\r\n            email,\r\n            password,\r\n            returnSecureToken: true\r\n        };\r\n        const url = \"https://www.googleapis.com/identitytoolkit/v3/relyingparty/signupNewUser?key=\" + apiKey;\r\n        axios.post(url, authData)\r\n            .then(response => {\r\n                const expirationDate = new Date(new Date().getTime() + response.data.expiresIn * 1000);\r\n                localStorage.setItem('token', response.data.idToken);\r\n                localStorage.setItem('expirationDate', expirationDate);\r\n                localStorage.setItem('userId', response.data.localId);\r\n                localStorage.setItem('username', username);\r\n\r\n                dispatch(authSucceed(response.data.idToken, response.data.localId, username));\r\n                dispatch(checkAuthTimeout(response.data.expiresIn));\r\n\r\n                const user = {\r\n                    userId: response.data.localId,\r\n                    username: username\r\n                };\r\n                return axios.post(\"https://debug-viewer.firebaseio.com/users.json\", user);\r\n            })\r\n            .then(response => {\r\n                // do nothing\r\n            })\r\n            .catch(error => {\r\n                console.log(error.response.data.error);\r\n                dispatch(authFailed(error.response.data.error))\r\n            })\r\n    }\r\n};\r\n\r\nexport const authCheckState = () => {\r\n    return dispatch => {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n            dispatch(logout());\r\n        }\r\n        else {\r\n            const userId = localStorage.getItem('userId');\r\n            const username = localStorage.getItem('username');\r\n            const expirationDate = new Date(localStorage.getItem('expirationDate'));\r\n            if (expirationDate > new Date()) {\r\n                const timeLeft = expirationDate.getTime() - new Date().getTime()\r\n                dispatch(authSucceed(token, userId, username));\r\n                dispatch(checkAuthTimeout(timeLeft / 1000));\r\n            }\r\n            else {\r\n                dispatch(logout());\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n","import React, {Component} from 'react';\r\nimport {Route, Switch, withRouter} from 'react-router-dom';\r\n\r\nimport AppBody from './AppBody';\r\nimport HeaderComponent from './components/Layout/HeaderComponent/HeaderComponent';\r\n// import Signup from './containers/Auth/SignUp/Signup';\r\n// import Login from './containers/Auth/Login/Login';\r\n// import Logout from './containers/Auth/Logout';\r\nimport {connect} from 'react-redux';\r\n\r\nimport './App.css';\r\n\r\n// import CloudDocument from './components/Constructions/CloudDocument';\r\nimport Demo from './components/Constructions/Demo';\r\n// import BooleanTest from './components/Constructions/BooleanTest';\r\nimport SkeletonRecognition from './components/Constructions/SkeletonRecognition';\r\nimport CollisionDemo from \"./components/Constructions/CollisionDemo\";\r\nimport Spinner from \"./components/UI/Spinner/Spinner\";\r\n// import DocumentsComponent from \"./containers/DocumentsComponent/DocumentsComponent\";\r\nimport * as authActions from \"./store/actions/auth\";\r\n\r\nclass App extends Component {\r\n    componentDidMount() {\r\n        this.props.authCheckState();\r\n    }\r\n    componentDidUpdate() {\r\n        if (this.props.location.pathname === '/' && this.props.document.id !== undefined) {\r\n            this.props.history.push(\"/documents/\" + this.props.document.id)\r\n        }\r\n\r\n        // if (this.props.location.pathname.split('/').length > 2 &&\r\n        //     this.props.location.pathname.split('/')[2].length > 0 &&\r\n        //     this.props.document.id === undefined) {\r\n        //     this.props.history.push(\"/\");\r\n        // }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"App\">\r\n                <HeaderComponent\r\n                    title={this.props.title}\r\n                    version={this.props.version}\r\n                    isAuthenticated={this.props.isAuthenticated}\r\n                    username={this.props.username}\r\n                />\r\n\r\n                <Switch>\r\n                    {/*<Route path=\"/documents\" exact component={DocumentsComponent}/>*/}\r\n                    {/*<Route path=\"/signup\" component={Signup} />*/}\r\n                    {/*<Route path=\"/login\" component={Login} />*/}\r\n                    {/*<Route path=\"/logout\" component={Logout} />*/}\r\n\r\n                    <Route path=\"/\" component={AppBody}/>\r\n\r\n                    {/*<Route path=\"/documents/:id\" component={CloudDocument}/>*/}\r\n\r\n                    <Route path=\"/demo\" component={Demo}/>\r\n                    <Route path=\"/skeleton\" component={SkeletonRecognition}/>\r\n                    <Route path=\"/collision-distance\" component={CollisionDemo}/>\r\n\r\n                </Switch>\r\n\r\n                {this.props.showSpinner ? <Spinner/> : null}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = ({auth, app, cloudStorage}) => {\r\n    return {\r\n        title: app.title,\r\n        version: app.version,\r\n        showSpinner: app.showSpinner,\r\n        document: cloudStorage.document,\r\n        isAuthenticated: auth.token !== null,\r\n        username: auth.username\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        authCheckState: () => dispatch(authActions.authCheckState())\r\n    }\r\n};\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(App));\r\n\r\n/*\r\n                    <Route path=\"/boolean-test\" component={BooleanTest}/>\r\n */","import * as ActionTypes from '../store/actionTypes';\r\n\r\nconst log = ({ getState, dispatch }) => next => action => {\r\n\r\n    if(action.type !== ActionTypes.MOUSE_MOVED_ON_STAGE) {\r\n        console.log('ACTION: ' + action.type, action);\r\n    }\r\n\r\n    next(action);\r\n};\r\n\r\nexport default log;","import { Job } from '../models/job';\r\nimport {Point, Segment, Arc, Polygon, vector} from '@flatten-js/core';\r\nimport Flatten from '@flatten-js/core';\r\n\r\nFlatten.Image = class Image {\r\n    constructor() {\r\n        this.uri = \"\";\r\n        /**\r\n         * Center in world coordinates\r\n         * @type {Flatten.Point}\r\n         */\r\n        this.center = new Flatten.Point();\r\n        /**\r\n         * Width in world units (inch/mm)\r\n         */\r\n        this.width = 0;\r\n        /**\r\n         * Height in world units (inch/mm)\r\n         */\r\n        this.height = 0;\r\n    }\r\n    get box() {\r\n        return new Flatten.Box(\r\n            this.center.x - this.width/2,\r\n            this.center.y - this.height/2,\r\n            this.center.x + this.height/2,\r\n            this.center.y + this.height/2\r\n        );\r\n\r\n    }\r\n};\r\n\r\nfunction parseEdges(edgesXML) {\r\n    let edges = [];\r\n\r\n    for (let edge of Array.from(edgesXML)) {\r\n        let type = edge.getAttribute('type');\r\n\r\n        if (type === \"segment\") {\r\n            let ps = new Point(parseInt(edge.getAttribute('xs'),10), parseInt(edge.getAttribute('ys'),10));\r\n            let pe = new Point(parseInt(edge.getAttribute('xe'),10), parseInt(edge.getAttribute('ye'),10));\r\n\r\n            edges.push(new Segment(ps, pe));\r\n        }\r\n\r\n        if (type === \"curve\") {\r\n            let ps = new Point(parseInt(edge.getAttribute('xs'),10), parseInt(edge.getAttribute('ys'),10));\r\n            let pe = new Point(parseInt(edge.getAttribute('xe'),10), parseInt(edge.getAttribute('ye'),10));\r\n            let pc = new Point(parseInt(edge.getAttribute('xc'),10), parseInt(edge.getAttribute('yc'),10));\r\n\r\n            let counterClockwise = edge.getAttribute('cw') === 'no' ? true : false;\r\n\r\n            let startAngle = vector(pc,ps).slope;\r\n            let endAngle = vector(pc, pe).slope;\r\n\r\n            if (Flatten.Utils.EQ(startAngle, endAngle)) {\r\n                endAngle = counterClockwise ? endAngle + 2*Math.PI : endAngle - 2*Math.PI;\r\n            }\r\n\r\n            let r = vector(pc, ps).length;\r\n\r\n            edges.push(new Arc(pc, r, startAngle, endAngle, counterClockwise));\r\n        }\r\n    }\r\n\r\n    return edges;\r\n}\r\n\r\nfunction parsePolygon(polygonsXML) {\r\n    let polygon = new Polygon();\r\n\r\n    // let nedges = parseInt(profile.getAttribute(\"n_edges\"), 10);\r\n\r\n    // Augment Flatten object with style\r\n    let color = polygonsXML.getAttribute(\"color\");\r\n    polygon.style = {\r\n        stroke: color || undefined,\r\n        fill: color || undefined,\r\n        alpha: 1.0\r\n    };\r\n\r\n    // Augment Flatten object with label\r\n    let label = polygonsXML.getAttribute(\"label\");\r\n    polygon.label = label;\r\n\r\n    // Add islands\r\n    let islands = polygonsXML.getElementsByTagName('island');\r\n    for (let island of Array.from(islands)) {\r\n        let edgesXML = island.getElementsByTagName('edge');\r\n        polygon.addFace(parseEdges(edgesXML));\r\n    }\r\n\r\n    // Add holes\r\n    let holes = polygonsXML.getElementsByTagName('hole');\r\n    for (let hole of Array.from(holes)) {\r\n        let edgesXML = hole.getElementsByTagName('edge');\r\n        polygon.addFace(parseEdges(edgesXML));\r\n    }\r\n\r\n    return polygon;\r\n}\r\n\r\nfunction parseSegment(segmentXML) {\r\n    let ps = new Point(parseInt(segmentXML.getAttribute('xs'),10), parseInt(segmentXML.getAttribute('ys'),10));\r\n    let pe = new Point(parseInt(segmentXML.getAttribute('xe'),10), parseInt(segmentXML.getAttribute('ye'),10));\r\n\r\n    let segment = new Segment(ps, pe);\r\n\r\n    // Augment Flatten object with label property\r\n    let label = segmentXML.getAttribute(\"label\");\r\n    segment.label = label;\r\n\r\n    return segment;\r\n}\r\n\r\nfunction parseCurve(curveXML) {\r\n    let ps = new Point(parseInt(curveXML.getAttribute('xs'),10), parseInt(curveXML.getAttribute('ys'),10));\r\n    let pe = new Point(parseInt(curveXML.getAttribute('xe'),10), parseInt(curveXML.getAttribute('ye'),10));\r\n    let pc = new Point(parseInt(curveXML.getAttribute('xc'),10), parseInt(curveXML.getAttribute('yc'),10));\r\n\r\n    let counterClockwise = curveXML.getAttribute('cw') === 'no' ? true : false;\r\n\r\n    let startAngle = vector(pc,ps).slope;\r\n    let endAngle = vector(pc, pe).slope;\r\n\r\n    if (Flatten.Utils.EQ(startAngle, endAngle)) {\r\n        endAngle = counterClockwise ? endAngle + 2*Math.PI : endAngle - 2*Math.PI;\r\n    }\r\n\r\n    let r = vector(pc, ps).length;\r\n\r\n    let arc = new Arc(pc, r, startAngle, endAngle, counterClockwise);\r\n\r\n    // Augment Flatten object with label property\r\n    let label = curveXML.getAttribute(\"label\");\r\n    arc.label = label;\r\n\r\n    return arc;\r\n}\r\n\r\nfunction parsePoint(pointXML) {\r\n    let point = new Point(parseInt(pointXML.getAttribute('x'),10), parseInt(pointXML.getAttribute('y'),10));\r\n\r\n    // Augment Flatten object with label property\r\n    let label = pointXML.getAttribute(\"label\");\r\n    point.label = label;\r\n\r\n    return point;\r\n}\r\n\r\nfunction parseImage(imageXML) {\r\n    let img = new Flatten.Image();\r\n    img.center = new Point(parseInt(imageXML.getAttribute('xc'),10), parseInt(imageXML.getAttribute('yc'),10));\r\n    img.width = parseInt(imageXML.getAttribute('width'),10);\r\n    img.height = parseInt(imageXML.getAttribute('height'),10);\r\n    img.uri = imageXML.getAttribute('uri');\r\n    return img;\r\n}\r\n\r\nexport function parseXML(filename, str) {\r\n    let job = new Job();\r\n\r\n    job.filename = filename;\r\n\r\n    let parser = new DOMParser();\r\n    let xmlDoc = parser.parseFromString(str, \"text/xml\");\r\n\r\n    // Parse document title\r\n    let titles = xmlDoc.getElementsByTagName('title');\r\n    if (titles && titles.length > 0) {\r\n        job.title = titles[0].firstChild.nodeValue;          // take the first title if more than one\r\n    }\r\n\r\n    // Parse profiles and add polygons to the job\r\n    let profilesXML = xmlDoc.getElementsByTagName('profile');\r\n    for (let profileXML of Array.from(profilesXML)) {\r\n        let polygon = parsePolygon(profileXML);\r\n        job.profiles.push(polygon);\r\n    }\r\n\r\n    // Parse materials and add polygons to the job\r\n    let materialXML = xmlDoc.getElementsByTagName('material');\r\n    for (let shapeXML of Array.from(materialXML)) {\r\n        let polygon = parsePolygon(shapeXML);\r\n        job.materials.push(polygon);\r\n    }\r\n\r\n    // Parse segments\r\n    let segmentsXML = xmlDoc.getElementsByTagName('segment');\r\n    for (let segmentXML of Array.from(segmentsXML)) {\r\n        let segment = parseSegment(segmentXML);\r\n        job.shapes.push(segment);\r\n    }\r\n\r\n    // Parse segments\r\n    let curvesXML = xmlDoc.getElementsByTagName('curve');\r\n    for (let curveXML of Array.from(curvesXML)) {\r\n        let curve = parseCurve(curveXML);\r\n        job.shapes.push(curve);\r\n    }\r\n\r\n    // Parse points\r\n    let pointsXML = xmlDoc.getElementsByTagName('point');\r\n    for (let pointXML of Array.from(pointsXML)) {\r\n        let point = parsePoint(pointXML);\r\n        job.shapes.push(point);\r\n    }\r\n\r\n    // Parse images\r\n    let imagesXML = xmlDoc.getElementsByTagName('picture');\r\n    for (let imageXML of Array.from(imagesXML)) {\r\n        let image = parseImage(imageXML);\r\n        job.shapes.push(image);\r\n    }\r\n\r\n    return job;\r\n}\r\n","import {Point,Box} from '@flatten-js/core';\r\n\r\nconst pgmResolution = 25.500025;\r\nconst microns2pixels = 400;\r\n// const inch2pixels = 10160;\r\n// const offsetX = 12.322830;\r\n// const offsetY = 8.326776;\r\nconst sizeX = 3.0303;\r\n\r\nfunction toPixels(str) {\r\n    let num = Number(str);\r\n    return Math.round(num*pgmResolution*microns2pixels,0);\r\n}\r\n\r\nexport function parseImage(file) {\r\n    let image = {};          // TODO: to be Flatten.Image\r\n\r\n    let terms = file.name.split('_');\r\n    let yStr = terms[0].substr(1);\r\n    let xStr = terms[1] ? terms[1].substr(1) : undefined;\r\n\r\n    let x = isNaN(xStr) ? 0 : toPixels(xStr) + 90000;\r\n    let y = isNaN(yStr) ? 0 : toPixels(yStr) - 40000;\r\n\r\n    image.center = new Point(x,y);\r\n    image.width = sizeX*microns2pixels*1000;    // 2 mm\r\n    image.box = new Box(\r\n        image.center.x - image.width/2,\r\n        image.center.y - image.width/2,\r\n        image.center.x + image.width/2,\r\n        image.center.y + image.width/2,\r\n    );\r\n\r\n    return image;\r\n}","import { Job } from '../models/job';\r\nimport {point} from '@flatten-js/core';\r\n\r\nconst micron2pixels = 400;\r\nfunction micronToPixels(str) {\r\n    return Math.round(Number(str)*micron2pixels,0);\r\n}\r\n\r\nexport function parseCSV(filename, str) {\r\n    let job = new Job();\r\n    job.filename = filename;\r\n\r\n    let arrayOfLines = str.match(/[^\\r\\n]+/g);\r\n\r\n    for (let i = 0; i < arrayOfLines.length; i++) {\r\n        let line = arrayOfLines[i];\r\n        let terms = line.split(',');\r\n\r\n        let px = micronToPixels(terms[0]);\r\n        let py = micronToPixels(terms[1]);\r\n        let nx = Number(terms[2]);\r\n        let ny = Number(terms[3]);\r\n        let shape = point(px,py);\r\n        shape.nx = nx;\r\n        shape.ny = ny;\r\n        job.shapes.push(shape)\r\n    }\r\n\r\n    return job\r\n}","import * as ActionTypes from '../store/actionTypes';\r\nimport Layers from '../models/layers';\r\n// import { Shape } from '../models/shape';\r\nimport Model from \"../models/model\";\r\nimport { parseXML } from '../dataParsers/parserXML';\r\nimport { parseODB } from \"../dataParsers/parserODB\";\r\nimport { parseImage } from \"../dataParsers/parsePGM\";\r\nimport { parseCSV } from \"../dataParsers/parseCSV\";\r\nimport { parseTXT } from \"../dataParsers/parseTXT\";\r\n\r\nconst readAsText = (reader, file, stage, layers, dispatch, files) => {\r\n\r\n    // Closure to capture file information and parameters\r\n    reader.onload = (function(theFile, stage, layers, dispatch, files) {\r\n        return (event) => {\r\n            let string = event.target.result;\r\n\r\n            let namesplitted = theFile.name.split('.');\r\n            let extension = namesplitted[namesplitted.length-1];\r\n            let job;\r\n            if (extension === 'xml') {\r\n                job = parseXML(theFile.name, string);\r\n            }\r\n            else if (extension === 'csv') {\r\n                job = parseCSV(theFile.name, string);\r\n            }\r\n            else if (extension === 'txt') {\r\n                job = parseTXT(theFile.name, string);\r\n            }\r\n            else {\r\n                job = parseODB(theFile.name, string);\r\n            }\r\n            let layer = Layers.newLayer(stage, layers);\r\n            if (theFile.name !== \"\") {\r\n                layer.name = theFile.name;\r\n            }\r\n            layer.title = job.title;\r\n\r\n            for (let polygon of job.profiles) {\r\n                if (polygon.edges.size > 0 && polygon.faces.size > 0) {\r\n                    // let watch = undefined; //  parser.parseToWatchArray(string);\r\n                    // let shape = new Shape(polygon, stage, polygon.style, watch);\r\n                    let shape = new Model(polygon, undefined, polygon.label);\r\n\r\n                    layer.add(shape);\r\n                }\r\n            }\r\n\r\n            for (let polygon of job.materials) {\r\n                if (polygon.edges.size > 0 && polygon.faces.size > 0) {\r\n                    // let watch = undefined; //  parser.parseToWatchArray(string);\r\n                    // let shape = new Shape(polygon, stage, polygon.style, watch);\r\n                    let shape = new Model(polygon, undefined, polygon.label);\r\n\r\n                    layer.add(shape);\r\n                }\r\n            }\r\n\r\n            for (let shape of job.shapes) {\r\n                let model = new Model(shape, undefined, shape.label);\r\n                layer.add(model);\r\n            }\r\n\r\n            // layers.push(layer);\r\n\r\n            if (theFile === files[0]) {\r\n                Layers.setAffected(layers, layer);\r\n                layer.color = Layers.getNextColor(layers);\r\n                layer.displayed = true;\r\n                dispatch({\r\n                    type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n                    stage: stage,\r\n                    shape: layer\r\n                });\r\n            }\r\n            dispatch({\r\n                type: ActionTypes.ADD_NEW_LAYER,\r\n                layer: layer\r\n            });\r\n\r\n            dispatch({\r\n                type: ActionTypes.ASYNC_OPERATION_ENDED\r\n            });\r\n        }\r\n    })(file, stage, layers, dispatch, files);\r\n\r\n    reader.readAsText(file);\r\n\r\n    dispatch({\r\n        type: ActionTypes.ASYNC_OPERATION_STARTED\r\n    })\r\n\r\n};\r\n\r\nconst readAsImage = (reader, file, stage, layers, dispatch, files) => {\r\n    reader.addEventListener(\"load\", function () {\r\n        // let image = {};          // TODO: to be Flatten.Image\r\n        // image.uri = this.result;\r\n        // image.center = new Flatten.Point(0,0);\r\n        // image.width = 2*400000;    // 2 micron\r\n        // image.box = new Flatten.Box(\r\n        //     image.center.x - image.width/2,\r\n        //     image.center.y - image.width/2,\r\n        //     image.center.x + image.width/2,\r\n        //     image.center.y + image.width/2,\r\n        // );\r\n\r\n        let image = parseImage(file);\r\n        image.uri = this.result;\r\n\r\n        let model = new Model(image);\r\n\r\n        let layer = Layers.newLayer(stage, layers);\r\n        if (file.name !== \"\") {\r\n            layer.name = file.name;\r\n        }\r\n\r\n        layer.add(model);\r\n\r\n        // layers.push(layer);\r\n\r\n        if (file === files[0]) {\r\n            Layers.setAffected(layers, layer);\r\n            layer.color = Layers.getNextColor(layers);\r\n            layer.displayed = true;\r\n            dispatch({\r\n                type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n                stage: stage,\r\n                shape: layer\r\n            });\r\n        }\r\n\r\n        dispatch({\r\n            type: ActionTypes.ADD_NEW_LAYER,\r\n            layer: layer\r\n        });\r\n\r\n        dispatch({\r\n            type: ActionTypes.ASYNC_OPERATION_ENDED\r\n        });\r\n\r\n    }, false);\r\n\r\n    reader.readAsDataURL(file);\r\n};\r\n\r\nconst readFile = (file, stage, layers, dispatch, files) => {\r\n    if (file.type !== \"\" &&\r\n        !(file.type.match('text.*') || file.type.match('application.*') ||\r\n        file.type.match('image.*')) ) return;   // validate type is text\r\n\r\n    let reader = new FileReader();\r\n\r\n    if (file.type.match('text.*') || file.type.match('application.*') || file.name.match('features*')) {\r\n        readAsText(reader, file, stage, layers, dispatch, files);\r\n    }\r\n\r\n    else if (file.type.match('image.*')) {\r\n        readAsImage(reader, file, stage, layers, dispatch, files);\r\n    }\r\n\r\n};\r\n\r\nconst readFiles = ({ dispatch, getState }) => next => action => {\r\n\r\n    if (action.type !== ActionTypes.FILENAME_LIST_SELECTED) {\r\n        return next(action);\r\n    }\r\n\r\n    let stage = action.stage;\r\n    let layers = action.layers;\r\n\r\n    // Load and parse files\r\n    // in MS Edge FilesList is not array. It is indexable but not iterable\r\n    // for (let i=0; i < action.files.length; i++) {\r\n    //     readFile(action.files[i], stage, layers, dispatch, action.files);\r\n    // }\r\n    for (let file of Array.from(action.files)) {\r\n        readFile(file, stage, layers, dispatch, action.files);\r\n    }\r\n};\r\n\r\nexport default readFiles;\r\n\r\n","import { Job } from '../models/job';\r\nimport {Parser} from './parser';\r\n\r\nexport function parseTXT(filename, str) {\r\n    let job = new Job();\r\n    job.filename = filename;\r\n\r\n    let parser = new Parser();\r\n\r\n    let shapesArray = parser.parse(str);\r\n\r\n    if (shapesArray.length > 0) {\r\n        for (let shape of shapesArray) {\r\n            job.shapes.push(shape)\r\n        }\r\n    }\r\n\r\n    return job\r\n}","import * as ActionTypes from \"../store/actionTypes\";\r\nimport Layers from \"../models/layers\";\r\n\r\nconst pasteData = ({ dispatch, getState }) => next => action => {\r\n\r\n    if (action.type !== ActionTypes.DATA_FROM_BUFFER_PASTED) {\r\n        return next(action);\r\n    }\r\n\r\n    let state = getState();\r\n    let stage = state.app.stage;\r\n    let layers = state.layers;\r\n    let parser = state.app.parser;\r\n\r\n    let layer = undefined;\r\n    if (state.app.importDataToNewLayer) {   // import data to new layer\r\n        layer = Layers.newLayer(stage, layers);\r\n        layers.push(layer);\r\n    }\r\n    else {                                  // import data to affected layer\r\n        layer = layers.find((lay) => lay.affected);\r\n        if (!layer) {                       // if no layer affected, add new\r\n            layer = Layers.newLayer(stage, layers);\r\n            layers.push(layer);\r\n        }\r\n    }\r\n\r\n    // Paste data from ClipBoard\r\n    for (let item of action.data.items) {\r\n        item.getAsString((string) => {\r\n            let shapesArray = parser.parse(string);\r\n\r\n            // TODO: add something like poly.valid()\r\n\r\n            if (shapesArray.length > 0) {\r\n                for (let shape of shapesArray) {\r\n                    layer.add(shape);\r\n                }\r\n            }\r\n\r\n            if (layer.shapes.length > 0) {\r\n                dispatch({\r\n                    type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n                    shape: layer,\r\n                    stage: stage\r\n                });\r\n                dispatch({\r\n                    type: ActionTypes.TOGGLE_DISPLAY_LAYER_PRESSED,\r\n                    layer: layer\r\n                })\r\n            }\r\n\r\n        });\r\n\r\n        break;\r\n    }\r\n\r\n};\r\n\r\nexport default pasteData;\r\n","import * as ActionTypes from '../store/actionTypes';\r\n\r\nconst stageController = ({getState, dispatch}) => next => action => {\r\n\r\n    const mouse = getState().mouse;\r\n    let stage = action.stage;\r\n\r\n\r\n    if (stage) {\r\n        switch (action.type) {\r\n            case ActionTypes.STAGE_RESIZED:\r\n                stage.resize();\r\n                break;\r\n\r\n            case ActionTypes.MOUSE_DOWN_ON_STAGE:\r\n                stage.panByMouseStart();\r\n                break;\r\n\r\n            case ActionTypes.MOUSE_MOVED_ON_STAGE:\r\n                if (action.dx !== undefined && action.dy !== undefined) {\r\n                    stage.panByMouseMove(action.dx, action.dy);\r\n                }\r\n                break;\r\n\r\n            case ActionTypes.MOUSE_UP_ON_STAGE:\r\n                stage.panByMouseStop();\r\n                break;\r\n\r\n            case ActionTypes.PAN_AND_ZOOM_TO_SHAPE:\r\n                let center = action.shape.center;\r\n                let box = action.shape.box;\r\n                if (isNaN(center.x) || isNaN(center.y)) return;\r\n                stage.panToCoordinate(center.x, center.y);\r\n                stage.zoomToLimits(box.xmax - box.xmin, box.ymax - box.ymin);\r\n                break;\r\n\r\n            case ActionTypes.MOUSE_WHEEL_MOVE_ON_STAGE:\r\n                let bIn = action.delta > 0;\r\n                // stage.zoomByMouse(action.x, action.y, bIn, 1 + Math.abs(action.delta)/100.);\r\n                stage.zoomByMouse(action.x, action.y, bIn, 1.2);\r\n                break;\r\n\r\n            case ActionTypes.CLEAR_ALL:\r\n                stage.removeAllChildren();\r\n                stage.removeAllListeners();\r\n                break;\r\n\r\n            case ActionTypes.PINCH_DOWN_ON_STAGE:\r\n                stage.zoomByPinchStart(action.x1, action.y1);\r\n                break;\r\n\r\n            case ActionTypes.PINCH_MOVED_ON_STAGE:\r\n                if (mouse.touchPoints) {\r\n                    let dx = mouse.touchPoints[0].x - mouse.touchPoints[1].x;\r\n                    let dy = mouse.touchPoints[0].y - mouse.touchPoints[1].y;\r\n                    let distStart = Math.sqrt(dx*dx + dy*dy);\r\n\r\n                    dx = action.x2 - action.x1;\r\n                    dy = action.y2 - action.y1;\r\n                    let distCurrent = Math.sqrt(dx*dx + dy*dy);\r\n                    let ratio = distCurrent / distStart;\r\n                    stage.zoomByPinchMove(action.x1, action.y1, ratio);\r\n                }\r\n                break;\r\n\r\n            case ActionTypes.PINCH_UP_ON_STAGE:\r\n                stage.zoomByPinchStop();\r\n                break;\r\n\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    next(action);\r\n};\r\n\r\nexport default stageController;","import * as ActionTypes from '../store/actionTypes';\r\nimport Layers from \"../models/layers\";\r\nimport {point, arc, segment} from '@flatten-js/core';\r\nimport Flatten from '@flatten-js/core';\r\nlet Algorithmia = window.Algorithmia;\r\n\r\n// function zoomHome(shape, stage) {\r\n//     let box = shape.box;\r\n//     let x = (box.xmin + box.xmax)/2;\r\n//     let y = (box.ymin + box.ymax)/2;\r\n//     stage.panToCoordinate(x, y);\r\n//     stage.zoomToLimits(box.xmax - box.xmin, box.ymax - box.ymin);\r\n// }\r\n\r\nconst skeleton_recognition = ({dispatch, getState}) => next => action => {\r\n\r\n    if (action.type === ActionTypes.SKELETON_RECOGNITION_BUTTON_PRESSED) {\r\n\r\n        let state = getState();\r\n        let stage = state.app.stage;\r\n\r\n        let layers = state.layers;\r\n        let currentLayer = Layers.getAffected(layers);\r\n        let shapes = currentLayer.shapes;\r\n        let input = shapes.map(shape =>\r\n            [shape.geom.x / 400., shape.geom.y / 400., shape.geom.nx, shape.geom.ny]\r\n        );\r\n\r\n        let client = Algorithmia.client(\"simby4RUwqQmtMDaHAPj5wsQwlD1\");\r\n        let algorithm = \"alexbol99/SeketonRecognition\";\r\n\r\n        client.algo(algorithm)\r\n            .pipe(input)\r\n            .then(function (output) {\r\n                if (output.error) return console.error(\"error: \" + output.error);\r\n\r\n                let newLayer = Layers.newLayer(stage, layers);\r\n                newLayer.name = \"recognized\";\r\n                newLayer.title = \"recognized\";\r\n                // newLayer.displayed = true;\r\n\r\n                for (let row of output.result) {\r\n                    let shape;\r\n                    if (row[0] instanceof Array && row[0].length === 2) {\r\n                        let pc = point(row[0][0] * 400, row[0][1] * 400);\r\n                        let r = row[1] * 400;\r\n                        /********center radius startAng endAng **********/\r\n                        shape = arc(pc, r, row[2], row[3], Flatten.CCW)\r\n                    }\r\n                    else {\r\n                        shape = segment(\r\n                            point(row[0] * 400, row[1] * 400),\r\n                            point(row[2] * 400, row[3] * 400))\r\n                    }\r\n                    if (row[4]) {\r\n                        shape.label = row[4]\r\n                    }\r\n                    newLayer.add(shape)\r\n                }\r\n                layers.push(newLayer);\r\n\r\n                dispatch({\r\n                    type: ActionTypes.PAN_AND_ZOOM_TO_SHAPE,\r\n                    stage: stage,\r\n                    shape: currentLayer\r\n                })\r\n            });\r\n    }\r\n\r\n    return next(action);\r\n};\r\n\r\n\r\nexport default skeleton_recognition;\r\n","import React from 'react';\r\nimport './index.css';\r\nimport {createStore, applyMiddleware, compose} from 'redux';\r\nimport {Provider} from 'react-redux';\r\nimport thunk from 'redux-thunk';\r\nimport {BrowserRouter} from 'react-router-dom';\r\nimport reducer from './store/reducer';\r\n\r\nimport App from './App';\r\nimport log from './middleware/log';\r\nimport readFiles from './middleware/readFiles';\r\nimport pasteData from './middleware/pasteData';\r\nimport stageController from './middleware/stageController';\r\nimport skeleton_recognition from './middleware/skeleton_recognition';\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(reducer,\r\n    composeEnhancers(\r\n        applyMiddleware(log, readFiles, pasteData, skeleton_recognition, stageController, thunk)\r\n    )\r\n);\r\n\r\nconst Preloader = () => {\r\n    return (\r\n        <Provider store={store}>\r\n            <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n                <App/>\r\n            </BrowserRouter>\r\n        </Provider>\r\n    );\r\n};\r\n\r\nexport default Preloader;\r\n\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"Button_Button__2WHfP\",\"IconTrigger\":\"Button_IconTrigger__eZ4eE\",\"IconModeActive\":\"Button_IconModeActive__3w7Aa\",\"IconModeNotActive\":\"Button_IconModeNotActive__2drRN\",\"DrawerButton\":\"Button_DrawerButton__3K7o5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ButtonSeparator\":\"ButtonSeparator_ButtonSeparator__126Ou\",\"IconSeparator\":\"ButtonSeparator_IconSeparator__1IRG-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App-toolbar\":\"ToolbarComponent_App-toolbar__3_aag\",\"App-toolbar-units\":\"ToolbarComponent_App-toolbar-units__18kdG\",\"DrawerButton\":\"ToolbarComponent_DrawerButton__c8kOj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App-canvas\":\"CanvasComponent_App-canvas__3DP2s\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App-status-bar\":\"StatusComponent_App-status-bar__1PC6i\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"LabelsLayer\":\"labelsLayer_LabelsLayer__3z1ll\",\"LabelComponent\":\"labelsLayer_LabelComponent__p3Nap\"};"],"sourceRoot":""}