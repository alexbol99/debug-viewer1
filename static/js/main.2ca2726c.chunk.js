(this["webpackJsonpdebug-viewer1"]=this["webpackJsonpdebug-viewer1"]||[]).push([[0],{22:function(e,t,n){e.exports={Button:"Button_Button__2f7hp",IconTrigger:"Button_IconTrigger__1Epo2",IconModeActive:"Button_IconModeActive__1D5wv",IconModeNotActive:"Button_IconModeNotActive__1HT4h",DrawerButton:"Button_DrawerButton__1FZqc"}},28:function(e,t,n){e.exports={UploadPopup:"UploadPopup_UploadPopup__Ahi3U",fadeIn:"UploadPopup_fadeIn__3EQ7m",UploadTarget:"UploadPopup_UploadTarget__1Z4jp",UploadTargetDragLeave:"UploadPopup_UploadTargetDragLeave__fmHKo",UploadTargetDragOver:"UploadPopup_UploadTargetDragOver__1RGOi"}},30:function(e,t,n){e.exports={Layer:"LayerListElement_Layer__2faNs",LayerSelectionBox:"LayerListElement_LayerSelectionBox__2quJM",LayerSelectionMark:"LayerListElement_LayerSelectionMark__36ikh",LayerNameBox:"LayerListElement_LayerNameBox__WKaNU","Layer-displayed":"LayerListElement_Layer-displayed__2OF6t","Layer-undisplayed":"LayerListElement_Layer-undisplayed__2LFfj"}},40:function(e,t,n){e.exports={BackDrop:"Spinner_BackDrop__2JQB7",Loader:"Spinner_Loader__2CR35",load2:"Spinner_load2__1_J4g"}},41:function(e,t,n){e.exports={BackDrop:"ModalPopup_BackDrop__2YR2Q",ModalPopup:"ModalPopup_ModalPopup__1agxT",fadeIn:"ModalPopup_fadeIn__7Wo-s"}},42:function(e,t,n){e.exports={ButtonSeparator:"ButtonSeparator_ButtonSeparator__2OrIo",IconSeparator:"ButtonSeparator_IconSeparator__2_jWh"}},43:function(e,t,n){e.exports={"App-toolbar":"ToolbarComponent_App-toolbar__3XIoN","App-toolbar-units":"ToolbarComponent_App-toolbar-units__1KsD9",DrawerButton:"ToolbarComponent_DrawerButton__3Ah48"}},48:function(e,t,n){e.exports={"App-header":"HeaderComponent_App-header__2ahiT","App-header-documents-page":"HeaderComponent_App-header-documents-page__3qQEw"}},49:function(e,t,n){e.exports={EditorComponent:"EditorComponent_EditorComponent__lnBl3"}},50:function(e,t,n){e.exports={DisplayCoordinatesTool:"DisplayCoordinatesTool_DisplayCoordinatesTool__Iv7DM"}},51:function(e,t,n){e.exports={LabelsLayer:"labelsLayer_LabelsLayer__15IU0",LabelComponent:"labelsLayer_LabelComponent__2hx0J"}},52:function(e,t,n){e.exports={VertexLabel:"VertexLabel_VertexLabel__1E4O3",fadeIn:"VertexLabel_fadeIn__3VBpZ"}},53:function(e,t,n){e.exports={"Layer-list-toolbar":"LayerListToolbar_Layer-list-toolbar__dkMLf"}},54:function(e,t,n){e.exports={"Layer-edit-form":"LayerEditForm_Layer-edit-form__1jukg"}},55:function(e,t,n){e.exports={"App-layers":"LayersWidget_App-layers__1mgA5","App-layers-displayed":"LayersWidget_App-layers-displayed__3nc8w",fadeIn:"LayersWidget_fadeIn__TZnM9"}},56:function(e,t,n){e.exports={MeasureBetweenPoints:"MeasureBetweenPoints_MeasureBetweenPoints__LIJcL"}},57:function(e,t,n){e.exports={HomeComponent:"HomeComponent_HomeComponent__3mOy5"}},58:function(e,t,n){e.exports={AboutPopup:"AboutPopup_AboutPopup__194nD"}},60:function(e,t,n){e.exports={DownloadPopup:"DownloadPopup_DownloadPopup__14yy5",fadeIn:"DownloadPopup_fadeIn__EVW3r",Open:"DownloadPopup_Open__2KTju",Close:"DownloadPopup_Close___5jcj"}},61:function(e,t,n){e.exports={Snackbar:"Snackbar_Snackbar__vz5yL",fadeInOut:"Snackbar_fadeInOut__2TuNS"}},68:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(24),r=n.n(a),o=n(39);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(5),s=n(14),c=n(48),l=n.n(c),u=n(1),p=function(e){return Object(u.jsx)("header",{className:l.a["App-header"],children:Object(u.jsx)("h2",{children:e.title})})},d=n(2),h=n(4),f=n(7),m=n(8),v=document.getElementById("modal-root"),y=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).el=document.createElement("div"),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){v.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){v.removeChild(this.el)}},{key:"render",value:function(){return r.a.createPortal(this.props.children,this.el)}}]),n}(i.Component),b=n(40),g=n.n(b),j=function(){return Object(u.jsx)(y,{children:Object(u.jsx)("div",{className:g.a.BackDrop,children:Object(u.jsx)("div",{className:g.a.Loader,children:"Loading ..."})})})},O=(n(68),n(27)),x=n.n(O),w=n(11),_=n(3),S=n(33),E=n(6),k=n(49),A=n.n(k),L="STAGE_UNMOUNTED",C="PAN_BY_DRAG_BUTTON_CLICKED",M="MEASURE_POINTS_BUTTON_PRESSED",P="MEASURE_SHAPES_BUTTON_PRESSED",I="TOGGLE_ABOUT_POPUP_CLICKED",F="TOGGLE_UNITS_CLICKED",D="TOGGLE_WIDTH_MODE_CLICKED",N="TOGGLE_DISPLAY_VERTICES_CLICKED",T="TOGGLE_DISPLAY_LABELS_CLICKED",B="TOGGLE_SHOW_LAYER_LIST_CLICKED",U="TOGGLE_DOWNLOAD_POPUP_CLICKED",W="TOGGLE_UPLOAD_POPUP_CLICKED",Y="MOUSE_MOVED_ON_STAGE",R="MOUSE_DOWN_ON_STAGE",z="MOUSE_UP_ON_STAGE",X="MOUSE_WHEEL_MOVE_ON_STAGE",H="MOUSE_ROLL_OVER_SHAPE",V="MOUSE_ROLL_OUT_SHAPE",G="MOUSE_CLICKED_ON_SHAPE",J="PINCH_DOWN_ON_STAGE",K="PINCH_MOVED_ON_STAGE",Q="PINCH_UP_ON_STAGE",Z="ADD_LAYER_BUTTON_PRESSED",q="ADD_NEW_LAYER",$="DELETE_LAYER_BUTTON_PRESSED",ee="SORT_LAYERS_BUTTON_PRESSED",te="TOGGLE_DISPLAY_LAYER_PRESSED",ne="TOGGLE_AFFECTED_LAYER_PRESSED",ae="OPEN_LAYER_EDIT_FORM_PRESSED",re="SUBMIT_LAYER_EDIT_FORM_PRESSED",oe="ESCAPE_LAYER_EDIT_FORM_PRESSED",ie="LAYERS_LIST_ARROW_DOWN_PRESSED",se="LAYERS_LIST_ARROW_UP_PRESSED",ce="FILES_UPLOAD_COMPLETED",le="INITIALIZE_UPLOAD_STATE",ue="CLEAR_ALL_BUTTON_CLICKED",pe=n(0),de={strokeStyle:1,stroke:"#FF0303",fill:"#FF0303",alpha:1},he=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(d.a)(this,e),this.geom=t,this.style=n||de,this.label=a}return Object(h.a)(e,[{key:"clone",value:function(){var t=new e(this.geom,this.style,this.label);return Object.assign(t,this)}},{key:"box",get:function(){return this.geom.box}}]),e}(),fe=function(){function e(t){Object(d.a)(this,e),this.stage=t,this.shapes=[],this.name="",this.color="",this.title="",this.displayed=!1,this.edited=!1,this.affected=!1}return Object(h.a)(e,[{key:"clone",value:function(){var t=new e(this.stage);return Object.assign(t,this)}},{key:"add",value:function(e){if(e instanceof he)this.shapes.push(e);else{var t=new he(e,{},e.label);this.shapes.push(t)}return this}},{key:"addShapesArray",value:function(e){var t,n=Object(_.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.add(a)}}catch(r){n.e(r)}finally{n.f()}return this}},{key:"box",get:function(){var e,t=new pe.b,n=Object(_.a)(this.shapes);try{for(n.s();!(e=n.n()).done;){var a=e.value;t=t.merge(a.geom instanceof pe.b?a.clone():a.box)}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"center",get:function(){var e=this.box;return new pe.j((e.xmin+e.xmax)/2,(e.ymin+e.ymax)/2)}},{key:"toggleDisplayed",value:function(e){var t=!this.displayed;return Object.assign(this.clone(),{displayed:t,color:e})}},{key:"setAffected",value:function(e){return this.affected=e,this}},{key:"setEdited",value:function(e){return Object.assign(this.clone(),{edited:e})}},{key:"setNameAndTitle",value:function(e,t){return Object.assign(this.clone(),{name:e,title:t,edited:!1})}},{key:"setAlpha",value:function(){var e,t=Object(_.a)(this.shapes);try{for(t.s();!(e=t.n()).done;){e.value.alpha=this.displayed?1:0}}catch(n){t.e(n)}finally{t.f()}return this.shapes}},{key:"toJSON",value:function(){return{name:this.name,title:this.title,shapes:JSON.stringify(this.shapes,null," ")}}}]),e}(),me=["#FF0303","#4AA403","#540080","#FFFF40","#FF0080","#AED424","#545400","#FFA980","#A95480","#A9A9FF","#00FF00","#FFEE76","#A40576","#4385C8","#1CC826","#BDBD00","#48316E","#14616E","#8040BD","#DC7676","#924845","#A90000","#FFA900"],ve=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"newLayer",value:function(t,n){var a=new fe(t);return a.name=e.getNewName(n),0===n.length&&(a.displayed=!1,a.affected=!1),a}},{key:"defaultName",get:function(){return"layer"}},{key:"getNewName",value:function(t){for(var n=e.defaultName,a=1,r=function(e){return e.name===n};t.find(r);)n=e.defaultName+a,a++;return n}},{key:"getAffected",value:function(e){return e.find((function(e){return e.affected}))}},{key:"setAffected",value:function(t,n){var a=e.getAffected(t);a&&(a.affected=!1),n.affected=!0}},{key:"getNextColor",value:function(e){var t,n="",a=Object(_.a)(me);try{var r=function(){var a=t.value;if(!e.find((function(e){return e.displayed&&e.color===a})))return n=a,"break"};for(a.s();!(t=a.n()).done;){if("break"===r())break}}catch(o){a.e(o)}finally{a.f()}return n}},{key:"delete",value:function(t,n){var a=t.findIndex((function(e){return e===n})),r=t.filter((function(e){return e!==n}));return a>0&&(r[a-1].affected=!0,""===r[a-1].color&&(r[a-1].color=e.getNextColor(r)),r[a-1].displayed=!0),r}},{key:"sort",value:function(e){var t=e.slice();return t.sort((function(e,t){var n=e.name.toUpperCase(),a=t.name.toUpperCase();return n<a?-1:n>a?1:0})),t}},{key:"toJSON",value:function(e){return e.map((function(e){return e.toJSON()}))}}]),e}(),ye=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,a=t.find((function(e){return e.affected})),r=t.findIndex((function(e){return e.affected}));switch(n.type){case Z:return e=ve.newLayer(n.stage,t),[].concat(Object(w.a)(t),[e]);case q:return[].concat(Object(w.a)(t),[n.layer]);case $:return a?ve.delete(t,a):t;case ue:return[];case ee:return ve.sort(t);case te:var o="";if(!n.layer.displayed&&""===(o=ve.getNextColor(t)))return;return t.map((function(e){if(e!==n.layer)return n.layer.displayed?e:e.setAffected(!1);var t=e.toggleDisplayed(o);return t.affected=t.displayed,t}));case ne:return t.map((function(e){return e!==n.layer?e.setAffected(!1):e.setAffected(!e.affected)}));case ae:return t.map((function(e){return e!==a?e:e.setEdited(!0)}));case re:return t.map((function(e){return e.edited?e.setNameAndTitle(n.newLayer.name,n.newLayer.title):e}));case oe:return t.map((function(e){return e.edited?e.setEdited(!1):e}));case ie:if(r===t.length-1)return t;var i=t[r+1];return t.map((function(e){if(e===a){var t=e.toggleDisplayed("");return t.affected=!1,t}if(e===i){var n=a.color,r=e.toggleDisplayed(n);return r.affected=!0,r}return e}));case se:if(0===r)return t;var s=t[r-1];return t.map((function(e){if(e===a){var t=e.toggleDisplayed("");return t.affected=!1,t}if(e===s){var n=e.toggleDisplayed(a.color);return n.displayed=!0,n.affected=!0,n}return e}));default:return t}},be=n(9),ge={measureShapesActive:!1,measureShapesFirstClick:!0,hoveredShape:null,firstMeasuredShape:null,secondMeasuredShape:null,firstMeasuredLayer:null,secondMeasuredLayer:null,distance:void 0,shortestSegment:null},je=window.mobilecheck(),Oe=function(e,t){switch(t.type){case P:return Object(be.a)(Object(be.a)({},e),{},{measureShapesActive:!0});case C:case M:return ge;case H:return Object(be.a)(Object(be.a)({},e),{},{hoveredShape:e.measureShapesActive?t.shape:null});case V:return Object(be.a)(Object(be.a)({},e),{},{hoveredShape:null});case G:if(!e.measureShapesActive)return e;if(e.measureShapesFirstClick)return Object(be.a)(Object(be.a)({},e),{},{firstMeasuredShape:t.shape,firstMeasuredLayer:t.layer,secondMeasuredShape:null,secondMeasuredLayer:null,measureShapesFirstClick:!1,distance:void 0,shortestSegment:null});if(t.shape===e.firstMeasuredShape)return e;var n,a,r=e.firstMeasuredShape.geom,o=t.shape.geom,i=pe.o.Distance.distance(r,o),s=Object(E.a)(i,2);return n=s[0],a=s[1],Object(be.a)(Object(be.a)({},e),{},{secondMeasuredShape:t.shape,secondMeasuredLayer:t.layer,measureShapesFirstClick:!0,distance:n,shortestSegment:a});case R:return e.hoveredShape||je?e:Object(be.a)(Object(be.a)({},e),{},{measureShapesFirstClick:!0,firstMeasuredShape:null,firstMeasuredLayer:null,secondMeasuredShape:null,secondMeasuredLayer:null,distance:void 0,shortestSegment:null});case $:return t.layer===e.firstMeasuredLayer||t.layer===e.secondMeasuredLayer?ge:e;case te:return!t.layer.displayed||t.layer!==e.firstMeasuredLayer&&t.layer!==e.secondMeasuredLayer?e:ge;default:return e}},xe=function(e){return{type:q,layer:e}},we=function(e,t){for(var n=!0,a=0,r=Object.keys(t);a<r.length;a++){var o=r[a];if(t[o]!==e[o]){n=!1;break}}return n},_e=function(e,t,n){return(e/t).toFixed(n)},Se=n(50),Ee=n.n(Se),ke=function(e){var t=e.stage,n=e.coordX,a=e.coordY,r=e.divisor,o=e.decimals;if(!t)return null;var i=t.canvas,s=i.offsetTop+10,c=i.width-200,l=t.C2W_X(n),p=t.C2W_Y(a);return Object(u.jsx)("div",{style:{position:"absolute",top:s,left:c},className:Ee.a.DisplayCoordinatesTool,children:Object(u.jsxs)("h5",{children:["X: ",_e(l,r,o)," Y: ",_e(p,r,o)]})})},Ae=function(e){var t=e.children,n=e.stage,a=e.layers,r=e.transform,o=e.controls;return Object(i.useEffect)((function(){if(n.canvas&&n.canvas.getContext("2d")){var e=r.originX,t=r.originY,a=r.zoomFactor*r.resolution;n.setTransform(e,t,a,-a),n.update()}return function(){}}),[n,a,r]),Object(i.useEffect)((function(){n.canvas&&n.canvas.getContext("2d")&&n.update()}),[n,a,o]),Object(u.jsx)(i.Fragment,{children:t})},Le={x:0,y:0,startX:void 0,startY:void 0,touchPoints:void 0,delta:0,ratio:1},Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return Object(be.a)(Object(be.a)({},e),{},{x:t.x,y:t.y,delta:0});case R:return Object(be.a)(Object(be.a)({},e),{},{startX:t.x,startY:t.y,delta:0});case z:return Object(be.a)(Object(be.a)({},e),{},{startX:void 0,startY:void 0,delta:0});case X:return Object(be.a)(Object(be.a)({},e),{},{startX:void 0,startY:void 0,delta:t.delta});case J:return Object(be.a)(Object(be.a)({},e),{},{touchPoints:[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2}],ratio:1});case K:var n=e.touchPoints[0].x-e.touchPoints[1].x,a=e.touchPoints[0].y-e.touchPoints[1].y,r=Math.sqrt(n*n+a*a);n=t.x2-t.x1,a=t.y2-t.y1;var o=Math.sqrt(n*n+a*a),i=o/r;return Object(be.a)(Object(be.a)({},e),{},{touchPoints:[{x:t.x1,y:t.y1},{x:t.x2,y:t.y2}],ratio:i});case Q:return Object(be.a)(Object(be.a)({},e),{},{touchPoints:void 0,ratio:1});default:return e}},Me=function(e,t,n,a){return{type:X,stage:e,x:t,y:n,delta:a}},Pe=n(26),Ie=n(13),Fe=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(d.a)(this,n),a=t.call(this,e),Ie.g.enable(Object(Pe.a)(a)),a.mouseMoveOutside=!1,a.enableMouseOver(20),a.canvas.clientWidth>0&&a.canvas.clientHeight>0&&(a.canvas.width=a.canvas.clientWidth,a.canvas.height=a.canvas.clientHeight),a.origin={x:a.canvas.width/2,y:a.canvas.height/2},a.resolution=1e-5,a.zoomFactor=1,a.oldOrigin={x:void 0,y:void 0},a.oldZoomFactor=void 0,a.pinchAnchorX=void 0,a.pinchAnchorY=void 0,a.pinchStarted=!1,a}return Object(h.a)(n,[{key:"box",get:function(){var e=this.C2W_X(0),t=this.C2W_Y(this.canvas.height),n=this.C2W_X(this.canvas.width),a=this.C2W_Y(0);return new pe.b(e,t,n,a)}},{key:"clone",value:function(){var e=new n(this.canvas);return Object.assign(e,this)}},{key:"add",value:function(e){return this.addChild(e),this}},{key:"scalingFactor",value:function(){return this.resolution*this.zoomFactor}},{key:"C2W_Scalar",value:function(e){return e/this.scalingFactor()}},{key:"W2C_Scalar",value:function(e){return this.scalingFactor()*e}},{key:"C2W_X",value:function(e){return(e-this.origin.x)/this.scalingFactor()}},{key:"C2W_Y",value:function(e){return(this.origin.y-e)/this.scalingFactor()}},{key:"W2C_X",value:function(e){return this.scalingFactor()*e+this.origin.x}},{key:"W2C_Y",value:function(e){return this.origin.y-this.scalingFactor()*e}},{key:"W2C",value:function(e){return{x:this.W2C_X(e.x),y:this.W2C_Y(e.y)}}},{key:"panTo",value:function(e){this.origin={x:e.x,y:e.y}}},{key:"panBy",value:function(e,t){this.origin={x:this.origin.x+e,y:this.origin.y+t}}},{key:"zoomIn",value:function(e){var t=e||1.1;this.zoomFactor=Math.min(1e7,t*this.zoomFactor)}},{key:"zoomOut",value:function(e){var t=e||1.1;this.zoomFactor=Math.max(.001,this.zoomFactor/t)}},{key:"zoom",value:function(e,t,n,a){var r=this.C2W_X(e),o=this.C2W_Y(t);n?this.zoomIn(a):this.zoomOut(a);var i=this.W2C_X(r),s=this.W2C_Y(o);return this.panBy(e-i,t-s),[i,s]}},{key:"zoomByMouse",value:function(e,t,n,a){return this.zoom(e,t,n,a),{originX:this.origin.x,originY:this.origin.y,resolution:this.resolution,zoomFactor:this.zoomFactor}}},{key:"zoomToLimits",value:function(e,t){0===e&&(e=4e5),0===t&&(t=4e5);var n=Math.min(this.canvas.width/(1.1*e),this.canvas.height/(1.1*t))/this.resolution/this.zoomFactor,a=this.canvas.width/2,r=this.canvas.height/2;return this.zoom(a,r,!0,n),{originX:this.origin.x,originY:this.origin.y,resolution:this.resolution,zoomFactor:this.zoomFactor}}},{key:"resize",value:function(){this.canvas.clientWidth>0&&this.canvas.clientHeight>0&&(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight)}},{key:"panByMouseStart",value:function(){this.oldOrigin.x=this.origin.x,this.oldOrigin.y=this.origin.y,this.zoomByPinchStop()}},{key:"panByMouseMove",value:function(e,t){if(!this.pinchStarted)return void 0!==e&&void 0!==t&&void 0!==this.oldOrigin.x&&void 0!==this.oldOrigin.y&&(this.origin={x:this.oldOrigin.x+e,y:this.oldOrigin.y+t}),{originX:this.origin.x,originY:this.origin.y,resolution:this.resolution,zoomFactor:this.zoomFactor}}},{key:"panByMouseStop",value:function(){this.oldOrigin.x=void 0,this.oldOrigin.y=void 0}},{key:"panToCoordinate",value:function(e,t){var n=this.W2C_X(e),a=this.W2C_Y(t),r=this.canvas.width/2-n,o=this.canvas.height/2-a;this.panBy(r,o)}},{key:"zoomByPinchStart",value:function(e,t){this.oldZoomFactor=this.zoomFactor,this.pinchAnchorX=this.C2W_X(e),this.pinchAnchorY=this.C2W_Y(t),this.pinchStarted=!0,this.panByMouseStop()}},{key:"zoomByPinchMove",value:function(e,t,n){return this.zoomFactor=n*this.oldZoomFactor,this.origin={x:e-this.scalingFactor()*this.pinchAnchorX,y:t+this.scalingFactor()*this.pinchAnchorY},{originX:this.origin.x,originY:this.origin.y,resolution:this.resolution,zoomFactor:this.zoomFactor}}},{key:"zoomByPinchStop",value:function(){this.oldZoomFactor=void 0,this.pinchAnchorX=void 0,this.pinchAnchorY=void 0,this.pinchStarted=!1}},{key:"setHome",value:function(e){var t=e.center,n=e.box;isNaN(t.x)||isNaN(t.y)||(this.panToCoordinate(t.x,t.y),this.zoomToLimits(n.xmax-n.xmin,n.ymax-n.ymin))}},{key:"getInitialTransform",value:function(e){return this.setHome(e),{originX:this.origin.x,originY:this.origin.y,resolution:this.resolution,zoomFactor:this.zoomFactor}}},{key:"clear",value:function(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}}]),n}(Ie.e),De=function(e){var t=Object(i.useState)(null),n=Object(E.a)(t,2),a=n[0],r=n[1],o=Object(i.useReducer)(Ce,Le),s=Object(E.a)(o,2),c=s[0],l=s[1],u=function(e){return[{x:e.nativeEvent.touches[0].clientX-e.nativeEvent.target.offsetLeft,y:e.nativeEvent.touches[0].clientY-e.nativeEvent.target.offsetTop},{x:e.nativeEvent.touches[1].clientX-e.nativeEvent.target.offsetLeft,y:e.nativeEvent.touches[1].clientY-e.nativeEvent.target.offsetTop}]},p=Object(i.useCallback)((function(e){if(a.canvas.focus(),e.nativeEvent.touches&&1!==e.nativeEvent.touches.length){if(e.nativeEvent.touches&&2===e.nativeEvent.touches.length){var t=u(e);l(function(e,t){return{type:K,stage:e,x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}(a,t))}}else l(function(e,t,n){return{type:Y,stage:e,x:t,y:n}}(a,e.stageX,e.stageY))}),[a]),d=Object(i.useCallback)((function(e){if(e.nativeEvent.touches&&1!==e.nativeEvent.touches.length){if(e.nativeEvent.touches&&2===e.nativeEvent.touches.length){var t=u(e);a.zoomByPinchStart(t[0].x,t[0].y),l(function(e,t){return{type:J,stage:e,x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}(a,t))}}else a.panByMouseStart(),l(function(e,t,n){return{type:R,stage:e,x:t,y:n}}(a,e.stageX,e.stageY))}),[a]),h=Object(i.useCallback)((function(e){e.stopPropagation(),e.preventDefault(),e.nativeEvent.touches&&1!==e.nativeEvent.touches.length?e.nativeEvent.touches&&2===e.nativeEvent.touches.length&&(a.zoomByPinchStop(),l(function(e){return{type:Q,stage:e}}(a))):(a.panByMouseStop(),l(function(e,t,n){return{type:z,stage:e,x:t,y:n}}(a)))}),[a]),f=Object(i.useCallback)((function(e){a.canvas.blur(),document.body.focus()}),[a]),m=Object(i.useCallback)((function(e){var t=e.detail||e.wheelDelta;l(Me(a,e.offsetX,e.offsetY,t))}),[a]),v=Object(i.useCallback)((function(e){l(Me(a,e.layerX,e.layerY,-e.detail))}),[a]);return Object(i.useEffect)((function(){if(e){var t=new Fe(e);r(t)}}),[e]),Object(i.useEffect)((function(){if(a)return a.on("stagemousedown",d),a.on("stagemousemove",p),a.on("stagemouseup",h),a.on("mouseleave",f),a.canvas.addEventListener("mousewheel",m,{passive:!0}),a.canvas.addEventListener("DOMMouseScroll",v,{passive:!0}),function(){a.off("stagemousedown",d),a.off("stagemousemove",p),a.off("stagemouseup",h),a.off("mouseleave",f),a.canvas.removeEventListener("mousewheel",m),a.canvas.removeEventListener("DOMMouseScroll",v)}}),[a,d,p,h,f,m,v]),[a,c]};function Ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e instanceof pe.j?Te(e,t):e instanceof pe.l?Be(e,t):e instanceof pe.a?Ue(e,t):e instanceof pe.e?We(e,t):e instanceof pe.b?Ye(e,t):e instanceof pe.k?Xe(e,t):null}function Te(e,t){var n=t&&t.radius?t.radius:3,a=t&&t.fill?t.fill:"#FF0303",r=new Ie.b;return r.fill=r.beginFill(a).command,r.circle=r.drawCircle(e.x,e.y,n).command,r}function Be(e,t){var n=new Ie.b,a=t&&void 0!==t.strokeStyle?t.strokeStyle:2,r=!t||void 0===t.ignoreScale||t.ignoreScale,o=t&&t.stroke?t.stroke:"black";return n.setStrokeStyle(a,1,0,10,r).beginStroke(o).moveTo(e.ps.x,e.ps.y).lineTo(e.pe.x,e.pe.y).endStroke()}function Ue(e,t){var n=new Ie.b,a=t&&t.strokeStyle?t.strokeStyle:2,r=!t||void 0===t.ignoreScale||t.ignoreScale,o=t&&t.stroke?t.stroke:"black";return n.setStrokeStyle(a,1,0,10,r).beginStroke(o).arc(e.pc.x,e.pc.y,e.r,e.startAngle,e.endAngle,!e.counterClockwise).endStroke()}function We(e,t){var n=new Ie.b,a=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";return n.setStrokeStyle(a,0,0,10,!0),n.stroke=n.beginStroke(r).command,n.fill=n.beginFill(o).command,n.drawCircle(e.pc.x,e.pc.y,e.r),n}function Ye(e,t){var n=new Ie.b,a=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";return n.setStrokeStyle(a,0,0,10,!0),n.stroke=n.beginStroke(r).command,n.fill=n.beginFill(o).command,n.drawRect(e.xmin,e.ymin,e.xmax-e.xmin,e.ymax-e.ymin),n}function Re(e,t){t.shape instanceof pe.l?function(e,t){e.lineTo(t.pe.x,t.pe.y)}(e,t.shape):t.shape instanceof pe.a&&function(e,t){e.arc(t.pc.x,t.pc.y,t.r,t.startAngle,t.endAngle,!t.counterClockwise)}(e,t.shape)}function ze(e,t){var n=t.first.start;e.moveTo(n.x,n.y);var a,r=Object(_.a)(t);try{for(r.s();!(a=r.n()).done;){Re(e,a.value)}}catch(o){r.e(o)}finally{r.f()}}function Xe(e,t){var n=new Ie.b,a=t&&t.strokeStyle?t.strokeStyle:1,r=t&&t.stroke?t.stroke:"#FF0303",o=t&&t.fill?t.fill:"#FF0303";n.setStrokeStyle(a,0,0,10,!0),n.stroke=n.beginStroke(r).command,n.fill=n.beginFill(o).command;var i,s=Object(_.a)(e.faces);try{for(s.s();!(i=s.n()).done;){ze(n,i.value)}}catch(c){s.e(c)}finally{s.f()}return n.endStroke(),n}var He=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).handleMouseOver=function(e){a.props.onMouseOver(a.props.model)},a.handleMouseOut=function(e){a.props.onMouseOut()},a.handleClick=function(e){a.props.onClick(a.props.model,a.props.layer)},a.shape=new Ie.d,e.stage.addChild(a.shape),a}return Object(h.a)(n,[{key:"redraw",value:function(){var e=this.props.stage,t=this.props.hovered||this.props.selected?"black":this.props.color,n=this.props.hovered||this.props.selected?1:.6,a=this.props.widthOn,r=this.props.model.geom.aperture?this.props.model.geom.aperture:void 0,o=a?this.props.color:"white";this.shape.graphics.isEmpty()?this.shape.graphics=Ne(this.props.model.geom,{strokeStyle:r,ignoreScale:!0,stroke:t,fill:o,radius:3/(e.zoomFactor*e.resolution)}):(this.shape.graphics.stroke&&(this.shape.graphics.stroke.style=t),this.shape.graphics.fill&&(this.shape.graphics.fill.style=o),this.shape.graphics.circle&&(this.shape.graphics.circle.radius=3/(e.zoomFactor*e.resolution))),this.shape.alpha=this.props.displayed?n:0}},{key:"componentDidMount",value:function(){this.shape.on("mouseover",this.handleMouseOver),this.shape.on("mouseout",this.handleMouseOut),this.shape.on("click",this.handleClick),this.redraw()}},{key:"shouldComponentUpdate",value:function(e,t){return!we(this.props,e)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.shape.off("mouseover",this.handleMouseOver),this.shape.off("mouseout",this.handleMouseOut),this.shape.off("click",this.handleClick),this.props.stage.removeChild(this.shape),this.shape.graphics.clear()}},{key:"render",value:function(){return null}}]),n}(i.Component),Ve=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleMouseOver=function(t){e.props.onMouseOver(e.props.model)},e.handleMouseOut=function(t){e.props.onMouseOut()},e.handleClick=function(t){e.props.onClick(e.props.model,e.props.layer)},e}return Object(h.a)(n,[{key:"redraw",value:function(){if(this.bitmap){this.bitmap.alpha=this.props.displayed?1:0;var e=this.props.model.geom.width,t=this.bitmap.image.naturalWidth/this.bitmap.image.naturalHeight;this.props.model.geom.height=this.props.model.geom.width/t;var n=e/this.bitmap.image.naturalWidth,a=e/(this.bitmap.image.naturalHeight*t),r=this.props.model.geom.center.x,o=this.props.model.geom.center.y;this.bitmap.setTransform(r,o,n,-a),this.bitmap.regX=this.bitmap.image.naturalWidth/2,this.bitmap.regY=this.bitmap.image.naturalHeight/2}}},{key:"loadImage",value:function(){var e=this,t=new Image;t.onload=function(){e.bitmap=new Ie.a(t),e.props.stage.addChild(e.bitmap),e.redraw(),e.props.onImageLoaded(e.props.model,e.props.layer,t)},t.setAttribute("crossOrigin","anonymous"),t.src=this.props.model.geom.uri}},{key:"componentDidMount",value:function(){this.loadImage()}},{key:"shouldComponentUpdate",value:function(e,t){return!we(this.props,e)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.props.stage.removeChild(this.bitmap)}},{key:"render",value:function(){return null}}]),n}(i.Component),Ge=function(e){var t=function(e,t,n){};return e.layer.shapes.map((function(n,a){return n.geom.uri?Object(u.jsx)(Ve,{stage:e.stage,layer:e.layer,model:n,displayed:e.layer.displayed,hovered:n===e.hoveredShape,selected:n===e.firstMeasuredShape||n===e.secondMeasuredShape,color:e.layer.color,widthOn:e.widthOn,displayLabels:e.displayLabels,zoomFactor:e.zoomFactor,onImageLoaded:t},a):Object(u.jsx)(He,{stage:e.stage,layer:e.layer,model:n,displayed:e.layer.displayed,color:e.layer.color,widthOn:e.widthOn,zoomFactor:e.zoomFactor,onMouseOver:e.handleMouseRollOverShape,onMouseOut:e.handleMouseRollOutShape,onClick:e.handleClickOnShape,hovered:n===e.hoveredShape,selected:n===e.firstMeasuredShape||n===e.secondMeasuredShape},a)}))},Je=n(51),Ke=n.n(Je),Qe=function(e){var t=e.stage,n=e.shape,a=n.geom.center||n.geom,r=t.canvas.offsetLeft+t.W2C_X(a.x)+6,o=t.canvas.offsetTop+t.W2C_Y(a.y)-4;return r>t.canvas.offsetLeft&&r<t.canvas.offsetLeft+t.canvas.width&&o>t.canvas.offsetTop&&o<t.canvas.offsetTop+t.canvas.height?Object(u.jsx)("div",{style:{position:"absolute",left:r+"px",top:o+"px"},className:Ke.a.LabelComponent,children:Object(u.jsx)("h5",{children:n.label})}):null},Ze=function(e){return e.layer.displayed&&e.displayLabels?e.layer.shapes.map((function(t,n){return t.label&&""!==t.label.trim()?Object(u.jsx)(Qe,{stage:e.stage,shape:t,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY},n):null})):null},qe=n(52),$e=n.n(qe),et=function(e){var t=e.stage,n=t.canvas.offsetLeft+t.W2C_X(e.vertex.x)+6,a=t.canvas.offsetTop+t.W2C_Y(e.vertex.y)-10,r=_e(e.vertex.x,e.divisor,e.decimals),o=_e(e.vertex.y,e.divisor,e.decimals);return Object(u.jsx)("div",{className:$e.a.VertexLabel,style:{left:n,top:a},children:Object(u.jsxs)("h5",{children:["x=",r," y=",o]})})},tt=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this)).handleMouseOver=function(e){a.shape.shadow=new Ie.c(a.props.color,0,0,10),a.setState({hovered:!0})},a.handleMouseOut=function(e){a.shape.shadow=null,a.setState({hovered:!1})},a.handleClick=function(e){console.log(a.props.vertex)},a.shape=new Ie.d,e.stage.addChild(a.shape),a.state={hovered:!1},a}return Object(h.a)(n,[{key:"redraw",value:function(){var e=this.props.stage,t=this.props.color,n=this.props.color;this.shape.graphics.isEmpty()?this.shape.graphics=Ne(this.props.vertex,{stroke:t,fill:n,radius:3/(e.zoomFactor*e.resolution)}):(this.shape.graphics.circle.radius=3/(e.zoomFactor*e.resolution),this.shape.graphics.fill.style=n),this.shape.alpha=1}},{key:"componentDidMount",value:function(){this.shape.on("mouseover",this.handleMouseOver),this.shape.on("mouseout",this.handleMouseOut),this.shape.on("click",this.handleClick),this.shape.mouseEnabled=!0,this.redraw()}},{key:"shouldComponentUpdate",value:function(e,t){return!we(this.props,e)||!we(this.state,t)}},{key:"componentDidUpdate",value:function(){this.redraw()}},{key:"componentWillUnmount",value:function(){this.shape.off("mouseover",this.handleMouseOver),this.shape.off("mouseout",this.handleMouseOut),this.shape.off("click",this.handleClick),this.props.stage.removeChild(this.shape),this.shape.graphics.clear()}},{key:"render",value:function(){return this.state.hovered?Object(u.jsx)(et,{stage:this.props.stage,vertex:this.props.vertex,divisor:this.props.divisor,decimals:this.props.decimals}):null}}]),n}(i.Component),nt=function(e){return e.model.geom.vertices?e.model.geom.vertices.map((function(t,n){return Object(u.jsx)(tt,{stage:e.stage,vertex:t,color:e.color,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY},n)})):null},at=function(e){return e.layer.displayed&&e.displayVertices?e.layer.shapes.map((function(t,n){return Object(u.jsx)(nt,{stage:e.stage,model:t,color:e.layer.color,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY},n)})):null},rt=function(e){return e.layers.map((function(t,n){return Object(u.jsxs)(i.Fragment,{children:[Object(u.jsx)(Ge,{stage:e.stage,layer:t,widthOn:e.widthOn,displayVertices:e.displayVertices,zoomFactor:e.zoomFactor,handleMouseRollOverShape:e.handleMouseRollOverShape,handleMouseRollOutShape:e.handleMouseRollOutShape,handleClickOnShape:e.handleClickOnShape,hoveredShape:e.hoveredShape,firstMeasuredShape:e.firstMeasuredShape,secondMeasuredShape:e.secondMeasuredShape}),Object(u.jsx)(Ze,{stage:e.stage,layer:t,displayLabels:e.displayLabels,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY}),Object(u.jsx)(at,{stage:e.stage,layer:t,displayVertices:e.displayVertices,divisor:e.divisor,decimals:e.decimals,zoomFactor:e.zoomFactor,originX:e.originX,originY:e.originY})]},n)}))},ot=n(36),it=n.n(ot),st=n(22),ct=n.n(st),lt=function(e){var t;switch(e.type){case"trigger":t=ct.a.IconTrigger;break;case"mode":t=e.active?ct.a.IconModeActive:ct.a.IconModeNotActive;break;default:t=ct.a.IconTrigger}var n=e.mobileOnly?ct.a.DrawerButton:ct.a.Button;return Object(u.jsx)("button",{title:e.title,onClick:e.onClick,className:n,children:Object(u.jsx)(it.a,{name:e.iconName,size:"2x",className:t})})},ut=n(53),pt=n.n(ut),dt=(n(46),function(e){return Object(u.jsxs)("div",{className:pt.a["Layer-list-toolbar"],children:[Object(u.jsx)(lt,{type:"trigger",title:"Edit selected layer's name and info",iconName:"pencil-alt",onClick:e.onEditLayerButtonClicked}),Object(u.jsx)(lt,{type:"trigger",title:"Delete selected layer",iconName:"trash-alt",onClick:e.onDeleteLayerButtonClicked})]})}),ht=n(41),ft=n.n(ht),mt=function(e){var t=Object(i.useRef)();return Object(u.jsx)("div",{ref:t,className:ft.a.BackDrop,onClick:function(n){n.target===t.current&&e.closePopup()},children:e.children})},vt=function(e){var t,n,a,r,o=function(e){e=e||window.event,t=a-e.clientX,n=r-e.clientY,a=e.clientX,r=e.clientY;var o=e.target;o.style.top=o.offsetTop-n+"px",o.style.left=o.offsetLeft-t+"px"},s=function(e){e.target.onmouseup=null,e.target.onmousemove=null};return Object(i.useEffect)((function(){var t=function(t){"Escape"===t.code&&e.closePopup()};return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)}}),[e]),e.showPopup&&Object(u.jsx)(y,{children:Object(u.jsx)(mt,{closePopup:e.closePopup,children:Object(u.jsxs)("div",{className:ft.a.ModalPopup,onMouseDown:function(e){e=e||window.event,a=e.clientX,r=e.clientY,e.target.onmouseup=s,e.target.onmousemove=o},children:[Object(u.jsx)("header",{children:e.header}),e.children]})})})},yt=n(54),bt=n.n(yt),gt=function(e){var t=Object(i.useRef)(),n=Object(i.useRef)(),a=function(a){if(a){a.stopPropagation(),a.preventDefault();var r=t.current.value.trim(),o=n.current.value.trim(),i=Object(be.a)(Object(be.a)({},e.layer),{},{name:r,title:o});e.onSubmitLayerEditForm(i)}},r=function(e){e.stopPropagation(),e.target.focus()};return Object(i.useEffect)((function(){t.current.focus()}),[t]),Object(u.jsxs)("form",{className:bt.a["Layer-edit-form"],onSubmit:a,onMouseMove:function(e){e.stopPropagation()},children:[Object(u.jsxs)("article",{children:[Object(u.jsx)("label",{htmlFor:"layerName",children:"Name:"}),Object(u.jsx)("input",{type:"text",id:"layerName",ref:t,defaultValue:e.layer.name,onClick:r})]}),Object(u.jsx)("article",{children:Object(u.jsx)("textarea",{id:"layerTitle",ref:n,cols:"70",rows:"3",defaultValue:e.layer.title,onClick:r})}),Object(u.jsx)("input",{type:"submit",style:{display:"none"}}),Object(u.jsx)("button",{onClick:function(t){e.onEscapeLayerEditForm()},children:"Cancel"}),Object(u.jsx)("button",{onClick:function(e){return a(e.target.parent)},children:"OK"})]})},jt=n(30),Ot=n.n(jt),xt=function(e){var t=Object(i.useRef)(null);Object(i.useEffect)((function(){if("CANVAS"!==document.activeElement.nodeName){var n=t.current;e.layer.affected&&n.focus()}}));var n=function(e,t){var n,a,r,o;return e?(e=e.replace("#",""),n=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16),o=t):(n=147,a=128,r=108,o=0),"rgba(".concat(n,",").concat(a,",").concat(r,",").concat(o/100,")")},a=e.layer.displayed?"Layer-displayed":"Layer-undisplayed",r=a?n(e.layer.color,100):n(),o=a?n(e.layer.color,30):n(),s=e.layer.affected?1:0,c=0===e.layer.shapes.length?.6:1;return Object(u.jsxs)(i.Fragment,{children:[Object(u.jsxs)("li",{className:Ot.a.Layer,onClick:e.onLayerClicked,children:[Object(u.jsx)("div",{className:Ot.a.LayerSelectionBox,onClick:e.onAffectedBoxClicked,children:Object(u.jsx)("h4",{className:Ot.a.LayerSelectionMark,style:{opacity:s,color:r},children:"\u2713"})}),Object(u.jsx)("div",{className:Ot.a.LayerNameBox,style:{backgroundColor:o,opacity:c},children:Object(u.jsx)("h4",{ref:t,title:e.layer.title,tabIndex:"1",children:e.layer.name})})]}),Object(u.jsx)(vt,{showPopup:e.layer.edited,closePopup:e.onEscapeLayerEditForm,header:"Layer properties",children:Object(u.jsx)(gt,{layer:e.layer,onSubmitLayerEditForm:e.onSubmitLayerEditForm,onEscapeLayerEditForm:e.onEscapeLayerEditForm})})]})},wt=n(55),_t=n.n(wt),St=function(e){var t=Object(i.useRef)(null),n=Object(i.useState)(0),a=Object(E.a)(n,2),r=a[0],o=a[1],s=Object(i.useCallback)((function(t){if(t.target.parentElement.parentElement&&t.target.parentElement.parentElement.parentElement&&t.target.parentElement.parentElement.parentElement.id&&"layersList"===t.target.parentElement.parentElement.parentElement.id)switch(t.code){case"ArrowRight":case"ArrowDown":e.setAffectedNextLayer();break;case"ArrowLeft":case"ArrowUp":e.setAffectedPrevLayer()}}),[e]);return Object(i.useEffect)((function(){o(t.current.clientHeight)}),[]),Object(i.useEffect)((function(){document.addEventListener("keydown",s)})),Object(u.jsxs)("div",{className:_t.a["App-layers-displayed"],ref:t,onClick:e.onLayerListClicked,children:[Object(u.jsx)(dt,{onEditLayerButtonClicked:e.onEditLayerButtonClicked,onDeleteLayerButtonClicked:e.onDeleteLayerButtonClicked}),Object(u.jsx)("ul",{id:"layersList",style:{maxHeight:.82*(r-40)},children:e.layers.map((function(t,n){return Object(u.jsx)(xt,{layer:t,onLayerClicked:function(){return e.toggleDisplayLayer(t)},onAffectedBoxClicked:function(n){return e.toggleAffectedLayer(n,t)},onSubmitLayerEditForm:e.onSubmitLayerEditForm,onEscapeLayerEditForm:e.onEscapeLayerEditForm},n)}))})]})},Et=n(56),kt=n.n(Et),At={points:[]},Lt=function(e,t){var n=t.stage||null;switch(t.type){case"MOUSE_DOWN":return 0===e.points.length?{points:[{x:n.C2W_X(t.x),y:n.C2W_Y(t.y)}]}:{points:[]};case"MOUSE_MOVED":return e.points.length>0?{points:[{x:e.points[0].x,y:e.points[0].y},{x:n.C2W_X(t.x),y:n.C2W_Y(t.y)}]}:e;default:return e}},Ct=function(e){var t=e.stage,n=(e.transform,e.units,e.divisor),a=e.decimals,r=Object(i.useState)(null),o=Object(E.a)(r,2),s=o[0],c=o[1],l=Object(i.useState)(null),p=Object(E.a)(l,2),d=p[0],h=p[1],f=Object(i.useReducer)(Lt,At),m=Object(E.a)(f,2),v=m[0],y=m[1],b=Object(i.useCallback)((function(){var e=v.points,n={x:e[0].x,y:e[0].y},a={x:e[1].x,y:e[1].y},r=Math.min(n.x,a.x),o=Math.min(n.y,a.y),i=Math.abs(n.x-a.x),c=Math.abs(n.y-a.y),l=new Ie.b;l.setStrokeStyle(1,0,0,10,!0).beginStroke("#000000").drawRect(r,o,i,c),s.graphics=l;var u=new Ie.b;u.setStrokeStyle(1,1,0,10,!0).beginStroke("#000000").moveTo(n.x,n.y).lineTo(a.x,a.y).endStroke(),d.graphics=u,s.visible=!0,d.visible=!0,t.update()}),[t,v,s,d]),g=Object(i.useCallback)((function(){t&&s&&d&&(s.visible=!1,d.visible=!1,t.update())}),[t,s,d]);Object(i.useEffect)((function(){2===v.points.length?b():g()}),[t,v,b,g]),Object(i.useEffect)((function(){return function(){t&&(t.removeChild(s),t.removeChild(d))}}),[t,s,d]),Object(i.useEffect)((function(){var e=function(e){return y({type:"MOUSE_DOWN",stage:t,x:e.stageX,y:e.stageY})},n=function(e){return y({type:"MOUSE_MOVED",stage:t,x:e.stageX,y:e.stageY})};if(t){t.addEventListener("stagemousedown",e),t.addEventListener("stagemousemove",n);var a=new Ie.d;t.addChild(a),c(a);var r=new Ie.d;t.addChild(r),h(r)}return function(){t&&(t.removeEventListener("stagemousedown",e),t.removeEventListener("stagemousemove",n))}}),[t]);if(2===v.points.length){var j=v.points,O={x:j[0].x,y:j[0].y},x={x:j[1].x,y:j[1].y},w=t.W2C_X(Math.min(O.x,x.x)),_=t.W2C_Y(Math.min(O.y,x.y))+t.canvas.offsetTop,S=function(e,t,n,a){var r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y),i=Math.sqrt(r*r+o*o);return"DX="+_e(r,n,a)+",DY="+_e(o,n,a)+",D="+_e(i,n,a)}(O,x,n,a);return Object(u.jsx)("div",{style:{position:"absolute",left:w,top:_},className:kt.a.MeasureBetweenPoints,children:Object(u.jsx)("h5",{children:S})})}return null},Mt=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this)).segment=new Ie.d,e.stage.addChild(a.segment),a.labelShape=new Ie.f,a.labelShape.x=0,a.labelShape.y=0,e.stage.addChild(a.labelShape),a}return Object(h.a)(n,[{key:"format",value:function(e){return(e/this.props.divisor).toFixed(this.props.decimals)}},{key:"redrawLabel",value:function(){if(this.labelShape){var e=this.props.stage,t=this.props.shortestSegment.box,n=(t.xmin+t.xmax)/2,a=(t.ymin+t.ymax)/2,r=6/(e.zoomFactor*e.resolution),o=4/(e.zoomFactor*e.resolution);t.ymin===t.ymax&&(r=0,o=-o),this.labelShape.text=this.format(this.props.shortestSegment.length);this.labelShape.font="".concat(14,"px Arial");var i=1/(e.zoomFactor*e.resolution),s=n+r,c=a+o;this.labelShape.setTransform(s,c,i,-i)}}},{key:"draw",value:function(){this.props.shortestSegment&&(this.segment.graphics=Ne(this.props.shortestSegment),this.redrawLabel())}},{key:"componentDidMount",value:function(){this.draw()}},{key:"componentDidUpdate",value:function(){this.segment.graphics.clear(),this.props.firstMeasuredShape&&this.props.secondMeasuredShape&&this.props.firstMeasuredLayer.displayed&&this.props.secondMeasuredLayer.displayed&&(this.draw(),this.redrawLabel())}},{key:"componentWillUnmount",value:function(){this.props.stage.removeChild(this.segment),this.segment.graphics.clear(),this.props.stage.removeChild(this.labelShape),this.labelShape.text=""}},{key:"render",value:function(){return null}}]),n}(i.Component),Pt={originX:null,originY:null,resolution:1e-4,zoomFactor:1},It=function(e,t){var n=Object(i.useRef)(null),a=Object(i.useRef)(null),r=De(a.current),o=Object(E.a)(r,2),s=o[0],c=o[1],l=Object(i.useState)(Pt),p=Object(E.a)(l,2),d=p[0],h=p[1],f=Object(i.useReducer)(ye,[]),m=Object(E.a)(f,2),v=m[0],y=m[1],b=Object(i.useReducer)(Oe,ge),g=Object(E.a)(b,2),j=g[0],O=g[1];Object(i.useEffect)((function(){return e.onPasteDataFromBuffer&&document.addEventListener("paste",e.onPasteDataFromBuffer),function(){e.onPasteDataFromBuffer&&document.removeEventListener("paste",e.onPasteDataFromBuffer)}}),[]),Object(i.useEffect)((function(){if(0===e.data.length)y({type:ue});else{var t,n=Object(_.a)(e.data);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.stage||y(xe(a))}}catch(r){n.e(r)}finally{n.f()}}}),[e.data]),Object(i.useEffect)((function(){var e=ve.getAffected(v);if(e&&s){e.stage=s;var t=s.getInitialTransform(e);h(t)}}),[s,v]),Object(i.useEffect)((function(){if(s&&!e.measurePointsActive&&c.startX&&c.startY){var t=c.x-c.startX,n=c.y-c.startY;if(0!==t&&0!==n){var a=s.panByMouseMove(t,n);h(a)}}}),[s,c,e.measurePointsActive]),Object(i.useEffect)((function(){if(s&&0!==c.delta){var e=c.delta>0,t=s.zoomByMouse(c.x,c.y,e,1.2);h(t)}}),[s,c]),Object(i.useEffect)((function(){if(s&&c.touchPoints){var e=s.zoomByPinchMove(c.x1,c.y1,c.ratio);h(e)}}),[s,c]);var x=Object(i.useCallback)((function(){var e=ve.getAffected(v);if(e&&s){var t=e.center,n=e.box;if(isNaN(t.x)||isNaN(t.y))return;s.panToCoordinate(t.x,t.y);var a=s.zoomToLimits(n.xmax-n.xmin,n.ymax-n.ymin);h(a)}}),[s,v]);Object(i.useEffect)((function(){var e=function(e){switch(e.code){case"KeyH":case"Home":x()}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[s,v,x]),Object(i.useImperativeHandle)(t,(function(){return{zoomHome:x}}),[x]);var w=j.firstMeasuredShape&&j.firstMeasuredLayer.displayed&&j.secondMeasuredShape&&j.secondMeasuredLayer.displayed;return Object(u.jsxs)("div",{className:A.a.EditorComponent,ref:n,children:[e.showLayersWidget&&Object(u.jsx)(St,{stage:s,layers:v,toggleDisplayLayer:function(e){return y(function(e){return{type:te,layer:e}}(e))},toggleAffectedLayer:function(e,t){return y(function(e,t){return e.stopPropagation(),{type:ne,layer:t}}(e,t))},onEditLayerButtonClicked:function(){return y({type:ae})},onSubmitLayerEditForm:function(e){return y(function(e){return{type:re,newLayer:e}}(e))},onEscapeLayerEditForm:function(){return y({type:oe})},onDeleteLayerButtonClicked:function(){return y({type:$})},setAffectedNextLayer:function(){return y({type:ie})},setAffectedPrevLayer:function(){return y({type:se})}}),Object(u.jsx)("canvas",{tabIndex:"1",ref:a,width:"100",height:"100"}),Object(u.jsx)(ke,{stage:s,unitsName:e.unitsName||"pixels",divisor:e.divisor||1,decimals:e.decimals||0,coordX:c.x,coordY:c.y}),s?Object(u.jsx)(Ae,{stage:s,layers:v,transform:d,controls:e.controls,children:Object(u.jsx)(rt,{stage:s,layers:v,widthOn:e.widthOn,displayVertices:e.displayVertices,displayLabels:e.displayLabels,zoomFactor:d.zoomFactor,divisor:e.divisor||1,decimals:e.decimals||0,originX:s.originX,originY:s.originY,handleMouseRollOverShape:function(e){return O(function(e){return{type:H,shape:e}}(e))},handleMouseRollOutShape:function(){return O({type:V})},handleClickOnShape:function(e,t){return O(function(e,t){return{type:G,shape:e,layer:t}}(e,t))},hoveredShape:j.hoveredShape,firstMeasuredShape:j.firstMeasuredShape,secondMeasuredShape:j.secondMeasuredShape})}):null,e.measurePointsActive&&Object(u.jsx)(Ct,{stage:s,mouseState:c,transform:d,unitsName:e.unitsName||"pixels",divisor:e.divisor||1,decimals:e.decimals||0}),j.distance&&j.shortestSegment&&w&&Object(u.jsx)(Mt,{stage:s,firstMeasuredShape:j.firstMeasuredShape,secondMeasuredShape:j.secondMeasuredShape,firstMeasuredLayer:j.firstMeasuredLayer,secondMeasuredLayer:j.secondMeasuredLayer,distance:j.distance,shortestSegment:j.shortestSegment,divisor:e.divisor||1,decimals:e.decimals||0})]})},Ft=Object(i.forwardRef)(It),Dt=function(){function e(){Object(d.a)(this,e),this.filename="",this.title="",this.profiles=[],this.materials=[],this.shapes=[]}return Object(h.a)(e,[{key:"box",get:function(){var e,t=new pe.b,n=Object(_.a)(this.profiles);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.merge(a.box)}}catch(u){n.e(u)}finally{n.f()}var r,o=Object(_.a)(this.materials);try{for(o.s();!(r=o.n()).done;){var i=r.value;t.merge(i.box)}}catch(u){o.e(u)}finally{o.f()}var s,c=Object(_.a)(this.shapes);try{for(c.s();!(s=c.n()).done;){var l=s.value;t.merge(l.box)}}catch(u){c.e(u)}finally{c.f()}return t}}]),e}();function Nt(e,t,n,a){var r=Object(pe.r)(e,t).slope,o=Object(pe.r)(e,n).slope;pe.m.EQ(r,o)&&(o+=2*Math.PI,a=!0);var i=Object(pe.r)(e,t).length;return new pe.a(e,i,r,o,a)}var Tt=pe.o.BooleanOperations,Bt=(Tt.unify,Tt.subtract,Tt.BOOLEAN_UNION),Ut=pe.o.BooleanOperations,Wt=Ut.addToIntPoints,Yt=Ut.getSortedArray,Rt=Ut.splitByIntersections,zt=pe.o.BooleanOperations,Xt=zt.removeNotRelevantChains,Ht=zt.removeOldFaces,Vt=zt.restoreFaces;function Gt(e,t){var n,a,r=Math.abs(t),o=new pe.k,i=e.clone();i.r=e.r+r,n=function(e,t,n,a){var r=Object(pe.r)(e,t).slope,o=r+n;pe.m.EQ(r,o)&&(o+=2*Math.PI,a=!0);var i=Object(pe.r)(e,t).length;return new pe.a(e,i,r,o,a)}(e.end,i.end,Math.PI,e.counterClockwise),a=function(e,t,n,a){var r=Object(pe.r)(e,t).slope,o=r-n;pe.m.EQ(o,r)&&(r+=2*Math.PI,a=!0);var i=Object(pe.r)(e,t).length;return new pe.a(e,i,o,r,a)}(e.start,i.start,Math.PI,e.counterClockwise);var s=void 0;s=e.r>r?new pe.a(e.pc,e.r-r,e.endAngle,e.startAngle,e.counterClockwise===pe.d?pe.c:pe.d):new pe.l(n.end,a.start),o.addFace([i,n,s,a]),Object(w.a)(o.faces)[0].setArcLength();var c=pe.f.getSelfIntersections(Object(w.a)(o.faces)[0],o.edges,!1);c=c.slice(0,c.length/2);var l,u,p=[];l=Object(w.a)(o.edges)[1],u=Object(w.a)(o.edges)[3];var d,h=Object(_.a)(c);try{for(h.s();!(d=h.n()).done;){var f=d.value;Wt(l,f,p),Wt(u,f,p)}}catch(S){h.e(S)}finally{h.f()}var m=Yt(p);Rt(o,m);var v,y=pe.i,b=Object(_.a)(m);try{for(b.s();!(v=b.n()).done;){var g=v.value;g.edge_before.bv=y,g.edge_after.bv=y===pe.i?pe.g:pe.i,y=g.edge_after.bv}}catch(S){b.e(S)}finally{b.f()}Xt(o,Bt,m,!0);var j,O,x=p.length;x>0&&(j=m[0].edge_before,O=m[x-1].edge_after,j.next=O,O.prev=j,m[0].edge_after=m[x-1].edge_after,m[x-1].edge_before=m[0].edge_before,4===x&&(j=m[2].edge_before,O=m[1].edge_after,j.next=O,O.prev=j,m[2].edge_after=m[1].edge_after,m[1].edge_before=m[2].edge_before),Ht(o,p),Vt(o,p,p));return Object(w.a)(o.faces)[0].orientation()===pe.h.CCW&&o.reverse(),o}function Jt(e,t){var n=Math.abs(t),a=new pe.k,r=Object(pe.r)(e.end.x-e.start.x,e.end.y-e.start.y).normalize(),o=r.rotate90CCW().multiply(n),i=r.rotate90CW().multiply(n),s=e.translate(o),c=e.translate(i).reverse(),l=Nt(e.end,s.end,c.start,pe.d),u=Nt(e.start,c.end,s.start,pe.d);return a.addFace([s,l,c,u]),a}function Kt(e,t,n,a){var r=Object(pe.r)(e,t).slope,o=Object(pe.r)(e,n).slope;pe.m.EQ(r,o)&&(o+=2*Math.PI,a=!0);var i=Object(pe.r)(e,t).length;return Object(pe.n)(e,i,r,o,a)}function Qt(e,t,n){for(var a,r,o,i,s=[],c=new pe.k,l=t+1;l<n;l++){var u=e[l].split(" ");if("A"===u[0])r=Object(pe.p)(parseInt(u[5]),parseInt(u[6])),o=Object(pe.p)(parseInt(u[7]),parseInt(u[8])),i=Kt(Object(pe.p)(parseInt(u[9]),parseInt(u[10])),r,o,!!u[12].includes("1"));else"L"===u[0]&&(r=Object(pe.p)(parseInt(u[1]),parseInt(u[2])),o=Object(pe.p)(parseInt(u[3]),parseInt(u[4])),i=Object(pe.q)(r,o));0===s.length&&(a=r),s.push(i),o.equalTo(a)&&(c.addFace(s),s=[])}return c}function Zt(e){for(var t=null,n=[],a=e.match(/[^\r\n]+/g),r=0;r<a.length;r++){var o=a[r].split(" ");if("S"!==o[0]){if("E"===o[0]&&null!==t){var i=Qt(a,t,r);t=null,null,n.push(i)}}else t=r}return n}function qt(e,t){var n=new Dt;return n.filename=e,n.shapes=Zt(t),n}function $t(e){var t,n,a=e.match(/\{([^)]+)\}/)[1];t=parseInt(a.split("=")[1].split(",")[0],10),n=parseInt(a.split("=")[1].split(",")[1],10),(isNaN(t)||isNaN(n))&&(t=parseInt(a.trim().split(" ")[0].split("=")[1],10),n=parseInt(a.trim().split(" ")[1].split("=")[1],10));var r=new pe.j(t,n);return r.label=e.split(/\s+/)[1],r}function en(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),n=t[0].split("=")[1].split(","),a=new pe.j(parseInt(n[0],10),parseInt(n[1],10)),r=t[1].split("=")[1].split(","),o=new pe.j(parseInt(r[0],10),parseInt(r[1],10));return new pe.l(a,o)}function tn(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),n=t[0].split("=")[1].split(","),a=new pe.j(parseInt(n[0],10),parseInt(n[1],10)),r=t[1].split("=")[1].split(","),o=new pe.j(parseInt(r[0],10),parseInt(r[1],10)),i=t[2].split("=")[1].split(","),s=new pe.j(parseInt(i[0],10),parseInt(i[1],10)),c="0"===t[3].split("=")[1],l=Object(pe.r)(s,a).slope,u=Object(pe.r)(s,o).slope;pe.o.Utils.EQ(l,u)&&(u=c?u+2*Math.PI:u-2*Math.PI);var p=Object(pe.r)(s,a).length;return new pe.a(s,p,l,u,c)}function nn(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),n=t[0].split("=")[1].split(","),a=new pe.j(parseInt(n[0],10),parseInt(n[1],10)),r=parseInt(t[1].split("=")[1],10);return new pe.e(a,r)}function an(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),n=t[0].split("=")[1].split(","),a=parseInt(n[0],10),r=parseInt(n[1],10),o=parseInt(t[1].split("=")[1],10),i=parseInt(t[2].split("=")[1],10),s=new pe.b(a,r,a+o,r+i),c=new pe.k;return c.addFace(s),c}function rn(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),n=t[0].split("=")[1].split(","),a=new pe.j(parseInt(n[0],10),parseInt(n[1],10)),r=t[1].split("=")[1].split(","),o=new pe.j(parseInt(r[0],10),parseInt(r[1],10)),i=parseInt(t[2].split("=")[1],10),s=new pe.l(a,o);return i>0?Jt(s,i):new pe.k}function on(e){var t=e.match(/\{([^)]+)\}/)[1].split(" "),n=t[0].split("=")[1].split(","),a=new pe.j(parseInt(n[0],10),parseInt(n[1],10)),r=t[1].split("=")[1].split(","),o=new pe.j(parseInt(r[0],10),parseInt(r[1],10)),i=t[2].split("=")[1].split(","),s=new pe.j(parseInt(i[0],10),parseInt(i[1],10)),c="0"===t[3].split("=")[1],l=Object(pe.r)(s,a).slope,u=Object(pe.r)(s,o).slope;pe.o.Utils.EQ(l,u)&&(u=c?u+2*Math.PI:u-2*Math.PI);var p=Object(pe.r)(s,a).length,d=new pe.a(s,p,l,u,c),h=parseInt(t[4].split("=")[1],10);return h>0?Gt(d,h):new pe.k}function sn(e){var t=function(e){for(var t=new pe.k,n=e.match(/[^\r\n]+/g),a=0;a<n.length;a++){var r=n[a];if(r.search("mat_cont_poly_struc")>=0){for(var o=r.match(/\{([^)]+)\}/)[1].split(" ")[0].split("=")[1],i=parseInt(o,10),s=[],c=a+2;c<a+2+i;c++)if((r=n[c]).search("mat_seg_struc")>=0){var l=en(r);s.push(l)}else if(r.search("mat_curve_struc")>=0){var u=tn(r);s.push(u)}t.addFace(s)}}return t}(e);if(t.edges.size>0&&t.faces.size>0)return[t];var n=function(e){var t,n=[],a=e.match(/[^\r\n]+/g);if(1===a[0].length&&"N"===a[0])return Zt(e);var r,o=Object(_.a)(a);try{for(o.s();!(r=o.n()).done;){var i=r.value;i.search("point_struc")>=0?t=$t(i):i.search("_seg_struc")>=0?t=en(i):i.search("_curve_struc")>=0?t=tn(i):i.search("_circle_struc")>=0?t=nn(i):i.search("_rect_struc")>=0?t=an(i):i.search("_line_struc")>=0?t=rn(i):i.search("_arc_struc")>=0&&(t=on(i)),n.push(t)}}catch(s){o.e(s)}finally{o.f()}return n}(e);if(n.length>0)return n;var a=function(e){var t,n=[],a=e.match(/[^\r\n]+/g),r=Object(_.a)(a);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o.search("point_struc")>=0){var i=o.match(/\{([^)]+)\}/)[1].split("=")[1].split(","),s=new pe.j(parseInt(i[0],10),parseInt(i[1],10));s.label=o.split(/\s+/)[1],n.push(s)}}}catch(c){r.e(c)}finally{r.f()}return n}(e);return a.length>0?a:void 0}function cn(e,t){var n=new Dt;n.filename=e;var a=sn(t);if(a.length>0){var r,o=Object(_.a)(a);try{for(o.s();!(r=o.n()).done;){var i=r.value;n.shapes.push(i)}}catch(s){o.e(s)}finally{o.f()}}return n}var ln=function(){var e=Object(i.useState)([]),t=Object(E.a)(e,2),n=t[0],a=t[1];Object(i.useEffect)((function(){(function(){var e=Object(S.a)(x.a.mark((function e(){var t,n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://gist.githubusercontent.com/alexbol99/e570fe783be88b556f4ca4b332da73f7/raw/741c87a7ceccdeadd9fbbac05bdfda22ebe94927/poly234.txt");case 2:return t=e.sent,e.next=5,t.text();case 5:n=e.sent,r=cn("layer",n),a((function(e){var t=ve.newLayer(null,e);t.color=ve.getNextColor(e),t.displayed=!0,t.affected=!0;var n,a=Object(_.a)(r.shapes);try{for(a.s();!(n=a.n()).done;){var o=n.value;t.add(o)}}catch(i){a.e(i)}finally{a.f()}return[].concat(Object(w.a)(e),[t])}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch(console.error)}),[]);return Object(u.jsx)(Ft,{onClearAllButtonClicked:function(){a([])},children:n})},un=n(57),pn=n.n(un);function dn(e){return"segment"===e.name?new pe.o.Segment(e):"arc"===e.name?new pe.o.Arc(e):"point"===e.name?new pe.o.Point(e):void 0}function hn(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,a=new Dt;a.filename=t;try{e=JSON.parse(n)}catch(p){throw new Error("Illegal JSON string")}if(e instanceof Array)try{var r,o=new pe.o.Polygon,i=Object(_.a)(e);try{for(i.s();!(r=i.n()).done;){var s=r.value;o.addFace(s)}}catch(d){i.e(d)}finally{i.f()}a.shapes.push(o)}catch(p){var c,l=Object(_.a)(e);try{for(l.s();!(c=l.n()).done;){var u=c.value;a.shapes.push(dn(u))}}catch(d){l.e(d)}finally{l.f()}}else a.shapes.push(dn(e));return a}pe.o.Image=function(){function e(){Object(d.a)(this,e),this.uri="",this.center=new pe.o.Point,this.width=0,this.height=0}return Object(h.a)(e,[{key:"box",get:function(){return new pe.o.Box(this.center.x-this.width/2,this.center.y-this.height/2,this.center.x+this.height/2,this.center.y+this.height/2)}}]),e}();var fn=[{name:"pixels",decimals:0,divisor:1},{name:"inch",decimals:7,divisor:1016e4},{name:"mm",decimals:6,divisor:4e5}],mn=fn[0],vn=function(e,t){switch(t.type){case F:var n=fn.findIndex((function(t){return e.name===t.name})),a=fn[(n+1)%3];return Object(be.a)(Object(be.a)({},e),{},{name:a.name,decimals:a.decimals,divisor:a.divisor});default:return e}},yn={title:"Debug Viewer",version:"3.0.0",build:"3.0.0",widthOn:!0,displayVertices:!1,displayLabels:!1,measurePointsActive:!1,showAboutPopup:!1,importDataToNewLayer:!0,showSpinner:!1,showLayersWidget:!1,showDownloadPopup:!1,showUploadPopup:!1},bn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return Object(be.a)(Object(be.a)({},e),{},{stage:null,zoomFactor:void 0,originX:void 0,originY:void 0});case D:return Object(be.a)(Object(be.a)({},e),{},{widthOn:!e.widthOn,displayVertices:!!e.widthOn&&e.displayVertices});case N:return e.displayVertices?Object(be.a)(Object(be.a)({},e),{},{displayVertices:!1}):Object(be.a)(Object(be.a)({},e),{},{widthOn:!1,displayVertices:!0});case T:return Object(be.a)(Object(be.a)({},e),{},{displayLabels:!e.displayLabels});case I:return Object(be.a)(Object(be.a)({},e),{},{showAboutPopup:!e.showAboutPopup});case C:return Object(be.a)(Object(be.a)({},e),{},{measurePointsActive:!1});case M:return Object(be.a)(Object(be.a)({},e),{},{measurePointsActive:!0});case P:return Object(be.a)(Object(be.a)({},e),{},{measurePointsActive:!1});case B:return Object(be.a)(Object(be.a)({},e),{},{showLayersWidget:!e.showLayersWidget});case U:return Object(be.a)(Object(be.a)({},e),{},{showDownloadPopup:!e.showDownloadPopup});case W:return Object(be.a)(Object(be.a)({},e),{},{showUploadPopup:!e.showUploadPopup});default:return e}},gn={uploadStarted:!1,uploadCompleted:!1,uploadedFiles:[]},jn=function(e,t){switch(t.type){case le:return gn;case ce:return Object(be.a)(Object(be.a)({},e),{},{uploadCompleted:!0,uploadedFiles:t.uploadedFiles});default:return e}},On=function(){return{type:I}},xn=function(){return{type:U}},wn=function(){return{type:W}};function _n(e){for(var t=[],n=0,a=Array.from(e);n<a.length;n++){var r=a[n],o=r.getAttribute("type");if("segment"===o){var i=new pe.j(parseInt(r.getAttribute("xs"),10),parseInt(r.getAttribute("ys"),10)),s=new pe.j(parseInt(r.getAttribute("xe"),10),parseInt(r.getAttribute("ye"),10));t.push(new pe.l(i,s))}if("curve"===o){var c=new pe.j(parseInt(r.getAttribute("xs"),10),parseInt(r.getAttribute("ys"),10)),l=new pe.j(parseInt(r.getAttribute("xe"),10),parseInt(r.getAttribute("ye"),10)),u=new pe.j(parseInt(r.getAttribute("xc"),10),parseInt(r.getAttribute("yc"),10)),p="no"===r.getAttribute("cw"),d=Object(pe.r)(u,c).slope,h=Object(pe.r)(u,l).slope;pe.o.Utils.EQ(d,h)&&(h=p?h+2*Math.PI:h-2*Math.PI);var f=Object(pe.r)(u,c).length;t.push(new pe.a(u,f,d,h,p))}}return t}function Sn(e){var t=new pe.k,n=e.getAttribute("color");t.style={stroke:n||void 0,fill:n||void 0,alpha:1};var a=e.getAttribute("label");t.label=a;for(var r=e.getElementsByTagName("island"),o=0,i=Array.from(r);o<i.length;o++){var s=i[o].getElementsByTagName("edge");t.addFace(_n(s))}for(var c=e.getElementsByTagName("hole"),l=0,u=Array.from(c);l<u.length;l++){var p=u[l].getElementsByTagName("edge");t.addFace(_n(p))}return t}function En(e){var t=new pe.j(parseInt(e.getAttribute("xs"),10),parseInt(e.getAttribute("ys"),10)),n=new pe.j(parseInt(e.getAttribute("xe"),10),parseInt(e.getAttribute("ye"),10)),a=new pe.l(t,n),r=e.getAttribute("label");return a.label=r,a}function kn(e){var t=new pe.j(parseInt(e.getAttribute("xs"),10),parseInt(e.getAttribute("ys"),10)),n=new pe.j(parseInt(e.getAttribute("xe"),10),parseInt(e.getAttribute("ye"),10)),a=new pe.j(parseInt(e.getAttribute("xc"),10),parseInt(e.getAttribute("yc"),10)),r="no"===e.getAttribute("cw"),o=Object(pe.r)(a,t).slope,i=Object(pe.r)(a,n).slope;pe.o.Utils.EQ(o,i)&&(i=r?i+2*Math.PI:i-2*Math.PI);var s=Object(pe.r)(a,t).length,c=new pe.a(a,s,o,i,r),l=e.getAttribute("label");return c.label=l,c}function An(e){var t=new pe.j(parseInt(e.getAttribute("x"),10),parseInt(e.getAttribute("y"),10)),n=e.getAttribute("label");return t.label=n,t}function Ln(e){var t=new pe.o.Image;return t.center=new pe.j(parseInt(e.getAttribute("xc"),10),parseInt(e.getAttribute("yc"),10)),t.width=parseInt(e.getAttribute("width"),10),t.height=parseInt(e.getAttribute("height"),10),t.uri=e.getAttribute("uri"),t}function Cn(e,t){var n=new Dt;n.filename=e;var a=(new DOMParser).parseFromString(t,"text/xml"),r=a.getElementsByTagName("title");r&&r.length>0&&(n.title=r[0].firstChild.nodeValue);for(var o=a.getElementsByTagName("profile"),i=0,s=Array.from(o);i<s.length;i++){var c=Sn(s[i]);n.profiles.push(c)}for(var l=a.getElementsByTagName("material"),u=0,p=Array.from(l);u<p.length;u++){var d=Sn(p[u]);n.materials.push(d)}for(var h=a.getElementsByTagName("segment"),f=0,m=Array.from(h);f<m.length;f++){var v=En(m[f]);n.shapes.push(v)}for(var y=a.getElementsByTagName("curve"),b=0,g=Array.from(y);b<g.length;b++){var j=kn(g[b]);n.shapes.push(j)}for(var O=a.getElementsByTagName("point"),x=0,w=Array.from(O);x<w.length;x++){var _=An(w[x]);n.shapes.push(_)}for(var S=a.getElementsByTagName("picture"),E=0,k=Array.from(S);E<k.length;E++){var A=Ln(k[E]);n.shapes.push(A)}return n}pe.o.Image=function(){function e(){Object(d.a)(this,e),this.uri="",this.center=new pe.o.Point,this.width=0,this.height=0}return Object(h.a)(e,[{key:"box",get:function(){return new pe.o.Box(this.center.x-this.width/2,this.center.y-this.height/2,this.center.x+this.height/2,this.center.y+this.height/2)}}]),e}();function Mn(e){return Math.round(1016e4*Number(e),0)}function Pn(e){return Math.round(10160*Number(e),0)}function In(e,t){for(var n,a,r=[],o=t,i=e[o],s=i.split(" "),c=new pe.j(Mn(s[1]),Mn(s[2])),l=!1;;){switch((s=(i=e[o]).split(" "))[0]){case"OS":n=new pe.j(Mn(s[1]),Mn(s[2])),r.push(new pe.l(c,n)),c=n.clone();break;case"OC":n=new pe.j(Mn(s[1]),Mn(s[2])),a=new pe.j(Mn(s[3]),Mn(s[4]));var u="Y"===s[5]?pe.o.CW:pe.o.CCW,p=Object(pe.r)(a,c).slope,d=Object(pe.r)(a,n).slope;pe.m.EQ(p,d)&&(d+=2*Math.PI,u=!0);var h=Object(pe.r)(a,c).length;r.push(new pe.a(a,h,p,d,u)),c=n.clone();break;case"OE":l=!0}if(l)break;o++}return r}function Fn(e,t){var n=e.split(" "),a=new pe.j(Mn(n[1]),Mn(n[2])),r=new pe.j(Mn(n[3]),Mn(n[4])),o=new pe.l(a,r),i=t[Number(n[5])];return o.aperture=i,o}function Dn(e,t){var n=e.split(" "),a=new pe.j(Mn(n[1]),Mn(n[2])),r=new pe.j(Mn(n[3]),Mn(n[4])),o=new pe.j(Mn(n[5]),Mn(n[6])),i="Y"===n[10]?pe.o.CW:pe.o.CCW,s=Object(pe.r)(o,a).slope,c=Object(pe.r)(o,r).slope;pe.o.Utils.EQ(s,c)&&(c+=2*Math.PI,i=!0);var l=Object(pe.r)(o,a).length,u=new pe.a(o,l,s,c,i),p=t[Number(n[7])];return u.aperture=p,u}function Nn(e,t){var n=new Dt;n.filename=e;for(var a,r=t.match(/[^\r\n]+/g),o=[],i=0;i<r.length;i++){var s=r[i],c=s.split(" ");if("$"!==c[0].substr(0,1))switch(c[0]){case"S":a=new pe.k;var l=s.split(" ")[1];a.polarity=l;break;case"OB":var u=i,p=In(r,u);a.addFace(p),i=u+p.length+1;break;case"SE":n.shapes.push(a);break;case"L":var d=Fn(s,o);n.shapes.push(d);break;case"A":var h=Dn(s,o);n.shapes.push(h)}else{var f=Number(c[0].substr(1)),m=Pn(c[1].substr(1));o[f]=m}}return n}function Tn(e){return Math.round(400*Number(e),0)}function Bn(e,t){var n=new Dt;n.filename=e;for(var a=t.match(/[^\r\n]+/g),r=0;r<a.length;r++){var o=a[r].split(","),i=Tn(o[0]),s=Tn(o[1]),c=Number(o[2]),l=Number(o[3]),u=Object(pe.p)(i,s);u.nx=c,u.ny=l,n.shapes.push(u)}return n}var Un=n(42),Wn=n.n(Un),Yn=function(){return Object(u.jsx)("div",{className:Wn.a.ButtonSeparator,children:Object(u.jsx)(it.a,{name:"ellipsis-v",size:"2x",className:Wn.a.IconSeparator})})},Rn=n(43),zn=n.n(Rn),Xn=function(e){return Object(u.jsxs)("div",{className:zn.a["App-toolbar"],children:[Object(u.jsx)(lt,{type:"trigger",title:"Open files",iconName:"folder-open",onClick:function(){return e.appStateDispatch(wn())}}),Object(u.jsx)(Yn,{}),Object(u.jsx)(lt,{type:"trigger",title:"Show/hide layersReducer",iconName:"layer-group",onClick:function(){return e.appStateDispatch({type:B})}}),Object(u.jsx)(lt,{type:"trigger",title:"Sort layersReducer",iconName:"sort-alpha-down",onClick:e.onSortLayersButtonClicked}),Object(u.jsx)(lt,{type:"trigger",title:"Download layers",iconName:"file-download",onClick:function(){return e.appStateDispatch(xn())}}),Object(u.jsx)(lt,{type:"trigger",title:"Delete all layers",iconName:"broom",onClick:e.onClearAllButtonClicked}),Object(u.jsx)(Yn,{}),Object(u.jsx)(lt,{type:"trigger",title:"Zoom and pan to home view",iconName:"home",onClick:e.onHomeButtonPressed}),Object(u.jsx)(Yn,{}),Object(u.jsx)(lt,{type:"mode",title:"Pan by drag",iconName:"arrows-alt",active:!e.measurePointsActive,onClick:function(){return e.appStateDispatch({type:C})}}),Object(u.jsx)(lt,{type:"mode",title:"Measure distance between points",iconName:"drafting-compass",active:e.measurePointsActive,onClick:function(){return e.appStateDispatch({type:M})}}),Object(u.jsx)(Yn,{}),Object(u.jsx)(lt,{type:"trigger",title:"Measure distance between selected shapes",iconName:"ruler",onClick:e.onMeasureBetweenShapesButtonPressed}),Object(u.jsx)(lt,{type:"trigger",title:"Display solid or wire",iconName:"fill-drip",onClick:function(){return e.appStateDispatch({type:D})}}),Object(u.jsx)(lt,{type:"trigger",title:"Display vertices on/off",iconName:"draw-polygon",onClick:function(){return e.appStateDispatch({type:N})}}),Object(u.jsx)(lt,{type:"trigger",title:"Display labels on/off",iconName:"tag",onClick:function(){return e.appStateDispatch({type:T})}}),Object(u.jsx)(Yn,{}),Object(u.jsx)("button",{className:zn.a["App-toolbar-units"],onClick:e.onUnitClicked,children:e.units}),Object(u.jsx)(Yn,{}),Object(u.jsx)(lt,{type:"trigger",title:"About",iconName:"info",onClick:function(){return e.appStateDispatch(On())}}),Object(u.jsx)(Yn,{})]})},Hn=n(58),Vn=n.n(Hn),Gn=function(e){return Object(u.jsx)(vt,{showPopup:e.showAboutPopup,closePopup:e.toggleAboutPopup,header:"Info",children:Object(u.jsxs)("div",{className:Vn.a.AboutPopup,children:[Object(u.jsxs)("h2",{children:[e.title," v",e.version]}),Object(u.jsx)("label",{children:"Build date: "}),Object(u.jsx)("span",{children:"02/10/2021"}),Object(u.jsx)("br",{}),Object(u.jsx)("label",{children:"Github depository: "}),Object(u.jsx)("a",{href:"https://github.com/alexbol99/debug-viewer1",children:"https://github.com/alexbol99/debug-viewer1"}),Object(u.jsx)("br",{}),Object(u.jsx)("label",{children:"3d party graphics library: "}),Object(u.jsx)("a",{href:"https://github.com/CreateJS/EaselJS/tree/2.0",children:"https://github.com/CreateJS/EaselJS/tree/2.0"}),Object(u.jsx)("br",{})]})})},Jn=n(59),Kn=n.n(Jn);function Qn(e,t){e.startElement("point"),e.writeAttribute("x",t.geom.x),e.writeAttribute("y",t.geom.y),e.writeAttribute("label",t.label),e.endElement()}function Zn(e,t){e.startElement("segment"),e.writeAttribute("xs",t.geom.ps.x),e.writeAttribute("ys",t.geom.ps.y),e.writeAttribute("xe",t.geom.pe.x),e.writeAttribute("ye",t.geom.pe.y),e.writeAttribute("label",t.label),e.endElement()}function qn(e,t){e.startElement("arc"),e.writeAttribute("xs",Math.round(t.geom.start.x)),e.writeAttribute("ys",Math.round(t.geom.start.y)),e.writeAttribute("xe",Math.round(t.geom.end.x)),e.writeAttribute("ye",Math.round(t.geom.end.y)),e.writeAttribute("xc",t.geom.center.x),e.writeAttribute("yc",t.geom.center.y),e.writeAttribute("cw",t.geom.counterClockwise===pe.d?"yes":"no"),e.writeAttribute("label",t.label),e.endElement()}function $n(e,t){e.startElement("circle"),e.writeAttribute("xc",t.geom.center.x),e.writeAttribute("yc",t.geom.center.y),e.writeAttribute("label",t.label),e.endElement()}function ea(e,t){e.startElement("profile");var n,a=Object(_.a)(t.faces);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.orientation()===pe.h.CW?e.startElement("island"):e.startElement("hole"),e.writeAttribute("n_edges","".concat(r.size));var o,i=Object(_.a)(r);try{for(i.s();!(o=i.n()).done;){var s=o.value;e.startElement("edge");var c=s.shape;c instanceof pe.l?(e.writeAttribute("type","segment"),e.writeAttribute("xs",c.ps.x),e.writeAttribute("ys",c.ps.y),e.writeAttribute("xe",c.pe.x),e.writeAttribute("ye",c.pe.y)):s.shape instanceof pe.a?(e.writeAttribute("type","curve"),e.writeAttribute("xs",Math.round(c.start.x)),e.writeAttribute("ys",Math.round(c.start.y)),e.writeAttribute("xe",Math.round(c.end.x)),e.writeAttribute("ye",Math.round(c.end.y)),e.writeAttribute("xc",c.center.x),e.writeAttribute("yc",c.center.y),e.writeAttribute("cw",c.counterClockwise===pe.d?"yes":"no")):e.writeAttribute("type","unknown"),e.endElement()}}catch(l){i.e(l)}finally{i.f()}e.endElement()}}catch(l){a.e(l)}finally{a.f()}e.endElement()}function ta(e){var t=new Kn.a(!0);t.startDocument("1.0","UTF-8"),t.startElement("shapes"),t.startElement("title").text("test polygon in xml format").endElement();var n,a=Object(_.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.geom instanceof pe.j?Qn(t,r):r.geom instanceof pe.l?Zn(t,r):r.geom instanceof pe.a?qn(t,r):r.geom instanceof pe.e?$n(t,r):r.geom instanceof pe.b||r.geom instanceof pe.k&&ea(t,r.geom)}}catch(o){a.e(o)}finally{a.f()}return t.endDocument(),t.toString()}var na=n(60),aa=n.n(na),ra=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props.showPopup?this.props.layers.map((function(e){return e.displayed?{filename:"".concat(e.name,".xml"),xmlString:ta(e.shapes)}:null})):[];return this.props.showPopup&&this.props.layers.length>0?Object(u.jsx)(vt,{showPopup:this.props.showPopup,closePopup:this.props.closePopup,header:"Download files",children:Object(u.jsxs)("div",{className:aa.a.DownloadPopup,children:[Object(u.jsx)("h5",{children:"Click on the following links to download"}),Object(u.jsx)("ul",{children:e.map((function(e){return null===e?null:Object(u.jsx)("li",{children:Object(u.jsx)("a",{href:"data:text/json;charset=utf-8,"+encodeURIComponent(e.xmlString),download:e.filename,children:e.filename})},e.filename)}))})]})}):null}}]),n}(i.Component),oa=n(61),ia=n.n(oa),sa=function(e){var t=e.message,n=e.onAnimationEnd;return r.a.createPortal(Object(u.jsx)("div",{className:ia.a.Snackbar,onAnimationEnd:n,children:Object(u.jsx)("h3",{children:t})}),document.getElementById("snackbar-root"))},ca=n(28),la=n.n(ca),ua=function(e){var t=Object(i.useRef)(null),n=Object(i.useState)(!1),a=Object(E.a)(n,2),r=a[0],o=a[1],s="";if(e.uploadCompleted&&e.uploadedFiles.length>0){var c=e.uploadedFiles.length;1===c&&(s="1 layer added"),c>1&&(s="".concat(c," layers added"))}return Object(u.jsx)(vt,{showPopup:e.showPopup,closePopup:function(){e.initUploadState(),e.closePopup()},header:"Open files",children:Object(u.jsxs)("div",{className:la.a.UploadPopup,children:[Object(u.jsx)("div",{className:r?"".concat(la.a.UploadTarget," ").concat(la.a.UploadTargetDragOver):"".concat(la.a.UploadTarget," ").concat(la.a.UploadTargetDragLeave),onDrop:function(t){t.preventDefault();var n=[];if(t.dataTransfer.items){for(var a=0;a<t.dataTransfer.items.length;a++)if("file"===t.dataTransfer.items[a].kind){var r=t.dataTransfer.items[a].getAsFile();n.push(r)}}else n=t.dataTransfer.files;e.onFilesSelected(n),o(!1)},onDragOverCapture:function(e){e.preventDefault(),o(!0)},onDragLeaveCapture:function(e){e.preventDefault(),o(!1)},children:Object(u.jsx)("span",{children:"Drop files here"})}),Object(u.jsx)("h2",{children:"or"}),Object(u.jsx)("button",{onClick:function(){return t.current.click()},children:"Use system Open Dialog"}),Object(u.jsx)("input",{style:{display:"none"},type:"file",ref:t,name:"files[]",multiple:!0,onChange:function(t){return e.onFilesSelected(t.target.files)}}),""!==s?Object(u.jsx)(sa,{onAnimationEnd:e.initUploadState,message:s}):null]})})},pa=function(e){if(File&&FileReader&&FileList){var t=new FileReader,n="";return new Promise((function(a,r){t.onload=function(t){(n=t.target.result)&&n.length>0?a(n):r("No data read from file ".concat(e.name))},t.readAsText(e)}))}},da=function(e,t){var n,a,r=e.split(".").at(-1);if("xml"===r)(n=Cn(e,t)).profiles&&n.profiles.length>0?a=n.profiles:n.shapes&&n.shapes.length>0&&(a=n.shapes);else if("csv"===r)a=(n=Bn(e,t)).shapes;else if("txt"===r)a=(n=cn(e,t)).shapes;else if("json"===r)a=(n=hn(e,t)).shapes;else if("cdbg"===r)a=(n=qt(e,t)).shapes;else{var o=t.match(/[^\r\n]+/g);a=1===o[0].length&&"N"===o[0]?(n=qt(e,t)).shapes:(n=Nn(e,t)).shapes}return a},ha=function(){var e=Object(i.useRef)(null),t=Object(i.useState)([]),n=Object(E.a)(t,2),a=n[0],r=n[1],o=Object(i.useReducer)(vn,mn),s=Object(E.a)(o,2),c=s[0],l=s[1],p=Object(i.useReducer)(bn,yn),d=Object(E.a)(p,2),h=d[0],f=d[1],m=Object(i.useReducer)(jn,gn),v=Object(E.a)(m,2),y=(v[0],v[1]),b=function(e,t){var n=ve.newLayer(null,e);n.color=ve.getNextColor(e),n.displayed=!0,n.affected=!0;var a,r=Object(_.a)(t);try{for(r.s();!(a=r.n()).done;){var o=a.value;n.add(o)}}catch(i){r.e(i)}finally{r.f()}return n},g=function(){var e=Object(S.a)(x.a.mark((function e(t){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(File&&FileReader&&FileList){e.next=2;break}return e.abrupt("return");case 2:return n=Array.from(t).map((function(e){return pa(e)})),e.next=5,Promise.allSettled(n);case 5:a=e.sent,a.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})).forEach((function(e,n){var a=da(t[n].name,e);a.length>0&&r((function(e){var t=b(e,a),n=[].concat(Object(w.a)(e),[t]);return ve.setAffected(n,t),n}))}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(i.Fragment,{children:[Object(u.jsx)(Xn,{measurePointsActive:h.measurePointsActive,units:c.name,appStateDispatch:f,onHomeButtonPressed:function(){e.current.zoomHome()},onUnitClicked:function(){return l({type:F})},onClearAllButtonClicked:function(){r([])}}),Object(u.jsx)(Ft,{ref:e,className:pn.a.HomeComponent,data:a,showLayersWidget:h.showLayersWidget,widthOn:h.widthOn,displayVertices:h.displayVertices,displayLabels:h.displayLabels,measurePointsActive:h.measurePointsActive,unitsName:c.name,divisor:c.divisor,decimals:c.decimals,controls:h,onPasteDataFromBuffer:function(e){var t,n=Object(_.a)(e.clipboardData.items);try{for(n.s();!(t=n.n()).done;){t.value.getAsString((function(e){var t;try{var n=hn("",e);t=n.shapes}catch(a){console.log(a.message),t=sn(e)}t.length>0&&r((function(e){var n=b(e,t),a=[].concat(Object(w.a)(e),[n]);return ve.setAffected(a,n),a}))}))}}catch(a){n.e(a)}finally{n.f()}}}),h.showAboutPopup&&Object(u.jsx)(Gn,{showAboutPopup:h.showAboutPopup,toggleAboutPopup:function(){return f(On())},title:h.title,version:h.version,build:h.build}),h.showDownloadPopup&&Object(u.jsx)(ra,{showPopup:h.showDownloadPopup,closePopup:function(){return f(xn())},title:"Download document",layers:a}),h.showUploadPopup&&Object(u.jsx)(ua,{showPopup:h.showUploadPopup,closePopup:function(){return f(wn())},title:"Upload files",initUploadState:function(){return y({type:le})},onFilesSelected:g})]})},fa=Object(s.f)((function(e){var t;return Object(i.useEffect)((function(){window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""}))}),[]),Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)(p,{title:"Debug Viewer",version:"3.0.0"}),Object(u.jsxs)(s.c,{children:[Object(u.jsx)(s.a,{exact:!0,path:"/",children:Object(u.jsx)(ha,{})}),Object(u.jsx)(s.a,{exact:!0,path:"/demo",children:Object(u.jsx)(ln,{})})]}),(null===(t=e.app)||void 0===t?void 0:t.showSpinner)?Object(u.jsx)(j,{}):null]})}));n(77);r.a.render(Object(u.jsx)(o.a,{basename:"/v3",children:Object(u.jsx)(fa,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[78,1,2]]]);
//# sourceMappingURL=main.2ca2726c.chunk.js.map